/**
     * @author: 
     *    jiangrun002
     * @version: 
     *    v2.4.2
     * @license:
     *    Copyright 2017, jiangrun. All rights reserved.
     */

!function(e,t){"use strict";function a(){var a=function(a){var n=this;n.sdkUtils=new e.HieknSDKService;var o={baseUrl:a.baseUrl,data:a.data,kgName:a.kgName};n.promptSettings=t.extend(!0,{},o,a.promptSettings||{}),n.defaultOptions={lightColor:"#fff",primaryColor:"#00b38a",primaryLightColor:"rgba(0,179,138,0.3)",emphasesColor:"#faa01b",emphasesLightColor:"rgba(250, 160, 27,0.3)",kgName:null,baseUrl:null,data:{},instanceEnable:!1,tgc2Settings:{selector:null,netChart:{settings:{toolbar:{enabled:!1},info:{enabled:!1},nodeMenu:{},style:{selection:{enabled:!1,fillColor:""},nodeStyleFunction:function(e){n.nodeStyleFunction(e)},nodeHovered:{shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0)"},linkStyleFunction:function(e){e.hovered&&(e.label=e.data.attName),e.toDecoration="arrow",e.fillColor="#ddd"},linkLabel:{textStyle:{fillColor:"#999"}}}}},prompt:{enable:!0,settings:{onPrompt:n.sdkUtils.onPromptKnowledge(n.promptSettings)}},page:{enable:!0,style:{right:"15px"},pageSize:20},loader:function(e,t,a){n.loader(e,t,a)}}},n.options=t.extend(!0,{},n.defaultOptions,a),n.options.tgc2Settings.selector=n.options.tgc2Settings.selector||n.options.selector,n.tgc2=null,n.tgc2Prompt=null,n.tgc2Page=null,n.init(),a.startInfo&&n.load(a.startInfo)};return a.prototype.init=function(){var e=this;e.tgc2=new Tgc2Graph(e.options.tgc2Settings),e.tgc2Prompt=new Tgc2Prompt(e.tgc2,e.options.tgc2Settings.prompt),e.tgc2Page=new Tgc2Page(e.tgc2,e.options.tgc2Settings.page),e.tgc2.init(),t(e.options.tgc2Settings.selector).addClass("tgc2 tgc2-concept-graph"),e.options.instanceEnable&&t(e.options.tgc2Settings.selector).append('<div class="tgc2-info-top"><ul class="info-top"><li class="current"><i class="fa fa-circle" style="color:'+e.options.emphasesColor+'"></i><span>当前节点</span></li><li class="concept"><i class="fa fa-circle" style="color:'+e.options.primaryColor+'"></i><span>概念</span></li><li class="instance"><i class="fa fa-circle-o" style="color:'+e.options.primaryColor+'"></i><span>实例</span></li></ul></div>'),t(e.options.tgc2Settings.selector).append('<div class="tgc2-info-bottom"><div class="info-bottom"><span>中心节点：</span><span name="name" style="color:'+e.options.emphasesColor+'"></span></div></div>')},a.prototype.load=function(e){var t=this;t.kgName=t.options.kgName,t.tgc2.load(e),setTimeout(function(){t.tgc2.resize()},300)},a.prototype.loader=function(e,a,n){var o=this,r=o.tgc2.startInfo,i=o.tgc2Page.page,l=o.options.data||{};l.type=r.kgType||0,l.pageNo=i.pageNo,l.pageSize=i.pageSize,l.kgName=o.options.kgName,l.entityId=r.id,hieknjs.kgLoader({url:o.options.baseUrl+"graph/knowlegde?"+t.param(l),type:0,dataFilter:o.options.dataFilter||function(e){return e},that:t(o.options.tgc2Settings.selector)[0],success:function(i){if(i&&i.rsData&&i.rsData.length){if(i=i.rsData[0],i.entityList&&i.entityList.length)for(var l in i.entityList){var s=i.entityList[l];s.id==r.id&&t(o.options.tgc2Settings.selector).find(".tgc2-info-bottom").find('[name="name"]').text(s.name)}i.nodes=i.entityList,i.links=i.relationList,delete i.entityList,delete i.relationList,a(i),e.netChart.resetLayout()}else n&&n(),e.netChart.replaceData({nodes:[],links:[]})},error:function(){n&&n(),toastr.error("网络接口错误！")}})},a.prototype.nodeStyleFunction=function(e){var t=this,a=t.tgc2.startInfo;e.label=e.data.name,e.labelStyle.textStyle.font="18px Microsoft Yahei",e.aura=e.data.auras,e.radius=15,e.imageCropping="fit";var n=e.id==a.id;0==e.data.kgType?(e.lineWidth=10,e.lineColor=t.options.primaryLightColor,e.fillColor=t.options.primaryColor,e.image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhENzQwNUZFMTVFQjExRTc4QTJDOTY3REE4RkM4MjFCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhENzQwNUZGMTVFQjExRTc4QTJDOTY3REE4RkM4MjFCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEQ3NDA1RkMxNUVCMTFFNzhBMkM5NjdEQThGQzgyMUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEQ3NDA1RkQxNUVCMTFFNzhBMkM5NjdEQThGQzgyMUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7rBsIlAAAFUklEQVR42uydX05TURDGp5V3ygq8JJJINIGugLICy4PySF0BdQGGsgLqCixviibCCrisgJLoEybUFUjfNfVM7iESUyi1vXNmzvm+ZCJg0p5753fmzPlfGY1GBKWrCgAAAHgLAAACABAAgAAABAAgAAABAAgAxKDM2Zqzdf8zW83/Pk59Z9fOBt749wv/MwAwIHbuC2cNb9mcPpcByL2deEgAgCLtOGt6k9Cxt0MAELa27zpr+59DiCNB19k7q1HBIgDs7D1nrYCOHwdCz9m+NRCsAcA1vqPI8eNA6PiIAADmKM7a39+TvWsT9x5e+38BwIza87XKotrao4FmADjMf/HdOcviruOW1txAKwDWQr7ZJkEjAOz0U8WJ3iwJ4qY2CLQBEKvz1UKgCYDYna8SAi0ApOL82xDUScEkkwYAat7565SW+j4SXKcOAGf7LUpTPd87SBYAHig5oLT1hooJpeQAyJydJ9Tuq8wHQgLAo3xNgli8tmArJQCaHgDor7Y8CEkAcEXzW64Vi7gJWJb+0mqAB23B+XfmRK0UIgBqv6IoIA1Ag4pBH+hu8eBQHmsT0IJ/db0jyQhQ8+G/Bh9PHBdYJqEhYskI0ITzH1xRGjE2ARIPdeTsubMFjm4l2IL//COByhJdE1B29v/Z2UtBoD86e2W9NyAFAE/1npf8HVwzvwkC8MzZ1xI/f5kE5gekmgCJfv+lcFt9KVBposkBJB5mRRiAFQCg62H2hAF4CwCm69qULU4APzhbdfaoxPe16r9nO4J3JpYE5s42FPW1K/f8n5Zl0mcSXWcpALTtPrEAAI8ELgGAdAGYVE4AAAAAAAAw0gs4I0jlO6viPactAKBXUa0HyOHPqdWPCYAB/Jk2AH34U2elkVwQwm3aIrqBD9KQhOYCJJNA5AEPl9gWsWqMDxWBxCqLZBOQUbEuEE3AZC1RhMvCOanBiOBkid5HID0Q1IV/J6onGgoDbA7lSPAYTcBY/SDhjbPV2Ak3JvEIGSICcP+2HzgK8A6f32P+zmsJfwWs/eskfGxciAhwc6lCSD2d8u8S6lCAMwNDHhIVMhf4ROO3dUms9h2nCwp0UGZIACS2i90n3tvHd/x8d/aEin0F24HKUqdA8yWhD4rskPyGDm3aD9kkajgqlslfS9T5Imv/tQOQeQgWE3P+0DeDg9QBuMkH8oQgGPqaH3ydhKYLI1I6PTTIqaDaAWC1qDg+Pmbx8fA9LYXReGkUQ9CNsDngsN8mZUPhmq+NiyknUNPmWwEgJgjUOl87AERxHC1bJ8Wroi3cHcxt5o5R5x+S8uNxLQAQes5gFokc9RY7AEQ6VhFNK/HVPf8jK5tDBwZrv4kyY3dw4gIAAAACAFAZugYA81NuEIA+AEjsZVoss5VxAGtjAcFW+cYMgKURwTqhCSglpPJiiqHiMg59Gc00WZYiwO1IwAtGNpSVi1f4tq3lKxYBuFFGxXRxpiA3ycnoSWiWAYAAAAQAIAAApdENvC0+ZII3lfKpY6PA9tPZARm9F9liBOAXfUr6Rtq4+7dJRiaBLAPAYwC7SsumfhFoDACUfQn1LBK56St1ALQXuAIAym9rtR4oYWIlsPVeQBdlwziAxkTQXAJoGQBWg4pDJUJ3BwdUbF/LMQ4AAQAIAEAAAAIAYcXZ+MYc++Q8wnfsM30AoFw5lbde0OSET0oASIwPmOzvpwKA1MNUYnlhMW0OlRwQaiACpB0BxO71QwSYTicC33GGJFCvyr6QSsUR7wBgMgQd306vzdHxPA7Qjqn2xwoABAAgAAABAAgAQAAAAgAQAIAAAAQAoH/1R4ABAHF3K+2bw1JCAAAAAElFTkSuQmCC",n&&(e.fillColor=t.options.emphasesColor,e.lineColor=t.options.emphasesLightColor)):(e.lineWidth=2,e.lineColor=t.options.primaryColor,e.fillColor=t.options.lightColor,e.image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjA3RUVGNzVBMTVFQzExRTdBM0FERjI5RjczQUM4N0QyIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjA3RUVGNzVCMTVFQzExRTdBM0FERjI5RjczQUM4N0QyIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDdFRUY3NTgxNUVDMTFFN0EzQURGMjlGNzNBQzg3RDIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDdFRUY3NTkxNUVDMTFFN0EzQURGMjlGNzNBQzg3RDIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5z4BZ4AAADHUlEQVR42uzbTU4UQRyG8QYMbLyBK1mKiR8L3RsXfnABWeugO7mIrkwEcc0FJGFhOIExaohLogtvIDGQCP47NAkboGeYwuqu35O8mYR0MdNTz1Qq1XknDg4OKpTLBAEI4FsgAAgAAoAAIAAIAAKAACAACAACgAAgAAgAAoAAIAAIAAKAACAACAACnMTKysq1eHkaeRi52vx5O7IRWY18L3kCBoNBPwWIiZ+Ol1eRF5HJEy7bj7yLLEX+DPkW9f9/HnkSuR653DM3fke2ImuRtyHKXmcEaCZ/PXK/5ZDNZoVoe5NXIh8iNwtZKL5E5kOCX+P+x5OJPvDrISa/5l6zWrT95Zc0+VVzr+vxw5rJXoD4kHPxsjjC0Ho5n2tx3WJhk3/EjXrL0IUVoN7wTY0wbqoZexYLBe8ZF7ogwIPEY28XLMCtLggwm3jsdMECzHRBgPOwV+FCSSHA9jnG/iTJmWcD2QuwcY6xH1tc87lgAba6IMD7yN8RxtVjVltct1awAGvZCzAYDGpLl0cYutzS8Pq6rwVO/rcRv9f/sglcarmcH7HZjGnDbuRxdXg8Wgq18I/ix7XbCQGaBxf1JL2pDh/4nMR+Y/X8kJu7+kz8buRl5FNkp4eTvtPcW32Pd1I8B6i5iMfB9fHus+rwkGe2megfzQqxmmJj0yV6+zh4CEEqAvTrHAAdggAEAAFAABAABAABQAAQAAQAAUAA9JtLqd9AOzhvtIPzRTv4FLSDM98DaAePF+3gY2gHZ74CaAenQzu40g7OXgDt4HRoByN/AbSD054NZC+AdnA6tIMr7eC8BdAOToZ2cIN2cO4CaAePBe3gEtAO1g7u3TkAOgQBCAACgAAgAAgAAoAAIAAIAAKAAOg32sGFox2cL9rBp6AdnPkeQDt4vGgHH0M7OPMVQDs4HdrBlXZw9gJoB6dDOxj5C6AdnPZsIHsBtIPToR1caQfnLYB2cDK0gxu0g3MXQDt4LGgHl0Dx7WBUBAABQAAQAAQAAUAAEAAEAAFAABAABAABQAAQAAQAAUAAEAAEAAFAABAABAABMCT/BBgA8SDQyY7AsYEAAAAASUVORK5CYII=",n&&(e.fillColor=t.options.lightColor,e.lineColor=t.options.emphasesColor)),e.hovered&&(e.radius=1.25*e.radius)},a}e.HieknConceptGraphService=a()}(window,jQuery),function(e,t){"use strict";function a(){var e=function(e){var a=this,n={beforeDrawPrompt:null,container:null,data:null,baseUrl:null,kgName:null,ready:t.noop,replaceSearch:!1,onSearch:t.noop};a.options=t.extend(!0,{},n,e),a.init()};return e.prototype.init=function(){var e=this,a=new HieknSDKService(e.options),n={0:"概念",1:"实例"},o={drawPromptItem:function(e,t){var a='<span class="prompt-tip-title">'+e.name.replace(new RegExp("("+t+")","gi"),'<span class="highlight">$1</span>')+"</span>";return a='<span class="prompt-tip-type prompt-tip-'+e.kgType+'">'+(n[e.kgType]||"")+"</span>"+a},onPrompt:a.onPromptKnowledge(e.options)};e.options.replaceSearch&&(o.beforeSearch=a.beforeSearch()),t.extend(!0,o,e.options),e.instance=new hieknPrompt(o),e.options.ready(e.instance)},e}e.HieknConceptPromptService=a()}(window,jQuery),function(e,t){"use strict";function a(){var e=function(e){var a=this;a.clickTimeout=null,a.isFirst=!0,a.lastSelectedNode=null,a.startAsync=!1,a.treeDbClick=!1;var n={container:null,data:null,baseUrl:null,kgName:null,getAsyncUrl:function(){var e=a.options.data||{};return e.kgName=a.options.kgName,a.options.readAll?e.id=a.getLastSelectedNodeId()||0:e.id=a.getLastSelectedNodeId()||a.options.initId,e.onlySubTree=a.isFirst?0:1,a.options.baseUrl+"concept?"+t.param(e)},idKey:"id",initId:0,nameKey:"name",onNodeClick:t.noop,nodeHoverTools:{infobox:{enable:!1},graph:{enable:!1,instanceEnable:!1,infobox:!1,conceptGraphSettings:{}}},instance:{enable:!1,url:"",onClick:t.noop},namespace:"hiekn-concept-tree",pIdKey:"parentId",readAll:!1,hiddenIds:{self:[],rec:[]}};a.options=t.extend(!0,{},n,e),a.zTreeSettings=null,a.zTree=null,a.infoboxService=null,a.tgc2ConceptGraph=null,a.instanceSearch=null,a.init()};return e.prototype.init=function(){var e=this;if(e.$container=t(e.options.container),e.treeId=e.options.namespace+"-"+(new Date).getTime(),e.$container.addClass("hiekn-concept-tree").append('<ul class="ztree" id="'+e.treeId+'"></ul>'),e.zTreeSettings=e.updateZTreeSettings(),e.zTree=t.fn.zTree.init(e.$container.find(".ztree"),e.zTreeSettings),e.options.nodeHoverTools.graph.enable&&e.initGraph(),e.options.nodeHoverTools.infobox.enable&&e.initInfobox(),e.options.instance.enable){var a=e.options.namespace+"-prompt-"+(new Date).getTime();e.$instanceContainer=t('<div class="hiekn-instance-container"><div class="hiekn-instance-prompt" id="'+a+'"></div><div class="hiekn-instance-list"></div></div>'),e.$container.append(e.$instanceContainer),e.instanceSearchSettings={container:"#"+a,promptEnable:!1,placeholder:"实例搜索",onSearch:function(a){var n={paramName:"kw",url:e.options.baseUrl+"prompt",type:1};t.extend(!0,n,e.options.instance.searchSettings||{});var o=e.options.data||{},r=e.options.data2||{};r.kgName=e.options.kgName,r[n.paramName||"kw"]=a,hieknjs.kgLoader({url:n.url+"?"+t.param(o),params:r,type:n.type,dataFilter:e.options.dataFilter||function(e){return e},success:function(t){if(t){var a=e.select(".instance-loader-container");a.attr({"data-more":"0","data-page":"1"}),e.drawInstanceList(t.rsData,!1)}}})}},e.instanceSearch=new hieknPrompt(e.instanceSearchSettings),e.bindInstanceEvent()}},e.prototype.addHoverDom=function(e,a){var n=this,o=n.select("#"+a.tId+"_span");if(!(n.select("#button-container_"+a.tId).length>0)){var r=t('<span class="button-container" id="button-container_'+a.tId+'" ></span>');o.after(r),n.onNodeHover(r,a)}},e.prototype.beforeAsync=function(e,t){var a=this;return t&&(a.startAsync=!0,a.lastSelectedNode=t),!0},e.prototype.bindInstanceEvent=function(){var e=this;e.select(".hiekn-instance-list").on("scroll",function(a){t(a.target).height()+t(a.target).scrollTop()>t(a.target)[0].scrollHeight-50&&e.loadInstanceService()}),e.select(".hiekn-instance-list").on("click","li[data-id]",function(){var a=t(this).data("data");t(this).addClass("active").siblings(".active").removeClass("active"),e.options.instance.onClick(a)})},e.prototype.dataFilter=function(e,t,a){var n=this;if(n.options.dataFilter&&(a=n.options.dataFilter(a)),200==a.code){if(!a.data||!a.data.rsData)return null;a=a.data.rsData;for(var o=a.length,r=[],i=0;i<o;i++)!n.options.readAll&&(a[i].isParent=!0),_.indexOf(n.options.hiddenIds.self,a[i][n.options.idKey])<0&&_.indexOf(n.options.hiddenIds.rec,a[i][n.options.idKey])<0&&_.indexOf(n.options.hiddenIds.rec,a[i][n.options.pIdKey])<0&&(t&&a[i][n.options.idKey]==t[n.options.idKey]||r.push(a[i])),_.indexOf(n.options.hiddenIds.rec,a[i][n.options.pIdKey])>=0&&n.options.hiddenIds.rec.push(a[i][n.options.idKey]);if(0!=r.length)return r;t.isParent=!1}else toastr.error(a.msg);return null},e.prototype.expandNodes=function(e){var t=this,a=t.zTree.getNodeByParam(t.options.idKey,e);if(a){t.zTree.expandNode(a,!0,!1,!0,!1);var n=a.getParentNode();n&&t.expandNodes(n[t.options.idKey])}},e.prototype.drawInstanceList=function(e,a){var n=this,o=n.$instanceContainer.find(".hiekn-instance-list ul"),r=t("<ul></ul>");if(e.length)for(var i in e){var l=t('<li data-id="'+e[i].id+'" title="'+e[i].name+'">'+e[i].name+"</li>").data("data",e[i]);r.append(l)}else a||r.append("<li>没有找到相关实例</li>");a?o.append(r.children()):o.html(r.children())},e.prototype.getLastSelectedNodeId=function(){var e=this;return e.lastSelectedNode?e.lastSelectedNode[e.options.idKey]:null},e.prototype.getLastSelectedInstance=function(){var e=this;return e.select(".hiekn-instance-list li[data-id].active").data("data")},e.prototype.getAsyncUrl=function(){var e=this;return"string"==typeof e.options.getAsyncUrl?e.options.getAsyncUrl:e.options.getAsyncUrl(e)},e.prototype.initInfobox=function(){var e=this,t={};t.kgName=e.options.kgName,t.baseUrl=e.options.baseUrl,e.infoboxService=new HieknInfoboxService(t)},e.prototype.initGraph=function(){var e=this,a=e.options.namespace+"-tgc2-"+(new Date).getTime();e.$graphContainer=t('<div class="modal fade hiekn-concept-tree-graph-modal" id="'+a+'-modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><i class="fa fa-times-circle"></i></button><h4 class="modal-title"><span name="title"></span></h4></div><div class="modal-body"><div class="'+a+'"></div></div></div></div></div>'),t("body").append(e.$graphContainer);var n={selector:"."+a,baseUrl:e.options.baseUrl,data:e.options.data,kgName:e.options.kgName,instanceEnable:e.options.nodeHoverTools.graph.instanceEnable,tgc2Settings:{netChart:{settings:{nodeMenu:{}}}}};t.extend(!0,n,e.options.nodeHoverTools.graph.conceptGraphSettings),e.options.nodeHoverTools.graph.infobox&&(e.sdkUtils=new HieknSDKService,e.sdkUtils.gentInfobox({selector:"."+a,baseUrl:e.options.baseUrl,data:e.options.data,kgName:e.options.kgName}),n.tgc2Settings.netChart.settings.nodeMenu.contentsFunction=e.sdkUtils.infobox()),e.tgc2ConceptGraph=new HieknConceptGraphService(n)},e.prototype.loadGraph=function(e){var t=this;t.tgc2ConceptGraph.load({id:e,kgType:0})},e.prototype.reloadInstance=function(){var e=this;e.select(".hiekn-instance-list").html('<ul></ul><div class="instance-loader-container" data-more="1" data-page="1"></div>'),e.loadInstanceService()},e.prototype.loadInstanceService=function(){var e=this,a=e.select(".instance-loader-container");if("0"!=a.attr("data-more")){var n=e.options.data||{};n.conceptId=e.getLastSelectedNodeId()||e.options.initId,n.readAll=0,n.pageNo=a.attr("data-page"),n.pageSize=15,n.kgName=e.options.kgName,1!=a.data("inLoading")&&(a.data("inLoading",1),hieknjs.kgLoader({url:e.options.instance.url+"?"+t.param(n),dataFilter:e.options.dataFilter||function(e){return e},success:function(t,n,o,r){if(t){var i=t.rsData;i.length<=r.pageSize&&a.attr({"data-more":0}),i.length>r.pageSize&&i.pop(),e.drawInstanceList(i,1!=r.pageNo),a.attr({"data-page":parseInt(r.pageNo,10)+1})}},complete:function(){a.data("inLoading",0);var t=e.select(".hiekn-instance-list");t.children("ul").height()<t.height()&&e.loadInstanceService()},that:a[0]}))}else console.log("no more instance")},e.prototype.onAsyncSuccess=function(e,t,a){var n=this,o=a;o&&n.onNodeClick(o),o&&0==o.children.length?(o.isParent=!1,n.zTree.updateNode(o),toastr.info("当前概念没有子概念")):o||(n.expandNodes(n.getLastSelectedNodeId()||n.options.initId),n.getLastSelectedNodeId()||(o=n.zTree.getNodeByParam(n.options.idKey,n.options.initId),n.zTree.selectNode(o),n.onNodeClick(o)));var r=n.zTree.getNodeByParam(n.options.idKey,n.options.initId);n.addHoverDom(t,r),n.isFirst=!1,n.startAsync=!1},e.prototype.onClick=function(e,t,a){var n=this;n.clickTimeout&&clearTimeout(n.clickTimeout),n.clickTimeout=setTimeout(function(){n.lastSelectedNode=a,n.onNodeClick(a),n.treeDbClick=!1},500)},e.prototype.onNodeButtonClick=function(e,t){var a=this;a.select(".tree-button-active").removeClass("tree-button-active"),a.zTree.selectNode(t),e.addClass("tree-button-active"),a.lastSelectedNode=t},e.prototype.onNodeClick=function(e){var t=this;t.options.instance.enable&&t.reloadInstance(),t.options.onNodeClick(e)},e.prototype.onNodeHover=function(e,a){var n=this;for(var o in n.options.nodeHoverTools){var r=n.options.nodeHoverTools[o];if("graph"==o&&r.enable){var i=t('<span class="button" title="图谱可视化" onfocus="this.blur();"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="12"><path d="M892.790083 1009.647551c-58.355904 31.366176-131.161266 9.611215-162.610663-48.591301-24.342972-45.045432-16.764962-98.703426 14.947153-135.21462L698.862198 739.012706c-23.246413 7.764034-48.157246 11.970777-74.066732 11.970777-114.073211 0-208.817925-81.626793-227.545924-188.916672l-96.293279-0.561334c-16.764962 45.964127-60.950442 78.79075-112.82979 78.79075-66.291275 0-120.03249-53.600882-120.03249-119.725715 0-66.119938 53.741215-119.725715 120.03249-119.725715 51.30496 0 95.064544 32.111902 112.242348 77.279717l97.913641 0.567861C419.241111 374.137368 512.680397 295.287873 624.795466 295.287873c18.375534 0 36.248477 2.12948 53.382222 6.132249l39.022512-93.152092c-36.248477-32.934321-49.896729-86.177842-30.174973-134.041367 25.204555-61.154415 95.338684-90.360108 156.651383-65.220824 61.319226 25.132756 90.596716 95.089021 65.398689 156.243437-19.504729 47.334826-65.92086 75.494544-114.326137 74.176062l-39.959157 95.382743c60.924334 41.018186 100.921022 110.062283 100.921022 188.324334 0 70.620402-32.565538 133.736223-83.686106 175.526243l46.409604 87.10796c48.521134-7.086843 98.455394 16.133461 123.065979 61.683114C972.95806 905.658773 951.145986 978.273217 892.790083 1009.647551L892.790083 1009.647551zM892.790083 1009.647551"></path></svg></span>');e.append(i),i.on("click",function(e){n.$graphContainer.modal("show"),n.loadGraph(a[n.options.idKey]),e.stopPropagation()})}else if("infobox"==o&&r.enable){var l=t('<span class="button" title="知识卡片" onfocus="this.blur();"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="12"><path d="M638.596211 191.936191q30.628116 0 54.62014 13.272183t41.347956 32.66999 26.544367 41.858425 9.188435 39.81655l0 576.829511q0 29.607178-11.740778 53.088734t-30.628116 39.81655-42.368893 25.52343-46.963111 9.188435l-503.322034 0q-19.397807 0-42.368893-11.230309t-42.879362-29.607178-33.180459-42.368893-13.272183-48.494516l0-568.662014q0-21.439681 10.209372-44.410768t26.544367-42.368893 37.774676-32.159521 44.921236-12.761715l515.57328 0zM578.360917 830.021934q26.544367 0 45.431705-18.376869t18.887338-44.921236-18.887338-45.431705-45.431705-18.887338l-382.851446 0q-26.544367 0-45.431705 18.887338t-18.887338 45.431705 18.887338 44.921236 45.431705 18.376869l382.851446 0zM578.360917 574.787637q26.544367 0 45.431705-18.376869t18.887338-44.921236-18.887338-45.431705-45.431705-18.887338l-382.851446 0q-26.544367 0-45.431705 18.887338t-18.887338 45.431705 18.887338 44.921236 45.431705 18.376869l382.851446 0zM759.0668 0q43.900299 0 80.654038 26.033898t63.808574 64.319043 42.368893 82.695912 15.314058 81.164506l0 542.117647q0 21.439681-12.761715 39.306082t-31.138584 30.628116-39.81655 20.418744-39.81655 7.657029l-4.083749 0 0-609.499501q-8.167498-70.444666-43.900299-108.219342t-94.947159-49.004985l-498.217348 0q1.020937-2.041874 1.020937-7.14656 0-20.418744 12.251246-41.858425t32.159521-38.795613 44.410768-28.586241 49.004985-11.230309l423.688933 0z"></path></svg></span>');e.append(l),l.tooltipster({side:["bottom"],theme:"tooltipster-shadow",distance:16,interactive:!0,trigger:"click",content:"Loading...",functionBefore:function(e,o){var r=t(o.origin);if(r.data("loaded")!==!0){var i=a[n.options.idKey];n.infoboxService.load(i,function(t){var a=n.infoboxService.buildInfobox(t);e.content(a),n.infoboxService.initEvent(a),r.data("loaded",!0)},function(){e.content("read data failed")})}}}),l.on("click",function(e){e.stopPropagation()})}else r instanceof Function&&r(e,a)}return!0},e.prototype.removeHoverDom=function(e,t){var a=this;if(t.level>0){var n=a.select("#button-container_"+t.tId);n.children().off("click"),n.remove()}},e.prototype.select=function(e){var a=this;return t(a.options.container).find(e)},e.prototype.updateZTreeSettings=function(){var e=this;return{async:{enable:!0,url:function(){return e.getAsyncUrl()},dataFilter:function(t,a,n){return e.dataFilter(t,a,n)},type:"get"},view:{showLine:!1,showIcon:!1,expandSpeed:"fast",dblClickExpand:function(e,t){return t.level>0},selectedMulti:!1,addHoverDom:function(t,a){e.addHoverDom(t,a)},removeHoverDom:function(t,a){e.removeHoverDom(t,a)}},callback:{beforeAsync:function(t,a){return e.beforeAsync(t,a)},onAsyncSuccess:function(t,a,n){return e.onAsyncSuccess(t,a,n)},onClick:function(t,a,n){return e.onClick(t,a,n)},onDblClick:function(){e.treeDbClick=!0}},data:{simpleData:{enable:!0,pIdKey:e.options.pIdKey,idKey:e.options.idKey},key:{name:e.options.nameKey}}}},e}e.HieknConceptTreeService=a()}(window,jQuery),function(){function e(){var e=function(){this.colorList={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},this.colorBase=["#7bc0e1","#9ec683","#fde14d","#ab89f4","#e26f63","#dca8c6","#596690","#eaad84","#abe8bf","#7979fc"],this.colorEx=["#6db5d6","#d0648a","#c0d684","#f2bac9","#847d99","#baf2d8","#bfb3de","#f4817c","#94cdba","#b2cede"],this.color=this.colorBase.concat(this.colorEx)};return e.prototype.drawPromptItem=function(e){var t={};for(var a in e.types){var n=e.types[a];t[n.k]=n.v}return function(e,a){var n=e.name;e.meaningTag&&(n=n+" ( "+e.meaningTag+" )");var o='<span class="prompt-tip-title">'+n.replace(new RegExp("("+a+")","gi"),'<span class="highlight">$1</span>')+"</span>";return o='<span class="prompt-tip-type prompt-tip-'+e.classId+'">'+(e.className||t[e.classId]||"")+"</span>"+o}},e.prototype.drawPromptItems=function(e,t){var a={};for(var n in e.types){var o=e.types[n];a[o.k]=o.v}return function(e,a){var n=$("<div></div>");return e.forEach(function(e){var o=t.instance.options.drawPromptItem(e,a),r=t.instance.options.drawItemTitle(e),i="prompt-item-"+e.classId,l=$('<li title="'+r+'" class="'+i+'">'+o+"</li>").data("data",e),s=n.find("."+i);s.length?($(s[s.length-1]).after(l),l.find(".prompt-tip-type").empty()):n.append(l)}),n.children()}},e.prototype.onPromptStart=function(e){return function(t,a){var n=e.data||{},o=e.data2||{};o.kgName=e.kgName,o[e.paramName]=t,hieknjs.kgLoader({url:e.url+"?"+$.param(n),params:o,type:e.type,dataFilter:e.dataFilter||function(e){return e},success:function(n){if(a.prompt==o[e.paramName]){var r=n.rsData;e.beforeDrawPrompt&&(r=e.beforeDrawPrompt(r,t)),a.startDrawPromptItems(r,t)}}})}},e.prototype.onPrompt=function(e){var t=this;return e.paramName="kw",e.url=e.baseUrl+"prompt",e.type=1,t.onPromptStart(e)},e.prototype.onPromptKnowledge=function(e){var t=this;return e.paramName="text",e.url=e.baseUrl+"prompt/knowledge",e.type=0,t.onPromptStart(e)},e.prototype.beforeSearch=function(){return function(e,t){e&&t.find("input[type=text]").val(e.name)}},e.prototype.schema=function(e,t){var a=e.data||{},n=e.data2||{};n.kgName=e.kgName,hieknjs.kgLoader({url:e.baseUrl+"schema?"+$.param(a),type:1,dataFilter:e.dataFilter||function(e){return e},params:n,beforeSend:function(){e.that&&$(e.that).find(".ajax-loading").html('<div class="schema-init"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 14 32 18" width="32" height="4" preserveAspectRatio="none"><path opacity="0.8" transform="translate(0 0)" d="M2 14 V18 H6 V14z"><animateTransform attributeName="transform" type="translate" values="0 0; 24 0; 0 0" dur="2s" begin="0" repeatCount="indefinite" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" /></path><path opacity="0.5" transform="translate(0 0)" d="M0 14 V18 H8 V14z"><animateTransform attributeName="transform" type="translate" values="0 0; 24 0; 0 0" dur="2s" begin="0.1s" repeatCount="indefinite" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" /></path><path opacity="0.25" transform="translate(0 0)" d="M0 14 V18 H8 V14z"><animateTransform attributeName="transform" type="translate" values="0 0; 24 0; 0 0" dur="2s" begin="0.2s" repeatCount="indefinite" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" /></path></svg></div>')},success:function(e){if(e&&e.rsData&&e.rsData.length){var a=e.rsData[0];t(a)}},error:function(){toastr.error("网络接口错误！")},that:e.that})},e.prototype.segment=function(e,t){var a=e.data||{},n=e.data2||{};a.kgName=e.kgName,a.kw=e.kw,hieknjs.kgLoader({url:e.baseUrl+"segment?"+$.param(a),type:0,dataFilter:e.dataFilter||function(e){return e},params:n,success:function(e){if(e&&e.rsData&&e.rsData.length){var a=e.rsData;t(a)}},error:function(){toastr.error("网络接口错误！")},that:e.that})},e.prototype.disambiguate=function(e,t){var a=e.data||{},n=e.data2||{};a.kgName=e.kgName,a.kw=e.kw,hieknjs.kgLoader({url:e.baseUrl+"disambiguate?"+$.param(a),type:0,dataFilter:e.dataFilter||function(e){return e},params:n,success:function(e){if(e&&e.rsData&&e.rsData.length){var a=e.rsData;t(a)}},error:function(){toastr.error("网络接口错误！")},that:e.that})},e.prototype.tagging=function(e,t){var a=e.data||{},n=e.data2||{};a.kgName=e.kgName,a.kw=e.kw,hieknjs.kgLoader({url:e.baseUrl+"tagging?"+$.param(a),type:0,dataFilter:e.dataFilter||function(e){return e},params:n,success:function(e){if(e&&e.rsData&&e.rsData.length){var a=e.rsData;t(a)}},error:function(){toastr.error("网络接口错误！")},that:e.that})},e.prototype.association=function(e,t){var a=e.data||{},n=e.data2||{};n.kgName=e.kgName,n.id=e.id,n.allowAtts=e.allowAtts,n.pageSize=e.pageSize||6,hieknjs.kgLoader({url:e.baseUrl+"association?"+$.param(a),type:1,dataFilter:e.dataFilter||function(e){return e},params:n,success:function(e){if(e&&e.rsData&&e.rsData.length){var a=e.rsData;t(a)}},error:function(){toastr.error("网络接口错误！")},that:e.that})},e.prototype.gentInfobox=function(e){var t=this,a=e.data||{};a.isRelationAtts=!0,t.infoboxService=new HieknInfoboxService({baseUrl:e.baseUrl,kgName:e.kgName,imagePrefix:e.imagePrefix,data:a}),t.infoboxService.initEvent($(e.selector))},e.prototype.infobox=function(){var e=this;return function(t,a,n){return a.detail?n(a.detail):e.infoboxService.load(t.id,function(t){t=e.infoboxService.buildInfobox(t)[0].outerHTML,a.detail=t,n(t)}),null}},e.prototype.legend=function(e){var t={};for(var a in e.types){var n=e.types[a];t[n.k]=n.v}return function(e,a){return'<i style="background: '+a+'"></i><span title="'+t[e]+'">'+t[e]+"</span>"}},e.prototype.legendDraw=function(e,t,a){var n={};for(var o in e.types){var r=e.types[o];n[r.k]=r.v}return function(e,o){t.legendFilter={};var r=_.filter(t.tgc2.getAvailableData().nodes,function(e){return!e.hidden}),i=_.keys(_.groupBy(r,"classId"));if("fab"==a){var l=[];for(var s in e)if(_.indexOf(i,s)>=0){var d="",c=n[s];d=c.length>3?'<div title="'+c+'"><div>'+c.substring(0,2)+'</div><div class="line-hidden">'+c.substring(2)+"</div></div>":'<div class="line-hidden" title="'+c+'">'+c+"</div>",l.push({html:d,data:{key:s,value:e[s]},style:{background:e[s],color:"#fff"},events:{click:function(e){t.sdkUtils.legendClick(e,t)},mouseenter:function(e){
t.sdkUtils.legendMouseEnter(e,t)},mouseleave:function(e){t.sdkUtils.legendMouseLeave(e,t)},dblclick:function(e){t.sdkUtils.legendDblClick(e,t)}}})}new hieknjs.fab({container:o,radius:80,angle:90,startAngle:90,initStatus:t.layoutStatus,main:{html:"图例",style:{background:t.primary||"#00b38a",color:"#fff"},events:{click:function(){t.layoutStatus=!t.layoutStatus}}},items:l})}else{o.html("");for(var s in e)if(_.indexOf(i,s)>=0){var u=$('<div class="tgc2-legend-item tgc2-legend-item-'+s+'"></div>').data({key:s,value:e[s]}),d=u.html('<i style="background: '+e[s]+'"></i><span title="'+n[s]+'">'+n[s]+"</span>");o.append(d)}}}},e.prototype.legendClick=function(e,t){var a=$(e.currentTarget);a.toggleClass("off");var n=a.data("key");t.legendFilter[n]=a.hasClass("off"),t.tgc2.netChart.updateFilters()},e.prototype.legendDblClick=function(e,t){var a=$(e.currentTarget),n=a.removeClass("off").siblings();n.addClass("off");var o=a.data("key");t.legendFilter={},t.legendFilter[o]=!1;for(var r=0;r<n.length;r++){var i=$(n[r]).data("key");t.legendFilter[i]=!0}t.tgc2.netChart.updateFilters()},e.prototype.legendMouseEnter=function(e,t){var a=$(e.currentTarget);a.addClass("active").siblings().addClass("inactive"),t.nodeSettings.legendClass=a.data("key"),t.nodeSettings.legendColor=a.data("value"),t.tgc2.netChart.updateStyle()},e.prototype.legendMouseLeave=function(e,t){var a=$(e.currentTarget);a.removeClass("active inactive").siblings().removeClass("active inactive"),t.nodeSettings.legendClass=null,t.nodeSettings.legendColor=null,t.tgc2.netChart.updateStyle()},e.prototype.nodeFilter=function(e,t){return t.tgc2.inStart(e.id)||!t.legendFilter[e.classId]},e.prototype.qiniuImg=function(e){return e+"?_="+parseInt((new Date).getTime()/36e5)},e.prototype.nodeStyleFunction=function(e){var t=this;return e.enableAutoUpdateStyle&&setInterval(function(){if(t.centerNode){var a=e.tgc2.netChart.getNodeDimensions(t.centerNode).radius;if(t.nodeRadius!=a){var n=e.tgc2.netChart.nodes(),o=[];for(var r in n)o.push(n[r].id);e.tgc2.netChart.updateStyle(o)}}},30),function(a){e.tgc2.nodeStyleFunction(a),a.imageCropping="fit",!$.isEmptyObject(e.tgc2.nodeIds)||e.legendClass?e.tgc2.nodeIds[a.id]||e.legendClass==a.data.classId?a.radius=1.5*a.radius:(a.fillColor=e.tgc2.settings.netChart.reduceColor,a.label="",a.lineColor=a.fillColor,a.radius=.5*a.radius):e.tgc2.inStart(a.id)||(a.fillColor=a.data.color||"#fff",a.lineColor="#00b38a",a.hovered&&(a.fillColor=a.lineColor,a.shadowBlur=0)),e.nodeColors&&e.nodeColors[a.data.classId]&&(a.lineWidth=2,!$.isEmptyObject(e.tgc2.nodeIds)||e.legendClass?(e.tgc2.nodeIds[a.id]||e.legendClass==a.data.classId)&&(a.fillColor=e.legendColor||e.tgc2.settings.netChart.emphasesColor,a.lineColor=a.fillColor):e.tgc2.inStart(a.id)?(a.fillColor=e.tgc2.settings.netChart.emphasesColor,a.lineColor=a.fillColor):(a.lineColor=e.nodeColors[a.data.classId],e.imagePrefix||e.images||a.data.img||(a.fillColor=a.lineColor),a.hovered&&(a.fillColor=a.lineColor))),a.data.img?(0!=a.data.img.indexOf("http")&&e.imagePrefix?a.image=t.qiniuImg(e.imagePrefix+a.data.img):a.image=a.data.img,!$.isEmptyObject(e.tgc2.nodeIds)||e.legendClass?e.tgc2.nodeIds[a.id]||e.legendClass==a.data.classId||(a.image=""):e.tgc2.inStart(a.id)||a.hovered||(a.image=""),a.fillColor="#fff"):e.images&&e.images[a.data.classId]&&(!$.isEmptyObject(e.tgc2.nodeIds)||e.legendClass?e.tgc2.nodeIds[a.id]||e.legendClass==a.data.classId?a.image=e.legendColor||e.images[a.data.classId].emphases:a.image="":e.tgc2.inStart(a.id)||a.hovered?a.image=e.images[a.data.classId].emphases:a.image=e.images[a.data.classId].normal);var n=e.tgc2.netChart.getNodeDimensions(a).radius;e.enableAutoUpdateStyle&&(n<e.minRadius&&(a.image="",a.fillColor=a.lineColor),e.tgc2.inStart(a.id)&&(t.nodeRadius=n,!t.centerNode&&(t.centerNode=a))),e.textColors&&e.textColors[a.data.classId]&&("string"==typeof e.textColors[a.data.classId]?a.labelStyle.textStyle.fillColor=e.textColors[a.data.classId]:e.tgc2.inStart(a.id)||e.tgc2.nodeIds[a.id]?a.labelStyle.textStyle.fillColor=e.textColors[a.data.classId].emphases:a.hovered?a.labelStyle.textStyle.fillColor=e.textColors[a.data.classId].emphases:a.labelStyle.textStyle.fillColor=e.textColors[a.data.classId].normal);var o=a.label.length;if("roundtext"==a.display){for(var r=a.label,i=1;i<r.length-1;i++){var l=/^[\u4e00-\u9fa5]$/,s=/^[a-zA-Z]$/,d=r.charAt(i),c=r.charAt(i+1);(l.test(d)&&s.test(c)||s.test(d)&&l.test(c))&&(r=r.substring(0,i+1)+" "+r.substring(i+1),i++)}if(a.label=r,a.label.indexOf(" ")<0&&o>5)if(o>9){var u=Math.floor(a.label.length/3),h=o-u;a.label=a.label.substring(0,u)+" "+a.label.substring(u,h)+" "+a.label.substring(h)}else o>5&&(a.label=a.label.substring(0,4)+" "+a.label.substring(4))}}},e.prototype.colorFade=function(e,t){try{var a=[];return this.colorList[e]&&(e=this.colorList[e]),0==e.indexOf("rgb")||0==e.indexOf("hsl")?a=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(","):0==e.indexOf("#")&&(e=e.substring(1),a=e.match(/.{2}/g).map(function(e){return parseInt(e,16)})),a[3]=parseInt((a[3]||1)*t*100)/100,0==e.indexOf("hsl")?"hsla("+a[0]+","+a[1]+","+a[2]+","+a[3]+")":"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")"}catch(n){return e}},e.prototype.buildFilter=function(e,t){var a=[],n=[],o=[],r=[];for(var i in e.atts){var l=e.atts[i];1==l.type&&(a.push({value:l.k,label:l.v}),n.push(l.k))}for(var s in e.types){var d=e.types[s];o.push({value:d.k,label:d.v}),r.push(d.k)}return n=t.selectedAtts||n,r=t.selectedTypes||r,[{key:"allowTypes",label:"设定分析主体",selected:r,options:o},{key:"allowAtts",label:"设定分析关系",selected:n,options:a}]},e.prototype.dealGraphData=function(e,t){e.nodes=e.entityList,e.links=e.relationList,delete e.entityList,delete e.relationList;var a={},n=_.concat(t.types,t.atts);for(var o in n){var r=n[o];a[r.k]=r.v}for(var i in e.nodes){var l=e.nodes[i];l.typeName=a[l.classId]}for(var s in e.links){var d=e.links[s];d.typeName=a[d.attId]}return e},e.prototype.linkContentsFunction=function(e){if(e.rInfo=$.extend(!0,[],e.nRInfo||[],e.oRInfo||[]),e.rInfo){var t="";for(var a in e.rInfo){var n=e.rInfo[a];t+="<tr>";var o=n.kvs,r="<tr>",i="<tr>";for(var l in o)o.hasOwnProperty(l)&&(r+='<th><div class="link-info-key">'+o[l].k+"</div></th>",i+='<td><div class="link-info-value">'+o[l].v+"</div></td>");t+="<li><table><thead>"+r+"</thead><tbody>"+i+"</tbody></table></li>"}return'<ul class="link-info">'+t+"</ul>"}return e.typeName},e.prototype.graph=function(e,t){var a=this;return function(n,o,r){var i=e.data||{},l=e.data2||{};if(l.kgName=e.kgName,l.id=e.tgc2.startInfo.id,l.isRelationMerge=!0,e.tgc2Filter){var s=e.tgc2Filter.getFilterOptions();$.extend(!0,l,s)}if(e.tgc2Page){var d=e.tgc2Page.page;l.pageNo=d.pageNo,l.pageSize=d.pageSize}hieknjs.kgLoader({url:e.baseUrl+"graph?"+$.param(i),type:1,dataFilter:e.dataFilter||function(e){return e},params:l,success:function(e){if(e&&e.rsData&&e.rsData.length){var n=e.rsData[0];n&&(n=a.dealGraphData(n,t)),o(n)}else r()},error:function(){r()},that:$(e.selector).find(".tgc2-netchart-container")[0]})}},e.prototype.graphInit=function(e){var t=e.data||{},a=e.data2||{};a.kgName=e.kgName,a.isTiming=e.isTiming,hieknjs.kgLoader({url:e.baseUrl+"graph/init?"+$.param(t),type:1,dataFilter:e.dataFilter||function(e){return e},params:a,success:function(t){if(t&&t.rsData&&t.rsData.length){var a=t.rsData[0];e.success(a)}else e.failed()},error:function(){e.failed()},that:e.that})},e.prototype.orderRelation=function(e){var t={},a=_.countBy(e,"from"),n=_.countBy(e,"to");for(var o in a)t[o]=(t[o]||0)+(n[o]||0)+a[o];for(var r in n)t[r]=(t[r]||0)+(a[r]||0)+n[r];var i=[];for(var l in t)i.push({k:l,v:t[l]});return _.orderBy(i,"v","desc")},e.prototype.timing=function(e,t){var a=this;return function(n,o,r){var i=e.data||{},l=e.data2||{};if(l.kgName=e.kgName,l.id=e.tgc2.startInfo.id,l.isRelationMerge=!0,e.tgc2Filter){var s=e.tgc2Filter.getFilterOptions();$.extend(!0,l,s)}if(e.tgc2TimeChart){var d=e.tgc2TimeChart.getSettings();delete d.type,$.extend(!0,l,d)}hieknjs.kgLoader({url:e.baseUrl+"graph/timing?"+$.param(i),type:1,dataFilter:e.dataFilter||function(e){return e},params:l,success:function(e){if(e&&e.rsData&&e.rsData.length){var n=e.rsData[0];n&&(n=a.dealGraphData(n,t)),o(n)}else r()},error:function(){r()},that:$(e.selector).find(".tgc2-netchart-container")[0]})}},e.prototype.relation=function(e,t){var a=this;return function(n,o,r){var i=_.map(e.tgc2.startInfo.nodes,"id"),l=e.data||{},s=e.data2||{};if(s.kgName=e.kgName,s.ids=i,s.isShortest=!0,s.connectsCompute=!0,s.statsCompute=!0,e.tgc2Stats&&(s.statsConfig=e.tgc2Stats.getStatsConfig()),e.tgc2Filter){var d=e.tgc2Filter.getFilterOptions();$.extend(!0,s,d)}hieknjs.kgLoader({url:e.baseUrl+"relation?"+$.param(l),type:1,dataFilter:e.dataFilter||function(e){return e},params:s,success:function(e){if(e&&e.rsData&&e.rsData.length){var n=e.rsData[0];n&&(n=a.dealGraphData(n,t)),o(n)}else r()},error:function(){toastr.error("网络接口错误！"),r()},that:$(e.selector).find(".tgc2-netchart-container")[0]})}},e.prototype.path=function(e,t){var a=this;return function(n,o,r){var i=e.data||{},l=e.data2||{};if(l.kgName=e.kgName,l.start=e.tgc2.startInfo.start.id,l.end=e.tgc2.startInfo.end.id,l.isShortest=!0,l.connectsCompute=!0,l.statsCompute=!0,e.tgc2Stats&&(l.statsConfig=e.tgc2Stats.getStatsConfig()),e.tgc2Filter){var s=e.tgc2Filter.getFilterOptions();$.extend(!0,l,s)}hieknjs.kgLoader({url:e.baseUrl+"path?"+$.param(i),type:1,dataFilter:e.dataFilter||function(e){return e},params:l,success:function(e){if(e&&e.rsData&&e.rsData.length){var n=e.rsData[0];n&&(n=a.dealGraphData(n,t)),o(n)}else r()},error:function(){toastr.error("网络接口错误！"),r()},that:$(e.selector).find(".tgc2-netchart-container")[0]})}},e}window.HieknSDKService=e()}(),function(e,t){"use strict";function a(){var a=function(a){var n=this;n.isInit=!1,n.baseSettings={baseUrl:a.baseUrl,data:a.data,kgName:a.kgName},n.filterSettings={selectedAtts:a.selectedAtts,selectedTypes:a.selectedTypes},n.infoboxSettings={enable:"boolean"!=typeof a.infobox||a.infobox,dataFilter:a.dataFilter,selector:a.selector,imagePrefix:a.imagePrefix},t.extend(!0,n.infoboxSettings,n.baseSettings),n.loaderSettings={dataFilter:a.dataFilter,selector:a.selector,tgc2:null,tgc2Filter:null,tgc2Page:null},t.extend(!0,n.loaderSettings,n.baseSettings),n.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof a.enableAutoUpdateStyle||a.enableAutoUpdateStyle,imagePrefix:a.imagePrefix,images:a.images,nodeColors:a.nodeColors,textColors:a.textColors,minRadius:a.minRadius||10,legendClass:null,legendColor:null,tgc2:null},n.promptSettings=n.baseSettings,n.schemaSettings={preloadData:a.schema,dataFilter:a.dataFilter,that:t(a.selector)[0]},t.extend(!0,n.schemaSettings,n.baseSettings),n.initSettings={dataFilter:a.dataFilter,that:t(a.selector)[0],isTiming:!1,success:function(e){e.entityList&&e.entityList.length&&n.load(e.entityList[0])},failed:t.noop},t.extend(!0,n.initSettings,n.baseSettings),n.tgc2Settings={},n.legendFilter={},n.layoutStatus=a.layoutStatus,n.sdkUtils=new e.HieknSDKService,n.schemaSettings.preloadData?n.init(a,n.schemaSettings.preloadData):n.sdkUtils.schema(n.schemaSettings,function(e){n.init(a,e)})};return a.prototype.init=function(e,a){var n=this;if(e.autoColor){var o={};for(var r in a.types)o[a.types[r].k]=n.sdkUtils.color[r%n.sdkUtils.color.length];t.extend(!0,o,n.nodeSettings.nodeColors||{}),n.nodeSettings.nodeColors=o}var i=n.sdkUtils.buildFilter(a,n.filterSettings);i=[{key:"distance",label:"设定显示层数",selected:e.selectedDistance||1,options:[1,2,3]}].concat(i);var l={selector:e.selector,prompt:{enable:!0,settings:{drawPromptItem:n.sdkUtils.drawPromptItem(a),onPrompt:n.sdkUtils.onPrompt(n.promptSettings)}},page:{enable:!0,pageSize:20},filter:{enable:!0,filters:i},crumb:{enable:!0},find:{enable:!0},legend:{enable:!0,data:n.nodeSettings.nodeColors||[],legendDraw:n.sdkUtils.legendDraw(a,n,e.legendType),onClick:function(e){n.sdkUtils.legendClick(e,n)},onDblClick:function(e){n.sdkUtils.legendDblClick(e,n)},onMouseEnter:function(e){n.sdkUtils.legendMouseEnter(e,n)},onMouseLeave:function(e){n.sdkUtils.legendMouseLeave(e,n)}},netChart:{settings:{filters:{nodeFilter:function(e){return n.sdkUtils.nodeFilter(e,n)}},nodeMenu:{contentsFunction:n.sdkUtils.infobox()},style:{node:{display:e.display||"circle"},nodeStyleFunction:n.sdkUtils.nodeStyleFunction(n.nodeSettings)},info:{linkContentsFunction:n.sdkUtils.linkContentsFunction}}},loader:n.sdkUtils.graph(n.loaderSettings,a)};n.tgc2Settings=t.extend(!0,{},l,e.tgc2Settings),n.infoboxSettings.enable&&n.sdkUtils.gentInfobox(n.infoboxSettings),n.tgc2=new Tgc2Graph(n.tgc2Settings),n.tgc2Filter=new Tgc2Filter(n.tgc2,n.tgc2Settings.filter),n.tgc2Prompt=new Tgc2Prompt(n.tgc2,n.tgc2Settings.prompt),n.tgc2Page=new Tgc2Page(n.tgc2,n.tgc2Settings.page),n.tgc2Crumb=new Tgc2Crumb(n.tgc2,n.tgc2Settings.crumb),n.tgc2Find=new Tgc2Find(n.tgc2,n.tgc2Settings.find),n.tgc2Legend=new Tgc2Legend(n.tgc2,n.tgc2Settings.legend),n.loaderSettings.tgc2=n.tgc2,n.loaderSettings.tgc2Filter=n.tgc2Filter,n.loaderSettings.tgc2Page=n.tgc2Page,n.nodeSettings.tgc2=n.tgc2,n.tgc2.init(),n.isInit=!0,e.startInfo&&n.load(e.startInfo)},a.prototype.load=function(e){var t=this;setTimeout(function(){t.isInit?e?t.tgc2.load(e):t.sdkUtils.graphInit(t.initSettings):t.load(e)},30)},a}e.HieknGraphService=a()}(window,jQuery),function(e,t){"use strict";function a(){var e=function(e){var a=this,n={atts:{visible:[],hidden:[]},selector:null,data:null,baseUrl:null,kgName:null,enableLink:!1,autoLen:!0,imagePrefix:null,onLoad:t.noop,href:null};a.options=t.extend(!0,{},n,e)};return e.prototype.href=function(e){var t=this;t.load(e,t.callback)},e.prototype.initEvent=function(e){var a=this;e.on("click",".hiekn-infobox-link",function(){var e=t(this).attr("data-id");a.options.href?a.options.href(e,a):a.href(e)}),e.on("click",".hiekn-infobox-info-detail a",function(){t(this).closest(".hiekn-infobox-info-detail").toggleClass("on")})},e.prototype.buildEntity=function(e,t){var a=this,n=e.meaningTag?"("+e.meaningTag+")":"",o='<span class="hiekn-infobox-name">'+e.name+'<span class="hiekn-infobox-meaningTag">'+n+"</span></span>";return t&&a.options.enableLink?'<a href="javascript:void(0)" class="hiekn-infobox-link" data-id="'+e.id+'">'+o+"</a>":o},e.prototype.buildExtra=function(e){var t=this,a=e.v||"-";if(t.options.autoLen){var n="number"==typeof t.options.autoLen?t.options.autoLen:80;e.v.length>n&&(a='<span class="hiekn-infobox-info-detail-short">'+e.v.substring(0,n)+'<a href="javascript:void(0)">查看全部&gt;&gt;</a></span><span class="hiekn-infobox-info-detail-long">'+e.v+'<a href="javascript:void(0)">收起&lt;&lt;</a></span>')}return'<tr><td class="hiekn-infobox-info-label">'+e.k+'</td><td class="hiekn-infobox-info-detail">'+a+"</td></tr>"},e.prototype.load=function(e,a,n){var o=this,r=o.options.data||{},i=o.options.data2||{};i.kgName=o.options.kgName,i.id=e,hieknjs.kgLoader({url:o.options.baseUrl+"infobox?"+t.param(r),type:1,params:i,dataFilter:o.options.dataFilter||function(e){return e},success:function(e){if(e&&e.rsData&&e.rsData.length){var r=e.rsData[0];if(a)o.callback=a,a(r);else if(o.options.selector){var i=o.buildInfobox(r);t(o.options.selector).html(i),o.initEvent(i)}else console.error("selector or callback must be config");o.options.onLoad(r)}else n&&n()},error:function(){toastr.error("网络接口错误！"),n&&n()}})},e.prototype.buildInfobox=function(e){var a=this,n=t('<div class="hiekn-infobox"></div>');if(e.self){n.append('<div class="hiekn-infobox-head"></div><div class="hiekn-infobox-body"></div>');var o=a.buildEntity(e.self,!1);if(n.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-title">'+o+"</div>"),e.self.img){var r=e.self.img;0!=e.self.img.indexOf("http")&&(r=a.options.imagePrefix+e.self.img+"?_="+Math.round(new Date/36e5)),n.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-img"><img src="'+r+'" alt=""></div>')}if(e.self.extra){var i="",l=a.options.atts.visible||[],s=a.options.atts.hidden||[];for(var d in e.self.extra){var c=e.self.extra[d];l.length&&_.indexOf(l,c.k)>=0?i+=a.buildExtra(c):s.length&&_.indexOf(s,c.k)<0?i+=a.buildExtra(c):l.length||s.length||(i+=a.buildExtra(c))}if(e.atts)for(var u in e.atts)if(e.atts.hasOwnProperty(u)){var h=e.atts[u],m="";for(var g in h.v){var p=h.v[g],o=a.buildEntity(p,!0);m+="<li>"+o+"</li>"}l.length&&_.indexOf(l,h.k)>=0?i+='<tr><td class="hiekn-infobox-info-label">'+h.k+'</td><td class="hiekn-infobox-info-detail">'+m+"</td></tr>":s.length&&_.indexOf(s,h.k)<0?i+='<tr><td class="hiekn-infobox-info-label">'+h.k+'</td><td class="hiekn-infobox-info-detail">'+m+"</td></tr>":l.length||s.length||(i+='<tr><td class="hiekn-infobox-info-label">'+h.k+'</td><td class="hiekn-infobox-info-detail">'+m+"</td></tr>")}n.find(".hiekn-infobox-body").append("<table><tbody>"+i+"</tbody></table>")}if(e.pars){n.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">所属：</label><ul></ul></div>');for(var f in e.pars){var p=e.pars[f],o=a.buildEntity(p,!0);n.find(".hiekn-infobox-pars ul").append("<li>"+o+"</li>")}}if(e.sons){var i="";for(var v in e.sons){var p=e.sons[v],o=a.buildEntity(p,!0);i+="<li>"+o+"</li>"}n.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">相关：</label><ul>'+i+"</ul></div>")}}else n.append("InfoBox读取错误");return n},e.prototype.buildTabInfobox=function(e){var a=this,n=t('<div class="hiekn-infobox hiekn-infobox-tab"></div>');if(e.self){n.append('<div class="hiekn-infobox-head"></div><div class="hiekn-infobox-body"><ul class="nav nav-tabs" role="tablist"></ul><div class="tab-content"></div></div>');var o=a.buildEntity(e.self,!1);if(n.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-title">'+o+"</div>"),e.self.extra){var r="";for(var i in e.self.extra){var l=e.self.extra[i];r+=a.buildExtra(l)}var s="hiekn-infobox-"+(new Date).getTime()+"-"+e.self.id;n.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation" class="active"><a href="#'+s+'" role="tab" data-toggle="tab" aria-expanded="true">基本信息</a></li>'),n.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-detail tab-pane active" id="'+s+'"><table><tbody>'+r+"</tbody></table></div>")}if(e.pars){n.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">所属：</label><ul></ul></div>');for(var d in e.pars){var c=e.pars[d],o=a.buildEntity(c,!0);n.find(".hiekn-infobox-pars ul").append("<li>"+o+"</li>")}}if(e.sons){var r="";for(var u in e.sons){var c=e.sons[u],o=a.buildEntity(c,!0);r+="<li>"+o+"</li>"}var s="hiekn-infobox-"+(new Date).getTime()+"-sons-"+e.self.id;n.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation"><a href="#'+s+'" role="tab" data-toggle="tab" aria-expanded="true">子节点</a></li>'),n.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-sons tab-pane" id="'+s+'"><ul>'+r+"</ul></div>")}if(e.atts)for(var h in e.atts)if(e.atts.hasOwnProperty(h)){var m=e.atts[h],r="";for(var g in m.v){var c=m.v[g],o=a.buildEntity(c,!0);r+="<li>"+o+"</li>"}var s="hiekn-infobox-"+(new Date).getTime()+"-att-"+h+"-"+e.self.id;n.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation"><a href="#'+s+'" role="tab" data-toggle="tab" aria-expanded="true">'+m.k+"</a></li>"),n.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-sons tab-pane" id="'+s+'"><ul>'+r+"</ul></div>")}}else n.append("InfoBox读取错误");return n},e}e.HieknInfoboxService=a()}(window,jQuery),function(e,t){"use strict";function a(){var a=function(a){var n=this;n.isInit=!1,n.baseSettings={baseUrl:a.baseUrl,data:a.data,kgName:a.kgName},n.filterSettings={selectedAtts:a.selectedAtts,selectedTypes:a.selectedTypes},n.infoboxSettings={enable:"boolean"!=typeof a.infobox||a.infobox,dataFilter:a.dataFilter,selector:a.selector,imagePrefix:a.imagePrefix},t.extend(!0,n.infoboxSettings,n.baseSettings),n.loaderSettings={dataFilter:a.dataFilter,selector:a.selector,tgc2:null,tgc2Filter:null,tgc2Page:null,tgc2Stats:null},t.extend(!0,n.loaderSettings,n.baseSettings),n.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof a.enableAutoUpdateStyle||a.enableAutoUpdateStyle,imagePrefix:a.imagePrefix,images:a.images,nodeColors:a.nodeColors,textColors:a.textColors,minRadius:a.minRadius||10,legendClass:null,legendColor:null,tgc2:null},n.promptSettings=n.baseSettings,n.schemaSettings={preloadData:a.schema,dataFilter:a.dataFilter,that:t(a.selector)[0]},t.extend(!0,n.schemaSettings,n.baseSettings),n.initSettings={dataFilter:a.dataFilter,that:t(a.selector)[0],isTiming:!1,success:function(e){if(e.relationList&&e.relationList.length){var t=n.sdkUtils.orderRelation(e.relationList),a=t[2]?t[2].k:t[0].k,o=t[1].k;n.load({id:(new Date).getTime(),start:{id:a},end:{id:o}})}},failed:t.noop},t.extend(!0,n.initSettings,n.baseSettings),n.tgc2Settings={},n.legendFilter={},n.layoutStatus=a.layoutStatus,n.sdkUtils=new e.HieknSDKService,n.schemaSettings.preloadData?n.init(a,n.schemaSettings.preloadData):n.sdkUtils.schema(n.schemaSettings,function(e){n.init(a,e)})};return a.prototype.init=function(e,a){var n=this;if(e.autoColor){var o={};for(var r in a.types)o[a.types[r].k]=n.sdkUtils.color[r%n.sdkUtils.color.length];t.extend(!0,o,n.nodeSettings.nodeColors||{}),n.nodeSettings.nodeColors=o}var i=n.sdkUtils.buildFilter(a,n.filterSettings);i=[{key:"distance",label:"设定分析步长",selected:e.selectedDistance||3,options:[3,4,5,6]}].concat(i);var l={selector:e.selector,filter:{enable:!0,filters:i},stats:{enable:!0,editable:!0,atts:a.atts,types:a.types,statsConfig:e.statsConfig},connects:{enable:!0,mode:"click"},crumb:{enable:!0},find:{enable:!0},legend:{enable:!1,data:n.nodeSettings.nodeColors||[],legendDraw:n.sdkUtils.legendDraw(a,n,e.legendType),onClick:function(e){n.sdkUtils.legendClick(e,n)},onDblClick:function(e){n.sdkUtils.legendDblClick(e,n)},onMouseEnter:function(e){n.sdkUtils.legendMouseEnter(e,n)},onMouseLeave:function(e){n.sdkUtils.legendMouseLeave(e,n)}},netChart:{settings:{filters:{nodeFilter:function(e){return n.sdkUtils.nodeFilter(e,n)}},nodeMenu:{contentsFunction:n.sdkUtils.infobox()},style:{node:{display:e.display||"circle"},nodeStyleFunction:n.sdkUtils.nodeStyleFunction(n.nodeSettings)},info:{linkContentsFunction:n.sdkUtils.linkContentsFunction}}},loader:n.sdkUtils.path(n.loaderSettings,a),path:{prompt:{settings:{drawPromptItem:n.sdkUtils.drawPromptItem(a),onPrompt:n.sdkUtils.onPrompt(n.promptSettings)}}}};n.tgc2Settings=t.extend(!0,{},l,e.tgc2Settings),n.infoboxSettings.enable&&n.sdkUtils.gentInfobox(n.infoboxSettings),n.tgc2=new Tgc2Path(n.tgc2Settings),n.tgc2Filter=new Tgc2Filter(n.tgc2,n.tgc2Settings.filter),n.tgc2Stats=new Tgc2Stats(n.tgc2,n.tgc2Settings.stats),n.tgc2Connects=new Tgc2Connects(n.tgc2,n.tgc2Settings.connects),n.tgc2Crumb=new Tgc2Crumb(n.tgc2,n.tgc2Settings.crumb),n.tgc2Find=new Tgc2Find(n.tgc2,n.tgc2Settings.find),n.tgc2Legend=new Tgc2Legend(n.tgc2,n.tgc2Settings.legend),n.loaderSettings.tgc2=n.tgc2,n.loaderSettings.tgc2Filter=n.tgc2Filter,n.loaderSettings.tgc2Page=n.tgc2Page,n.loaderSettings.tgc2Stats=n.tgc2Stats,n.nodeSettings.tgc2=n.tgc2,n.tgc2.init(),n.isInit=!0,e.startInfo&&n.load(e.startInfo)},a.prototype.load=function(e){var t=this;setTimeout(function(){t.isInit?e?t.tgc2.load(e):t.sdkUtils.graphInit(t.initSettings):t.load(e)},30)},a}e.HieknPathService=a()}(window,jQuery),function(e,t){"use strict";function a(){var e=function(e){var a=this,n={beforeDrawPrompt:null,container:null,data:null,baseUrl:null,kgName:null,ready:t.noop,group:!1,replaceSearch:!1,onSearch:t.noop};a.options=t.extend(!0,{},n,e),a.init()};return e.prototype.init=function(){var e=this,a=new HieknSDKService(e.options);a.schema(e.options,function(n){var o={drawPromptItem:a.drawPromptItem(n),onPrompt:a.onPrompt(e.options)};e.options.group&&(o.drawPromptItems=a.drawPromptItems(n,e)),e.options.replaceSearch&&(o.beforeSearch=a.beforeSearch()),t.extend(!0,o,e.options),e.instance=new hieknPrompt(o),e.options.ready(e.instance)})},e}e.HieknPromptService=a()}(window,jQuery),function(e,t){"use strict";function a(){var a=function(a){var n=this;n.isInit=!1,n.baseSettings={baseUrl:a.baseUrl,data:a.data,kgName:a.kgName},n.filterSettings={selectedAtts:a.selectedAtts,selectedTypes:a.selectedTypes},n.infoboxSettings={enable:"boolean"!=typeof a.infobox||a.infobox,dataFilter:a.dataFilter,selector:a.selector,imagePrefix:a.imagePrefix},t.extend(!0,n.infoboxSettings,n.baseSettings),n.loaderSettings={dataFilter:a.dataFilter,selector:a.selector,tgc2:null,tgc2Filter:null,tgc2Page:null,tgc2Stats:null},t.extend(!0,n.loaderSettings,n.baseSettings),n.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof a.enableAutoUpdateStyle||a.enableAutoUpdateStyle,imagePrefix:a.imagePrefix,images:a.images,nodeColors:a.nodeColors,textColors:a.textColors,minRadius:a.minRadius||10,legendClass:null,legendColor:null,tgc2:null},n.promptSettings=n.baseSettings,n.schemaSettings={preloadData:a.schema,dataFilter:a.dataFilter,that:t(a.selector)[0]},t.extend(!0,n.schemaSettings,n.baseSettings),n.initSettings={dataFilter:a.dataFilter,that:t(a.selector)[0],isTiming:!1,success:function(e){if(e.relationList&&e.relationList.length){var t=n.sdkUtils.orderRelation(e.relationList),a=[];for(var o in t)o<3&&a.push({id:t[o].k});n.load({id:(new Date).getTime(),nodes:a})}},failed:t.noop},t.extend(!0,n.initSettings,n.baseSettings),n.tgc2Settings={},n.legendFilter={},n.layoutStatus=a.layoutStatus,n.sdkUtils=new e.HieknSDKService,n.schemaSettings.preloadData?n.init(a,n.schemaSettings.preloadData):n.sdkUtils.schema(n.schemaSettings,function(e){n.init(a,e)})};return a.prototype.init=function(e,a){var n=this;if(e.autoColor){var o={};for(var r in a.types)o[a.types[r].k]=n.sdkUtils.color[r%n.sdkUtils.color.length];t.extend(!0,o,n.nodeSettings.nodeColors||{}),n.nodeSettings.nodeColors=o}var i=n.sdkUtils.buildFilter(a,n.filterSettings);i=[{key:"distance",label:"设定分析步长",selected:e.selectedDistance||3,options:[3,4,5,6]}].concat(i);var l={selector:e.selector,filter:{enable:!0,filters:i},stats:{enable:!0,editable:!0,atts:a.atts,types:a.types,statsConfig:e.statsConfig},connects:{enable:!0,mode:"click"},crumb:{enable:!0},find:{enable:!0},legend:{enable:!1,data:n.nodeSettings.nodeColors||[],legendDraw:n.sdkUtils.legendDraw(a,n,e.legendType),onClick:function(e){n.sdkUtils.legendClick(e,n)},onDblClick:function(e){n.sdkUtils.legendDblClick(e,n)},onMouseEnter:function(e){n.sdkUtils.legendMouseEnter(e,n)},onMouseLeave:function(e){n.sdkUtils.legendMouseLeave(e,n)}},netChart:{settings:{filters:{nodeFilter:function(e){return n.sdkUtils.nodeFilter(e,n)}},nodeMenu:{contentsFunction:n.sdkUtils.infobox()},style:{node:{display:e.display||"circle"},nodeStyleFunction:n.sdkUtils.nodeStyleFunction(n.nodeSettings)},info:{linkContentsFunction:n.sdkUtils.linkContentsFunction}}},loader:n.sdkUtils.relation(n.loaderSettings,a),relation:{prompt:{settings:{drawPromptItem:n.sdkUtils.drawPromptItem(a),onPrompt:n.sdkUtils.onPrompt(n.promptSettings)}}}};n.tgc2Settings=t.extend(!0,{},l,e.tgc2Settings),n.infoboxSettings.enable&&n.sdkUtils.gentInfobox(n.infoboxSettings),n.tgc2=new Tgc2Relation(n.tgc2Settings),n.tgc2Filter=new Tgc2Filter(n.tgc2,n.tgc2Settings.filter),n.tgc2Stats=new Tgc2Stats(n.tgc2,n.tgc2Settings.stats),n.tgc2Connects=new Tgc2Connects(n.tgc2,n.tgc2Settings.connects),n.tgc2Crumb=new Tgc2Crumb(n.tgc2,n.tgc2Settings.crumb),n.tgc2Find=new Tgc2Find(n.tgc2,n.tgc2Settings.find),n.tgc2Legend=new Tgc2Legend(n.tgc2,n.tgc2Settings.legend),n.loaderSettings.tgc2=n.tgc2,n.loaderSettings.tgc2Filter=n.tgc2Filter,n.loaderSettings.tgc2Page=n.tgc2Page,n.loaderSettings.tgc2Stats=n.tgc2Stats,n.nodeSettings.tgc2=n.tgc2,n.tgc2.init(),n.isInit=!0,e.startInfo&&n.load(e.startInfo)},a.prototype.load=function(e){var t=this;setTimeout(function(){t.isInit?e?t.tgc2.load(e):t.sdkUtils.graphInit(t.initSettings):t.load(e)},30)},a}e.HieknRelationService=a()}(window,jQuery),function(e,t){"use strict";function a(){var e=function(e){var a=this,n={baseUrl:null,beforeLoad:t.noop,container:null,config:{},data:null,onLoad:t.noop};a.options=t.extend(!0,{},n,e),a.init()};return e.prototype.getQuery=function(){var e=this,t=[],a=e.tableService.getFilterOptions();for(var n in a){var o=[],r=a[n],i=_.find(e.options.config.filter,["key",n]);if("year"==i.type||"month"==i.type)for(var l in r){var s=r[l],d="",c="";"year"==i.type?(d=moment(s+"-01-01").format(i.format||"YYYY-MM-DD"),c=moment(parseInt(s,10)+1+"-01-01").format(i.format||"YYYY-MM-DD")):(d=moment(s+"-01").format(i.format||"YYYY-MM"),c=moment(parseInt(s,10)+1+"-01").format(i.format||"YYYY-MM"));var u={};u[n]={from:d,to:c,include_lower:!0,include_upper:!1};var h={range:u};o.push(h)}else{var u={};u[n]=r;var m={terms:u};o.push(m)}t.push({bool:{should:o,minimum_should_match:1}})}var g=e.tableService.getFilterKw();if(g){var o=[],p=e.options.config.fieldsKw||e.options.config.fieldsTable||e.options.config.fields,u={};u.query=g,u.fields=p;var m={query_string:u};o.push(m),t.push({bool:{should:o,minimum_should_match:1}})}return{bool:{must:t}}},e.prototype.init=function(){var e=this,t={config:e.options.config,container:e.options.container,load:function(t,a){e.load(t,a)}};e.tableService=new HieknTableService(t)},e.prototype.loadData=function(e){var t=this;t.tableService.loadData(e)},e.prototype.load=function(e,a){var n=this;n.query=n.getQuery(),n.options.beforeLoad(n);var o=n.options.config,r=n.options.data||{},i=n.options.data2||{};i.databases=o.databases,i.tables=o.tables,i.fields=o.fields,i.query=JSON.stringify(n.query),i.pageNo=e,i.pageSize=i.pageSize||15;var l=a.getTableContainer();l.empty(),hieknjs.kgLoader({url:n.options.baseUrl+"search?"+t.param(r),type:1,params:i,dataFilter:n.options.dataFilter||function(e){return e},success:function(e,t,o,r){e?(a.drawPage(e.rsCount,r.pageNo,r.pageSize),a.drawData(e.rsData)):a.drawPage(0,r.pageNo,r.pageSize),n.options.onLoad(e,n)},that:l[0]})},e}e.HieknResourceService=a()}(window,jQuery),function(e,t){"use strict";function a(){var a=function(e){var a=this,n={baseUrl:null,beforeLoad:t.noop,container:null,configs:[],data:null,namespace:"hiekn-resource",onLoad:t.noop};a.options=t.extend(!0,{},n,e),a.resourcesService=[],a.init()};return a.prototype.init=function(){var e=this;e.$container=t(e.options.container),e.$headContainer=t('<div class="hiekn-resource-nav-container"><ul class="hiekn-resource-nav nav nav-tabs" role="tablist"></ul><div class="hiekn-resource-nav-more hide">更多</div><div class="hiekn-resource-nav-more-container hide"><ul class="hiekn-resource-nav-hide-tabs"></ul></div></div>'),e.$bodyContainer=t('<div class="hiekn-resource-container tab-content"></div>'),e.$container.append(e.$headContainer),e.$container.append(e.$bodyContainer);var a=e.select(".hiekn-resource-nav-container ul.hiekn-resource-nav"),n=e.select(".hiekn-resource-nav-container ul.hiekn-resource-nav-hide-tabs"),o=0;for(var r in e.options.configs){var i=0==r?"active":"",l=e.options.namespace+"-tab-"+r+"-"+(new Date).getTime(),s=t('<div role="tabpanel" class="tab-pane '+i+'" id="'+l+'"></div>');e.$bodyContainer.append(s);var d=t.extend(!0,{},e.options);d.config=e.options.configs[r],d.container=s,d.onLoad=function(t,a){var n=a.tableService.$container.attr("id");e.$headContainer.find('a[href="#'+n+'"] .res-count').text(t.rsCount||0),e.options.onLoad(t,a)},delete d.configs,e.resourcesService.push(new HieknResourceService(d));var c='<li role="presentation" class="'+i+'"><a href="#'+l+'" aria-controls="" role="tab" data-toggle="tab"><span class="res-name" title="'+d.config.name+'">'+d.config.name+'</span><span class="res-count"></span></a></li>';a.append(c),n.append(c),o+=a.find("li:last-child").width()}a.css("width",o),e.updateTabVisibility(),e.bindEvent()},a.prototype.bindEvent=function(){var a=this;a.$headContainer.find(".hiekn-resource-nav-more").on("click",function(){a.$headContainer.find(".hiekn-resource-nav-more-container").toggleClass("hide")}),a.$headContainer.on("shown.bs.tab",'a[data-toggle="tab"]',function(){var e=t(this).attr("href");a.$headContainer.find('.hiekn-resource-nav a[href="'+e+'"]').parent().addClass("active").siblings().removeClass("active"),
a.$headContainer.find('.hiekn-resource-nav-hide-tabs a[href="'+e+'"]').parent().addClass("active").siblings().removeClass("active")}),t("body").on("click",function(e){t(e.target).closest(".hiekn-resource-nav-more-container,.hiekn-resource-nav-more").length||a.$headContainer.find(".hiekn-resource-nav-more-container").addClass("hide")}),t(e).on("resize",function(){a.updateTabVisibility()})},a.prototype.loadData=function(e){var t=this;for(var a in t.resourcesService)t.resourcesService[a].loadData(e)},a.prototype.select=function(e){var t=this;return t.$container.find(e)},a.prototype.updateTabVisibility=function(){var e=this,a=e.$headContainer,n=a.width(),o=a.find(".nav"),r=o.width(),i=a.find(".hiekn-resource-nav-more");n<r?i.removeClass("hide"):(i.addClass("hide"),a.find(".hiekn-resource-nav-more-container").addClass("hide"));var l=0,s=i.outerWidth(),d=a.find(".hiekn-resource-nav-hide-tabs>li");o.find("li").each(function(e,a){t(a).removeClass("hide"),l+=t(a).width(),l>=n-s?(t(a).addClass("hide"),t(d.get(e)).removeClass("hide")):t(d.get(e)).addClass("hide")})},a}e.HieknResourcesService=a()}(window,jQuery),function(e,t){"use strict";function a(){var a=function(e){var a=this,n={container:null,beforeLoad:null,data:null,config:{},baseUrl:null,kgName:null,chartColor:["#66d1b9","#f0cb69","#88bbf5","#e99592"]};a.options=t.extend(!0,{},n,e),a.init()};return a.prototype.init=function(){var e=this;e.$container=t(e.options.container),e.bindEvent()},a.prototype.bindEvent=function(){var a=this;t(e).on("resize",function(){a.chart&&a.chart.resize()})},a.prototype.drawChart=function(){var e=this;switch(e.options.config.type){case"bar":e.drawLineBarChart("bar");break;case"line":e.drawLineBarChart("line");break;case"pie":e.drawPieChart();break;case"wordCloud":e.drawWordCloudChart();break;case"radar":e.drawRadarChart();break;case"scatter":e.drawScatterChart();break;case"map":e.drawMapChart();break;case"gauge":e.drawGaugeChart();break;case"heatmap":e.drawHeatmapChart();break;case"solid":e.drawSolidChart()}},a.prototype.drawPieChart=function(){var e=this,a=e.stat,n=e.options.config,o=[];for(var r in a.series){var i=a.series[r];n.seriesName&&(i.name=n.seriesName[i.name]||i.name,o.push(i.name))}var l={name:"",type:"pie",radius:"75%",center:["50%","50%"],data:a.series,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},s={};s=n.chartSettings&&n.chartSettings.series?t.extend(!0,{},l,n.chartSettings.series):l,e.chart=echarts.init(e.$container[0]);var d={color:e.options.chartColor,tooltip:{trigger:"item",formatter:"{b} <br/>{c} ({d}%)"},legend:{orient:"vertical",x:"left",data:o}},c={};c=n.chartSettings?t.extend(!0,{},d,n.chartSettings):d,c.series=[s],e.chart.setOption(c)},a.prototype.drawWordCloudChart=function(){var e=this,a=e.stat,n=e.options.config,o=[];for(var r in a.series)a.series[r].name&&o.push(a.series[r]);var i={type:"wordCloud",sizeRange:[12,50],rotationRange:[-45,90],textPadding:0,autoSize:{enable:!0,minSize:6},textStyle:{normal:{color:function(){return e.options.chartColor[Math.floor(Math.random()*e.options.chartColor.length)]}},emphasis:{shadowBlur:10,shadowColor:"#333"}},data:o},l={};l=n.chartSettings&&n.chartSettings.series?t.extend(!0,{},i,n.chartSettings.series):i,e.chart=echarts.init(e.$container[0]);var s={},d={};d=n.chartSettings?t.extend(!0,{},s,n.chartSettings):s,d.series=[l],e.chart.setOption(d)},a.prototype.drawLineBarChart=function(e){var a=this,n={type:"category",axisLine:{show:!1},axisTick:{show:!1,alignWithLabel:!0},splitLine:{show:!0}},o={name:"",type:e,symbol:"circle",symbolSize:10},r=a.stat,i=a.options.config,l=0,s=[];for(var d in r.xAxis){var c=r.xAxis[d];i.chartSettings&&i.chartSettings.xAxis&&(i.chartSettings.xAxis instanceof Array?t.extend(!0,n,i.chartSettings.xAxis[l]):t.extend(!0,n,i.chartSettings.xAxis)),s.push(t.extend(!0,{},n,c))}l=0;var u=[];for(var h in r.series){var m=r.series[h];i.chartSettings&&i.chartSettings.series&&(i.chartSettings.series instanceof Array?t.extend(!0,o,i.chartSettings.series[l]):t.extend(!0,o,i.chartSettings.series));var g=t.extend(!0,{},o,m);i.seriesName&&(g.name=i.seriesName[g.name]||g.name),u.push(g),l++}a.chart=echarts.init(a.$container[0]);var p={color:a.options.chartColor,tooltip:{formatter:function(e){var t="";for(var a in e){var n=e[a];t+=n.seriesName+":"+n.data+"<br>"}return t},position:"top",trigger:"axis",axisPointer:{type:"line"}},grid:{left:9,right:9,bottom:24,top:24,containLabel:!0},yAxis:[{type:"value",axisLine:{show:!1},axisTick:{show:!1}}]},f={};f=i.chartSettings?t.extend(!0,{},p,i.chartSettings):p,i.changeXY?(f.xAxis=f.yAxis,f.yAxis=s):f.xAxis=s,f.series=u,a.chart.setOption(f)},a.prototype.drawRadarChart=function(){var e=this,a=e.stat,n=a,o=e.options.config,r={name:"",type:"radar",data:n,symbol:"none",itemStyle:{normal:{color:e.options.chartColor[0]}},areaStyle:{normal:{opacity:.1}}},i={};i=o.chartSettings&&o.chartSettings.series?t.extend(!0,{},r,o.chartSettings.series):r,e.chart=echarts.init(e.$container[0]);var l={backgroundColor:"#fff",title:{text:o.chartSettings.title.text,left:"center",textStyle:{color:"#eee"}},legend:{bottom:5,data:o.chartSettings.title.text,itemGap:20,textStyle:{color:"#fff",fontSize:14},selectedMode:"single"},radar:{indicator:[{name:"AQI",max:300},{name:"PM2.5",max:250},{name:"PM10",max:300},{name:"CO",max:5},{name:"NO2",max:200},{name:"SO2",max:100}],shape:"circle",splitNumber:5,name:{textStyle:{color:"rgb(0, 179, 138)"}},splitArea:{show:!1},axisLine:{lineStyle:{color:"rgba(0, 179, 138, 0.5)"}}}},s={};s=o.chartSettings?t.extend(!0,{},l,o.chartSettings):l,s.series=[i],e.chart.setOption(s)},a.prototype.drawScatterChart=function(){var e=this,a=e.stat,n=a,o=e.options.config,r={name:"散点图",data:n,type:"scatter",symbolSize:function(e){return Math.sqrt(e[2])/500},label:{emphasis:{show:!0,formatter:function(e){return e.data[3]},position:"top"}},itemStyle:{normal:{shadowBlur:10,shadowColor:"rgba(120, 36, 50, 0.5)",shadowOffsetY:5,color:e.options.chartColor[0]}}},i={};i=o.chartSettings&&o.chartSettings.series?t.extend(!0,{},r,o.chartSettings.series):r,e.chart=echarts.init(e.$container[0]);var l={backgroundColor:"#fff",title:{text:"散点图"},legend:{right:10,data:["1990"]},xAxis:{splitLine:{lineStyle:{type:"dashed"}}},yAxis:{splitLine:{lineStyle:{type:"dashed"}},scale:!0}},s={};s=o.chartSettings?t.extend(!0,{},l,o.chartSettings):l,s.series=[i],e.chart.setOption(s)},a.prototype.drawMapChart=function(){function e(e,t){s.title.subtext=e,s.series=[{name:e,type:"map",mapType:e,roam:!0,nameMap:{china:"中国"},label:{normal:{show:!0,textStyle:{color:"#999",fontSize:13}},emphasis:{show:!0,textStyle:{color:"#fff",fontSize:13}}},itemStyle:{normal:{areaColor:"#eee",borderColor:"dodgerblue"},emphasis:{areaColor:"darkorange"}},data:a.stat}],a.chart.setOption(s)}var a=this,n=a.options.config;a.chart=echarts.init(a.$container[0]);var o=(a.stat,{"台湾":"taiwan","河北":"hebei","山西":"shanxi","辽宁":"liaoning","吉林":"jilin","黑龙江":"heilongjiang","江苏":"jiangsu","浙江":"zhejiang","安徽":"anhui","福建":"fujian","江西":"jiangxi","山东":"shandong","河南":"henan","湖北":"hubei","湖南":"hunan","广东":"guangdong","海南":"hainan","四川":"sichuan","贵州":"guizhou","云南":"yunnan","陕西":"shanxi1","甘肃":"gansu","青海":"qinghai","新疆":"xinjiang","广西":"guangxi","内蒙古":"neimenggu","宁夏":"ningxia","西藏":"xizang","北京":"beijing","天津":"tianjin","上海":"shanghai","重庆":"chongqing","香港":"xianggang","澳门":"aomen"}),r=["北京","天津","上海","重庆","香港","澳门"],i=[];t.getJSON("../json/china.json",function(t){for(var a=[],n=0;n<t.features.length;n++)a.push({name:t.features[n].properties.name});i=a,echarts.registerMap("china",t),e("china",a)});var l={openClick:!1,backgroundColor:"#fff",title:{text:"地图",left:"center",textStyle:{color:"#fff",fontSize:16,fontWeight:"normal",fontFamily:"Microsoft YaHei"},subtextStyle:{color:"#ccc",fontSize:13,fontWeight:"normal",fontFamily:"Microsoft YaHei"}},graphic:{id:"goback",type:"circle",shape:{r:20},style:{text:"返回",fill:"#eee"},left:10,top:10,onclick:function(){e("china",i)}},tooltip:{trigger:"item"},visualMap:{min:0,max:2500,left:"left",top:"bottom",text:["高","低"],inRange:{color:[a.options.chartColor[2],a.options.chartColor[3]]},calculable:!0},toolbox:{show:!0,orient:"vertical",left:"right",top:"center",feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}},iconStyle:{normal:{color:"#fff"}}},animationDuration:1e3,animationEasing:"cubicOut",animationDurationUpdate:1e3},s={};s=n.chartSettings?t.extend(!0,{},l,n.chartSettings):l,console.log(s.openClick),s.openClick&&a.chart.on("click",function(a){console.log(a.name),a.name in o?t.getJSON("../json/province/"+o[a.name]+".json",function(t){echarts.registerMap(a.name,t);for(var n=[],o=0;o<t.features.length;o++)n.push({name:t.features[o].properties.name});e(a.name,n)}):a.seriesName in o?r.indexOf(a.seriesName)>=0?e("china",i):t.getJSON("../json/city/"+cityMap[a.name]+".json",function(t){echarts.registerMap(a.name,t);for(var n=[],o=0;o<t.features.length;o++)n.push({name:t.features[o].properties.name});e(a.name,n)}):e("china",i)})},a.prototype.drawGaugeChart=function(){var e=this,a=(e.stat,e.options.config),n={name:"业务指标",type:"gauge",axisLine:{show:!0,lineStyle:{width:30,shadowBlur:0,color:[[.25,e.options.chartColor[2]],[.5,e.options.chartColor[0]],[.75,e.options.chartColor[1]],[1,e.options.chartColor[3]]]}},detail:{formatter:"{value}%"},data:[{value:50,name:"完成率"}]},o={};o=a.chartSettings&&a.chartSettings.series?t.extend(!0,{},n,a.chartSettings.series):n,e.chart=echarts.init(e.$container[0]);var r={tooltip:{formatter:"{a} <br/>{b} : {c}%"},toolbox:{feature:{restore:{},saveAsImage:{}}}},i={};i=a.chartSettings?t.extend(!0,{},r,a.chartSettings):r,i.series=[o],e.chart.setOption(i),setInterval(function(){i.series[0].data[0].value=(100*Math.random()).toFixed(2)-0,e.chart.setOption(i,!0)},2e3)},a.prototype.drawHeatmapChart=function(){var e="horizontal",a=this,n=a.stat,o=n,r=a.options.config,i={type:"heatmap",coordinateSystem:"calendar",data:o},l={};l=r.chartSettings&&r.chartSettings.series?t.extend(!0,{},i,r.chartSettings.series):i,a.chart=echarts.init(a.$container[0]);var s={title:{top:30,left:"center",text:"热力图"},graphic:{id:"left-btn",type:"circle",shape:{r:20},style:{text:"+",fill:"#eee"},left:10,top:10,onclick:function(){"horizontal"==e?(a.chart.setOption(d={title:{left:111},visualMap:{orient:"vertical",left:65},calendar:{top:40,left:"center",bottom:10,orient:"vertical",cellSize:[13,"auto"],yearLabel:{show:!1}}}),e="vertical"):(a.chart.setOption(d={title:{left:"center"},visualMap:{orient:"horizontal",left:"center",top:65},calendar:{top:120,left:30,right:30,orient:"horizontal",cellSize:["auto",13],yearLabel:{show:!1}}}),e="horizontal")}},tooltip:{},visualMap:{min:0,max:1e4,type:"piecewise",orient:"horizontal",left:"center",top:65,textStyle:{color:"#000"}},calendar:{top:120,left:30,right:30,cellSize:["auto",13],range:"2016",itemStyle:{normal:{borderWidth:.5}},yearLabel:{show:!1}}},d={};d=r.chartSettings?t.extend(!0,{},s,r.chartSettings):s,d.series=[l],a.chart.setOption(d)},a.prototype.drawSolidChart=function(){var e=this,a=e.stat,n=a,o=e.options.config,r={name:"solid",type:"graph",layout:"force",force:{repulsion:[100,500],edgeLength:[50,200],gravity:.1},tooltip:{formatter:function(e){var t="",a="";if(e.data.subtext1&&(a=e.data.subtext1+"<br />"),e.data.subtext2&&(t=e.data.subtext2),a||t)return a+t}},data:n.nodes,links:n.links,lineStyle:{normal:{color:"source",curveness:0,type:"solid"}},label:{normal:{show:!0,position:"top",formatter:function(e){return e.data.subtext2}}}},i={};i=o.chartSettings&&o.chartSettings.series?t.extend(!0,{},r,o.chartSettings.series):r,e.chart=echarts.init(e.$container[0]);var l={backgroundColor:new echarts.graphic.RadialGradient(.3,.3,.8,[{offset:0,color:"#fff"},{offset:1,color:"#fff"}]),title:{text:"solid",top:"top",left:"center"},tooltip:{trigger:"item"},legend:[{formatter:function(e){return echarts.format.truncateText(e,40,"14px Microsoft Yahei","…")},tooltip:{show:!0},selectedMode:"false",bottom:20}],toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!0},restore:{show:!0},saveAsImage:{show:!0}}},animationDuration:1e3,animationEasingUpdate:"quinticInOut"},s={};s=o.chartSettings?t.extend(!0,{},l,o.chartSettings):l,s.series=[i],console.log(JSON.stringify(s)),e.chart.setOption(s)},a.prototype.load=function(){var e=this,a=e.options.data||{},o=e.options.data2||{};o=t.extend(!0,o,e.options.config.querySettings),e.options.beforeLoad&&(o=e.options.beforeLoad(o));var r=e.$container;r.empty(),hieknjs.kgLoader({url:e.options.baseUrl+"stat/data?"+t.param(a),type:1,params:o,success:function(t,a,o,r){t&&(e.stat=n,e.drawChart())},that:r[0]})},a}e.HieknStatService=a();var n=([{name:"北京",value:Math.round(2e3*Math.random())},{name:"天津",value:Math.round(2e3*Math.random())},{name:"上海",value:Math.round(2e3*Math.random())},{name:"重庆",value:Math.round(2e3*Math.random())},{name:"河北",value:Math.round(2e3*Math.random())},{name:"河南",value:Math.round(2e3*Math.random())},{name:"云南",value:Math.round(2e3*Math.random())},{name:"辽宁",value:Math.round(2e3*Math.random())},{name:"黑龙江",value:Math.round(2e3*Math.random())},{name:"湖南",value:Math.round(2e3*Math.random())},{name:"安徽",value:Math.round(2e3*Math.random())},{name:"山东",value:Math.round(2e3*Math.random())},{name:"新疆",value:Math.round(2e3*Math.random())},{name:"江苏",value:Math.round(2e3*Math.random())},{name:"浙江",value:Math.round(2e3*Math.random())},{name:"江西",value:Math.round(2e3*Math.random())},{name:"湖北",value:Math.round(2e3*Math.random())},{name:"广西",value:Math.round(2e3*Math.random())},{name:"甘肃",value:Math.round(2e3*Math.random())},{name:"山西",value:Math.round(2e3*Math.random())},{name:"内蒙古",value:Math.round(2e3*Math.random())},{name:"陕西",value:Math.round(2e3*Math.random())},{name:"吉林",value:Math.round(2e3*Math.random())},{name:"福建",value:Math.round(2e3*Math.random())},{name:"贵州",value:Math.round(2e3*Math.random())},{name:"广东",value:Math.round(2e3*Math.random())},{name:"青海",value:Math.round(2e3*Math.random())},{name:"西藏",value:Math.round(2e3*Math.random())},{name:"四川",value:Math.round(2e3*Math.random())},{name:"宁夏",value:Math.round(2e3*Math.random())},{name:"海南",value:Math.round(2e3*Math.random())},{name:"台湾",value:Math.round(2e3*Math.random())},{name:"香港",value:Math.round(2e3*Math.random())},{name:"澳门",value:Math.round(2e3*Math.random())},{name:"重庆市",value:Math.round(1e3*Math.random())},{name:"北京市",value:Math.round(1e3*Math.random())},{name:"天津市",value:Math.round(1e3*Math.random())},{name:"上海市",value:Math.round(1e3*Math.random())},{name:"香港",value:Math.round(1e3*Math.random())},{name:"澳门",value:Math.round(1e3*Math.random())},{name:"巴音郭楞蒙古自治州",value:Math.round(1e3*Math.random())},{name:"和田地区",value:Math.round(1e3*Math.random())},{name:"哈密地区",value:Math.round(1e3*Math.random())},{name:"阿克苏地区",value:Math.round(1e3*Math.random())},{name:"阿勒泰地区",value:Math.round(1e3*Math.random())},{name:"喀什地区",value:Math.round(1e3*Math.random())},{name:"塔城地区",value:Math.round(1e3*Math.random())},{name:"昌吉回族自治州",value:Math.round(1e3*Math.random())},{name:"克孜勒苏柯尔克孜自治州",value:Math.round(1e3*Math.random())},{name:"吐鲁番地区",value:Math.round(1e3*Math.random())},{name:"伊犁哈萨克自治州",value:Math.round(1e3*Math.random())},{name:"博尔塔拉蒙古自治州",value:Math.round(1e3*Math.random())},{name:"乌鲁木齐市",value:Math.round(1e3*Math.random())},{name:"克拉玛依市",value:Math.round(1e3*Math.random())},{name:"阿拉尔市",value:Math.round(1e3*Math.random())},{name:"图木舒克市",value:Math.round(1e3*Math.random())},{name:"五家渠市",value:Math.round(1e3*Math.random())},{name:"石河子市",value:Math.round(1e3*Math.random())},{name:"那曲地区",value:Math.round(1e3*Math.random())},{name:"阿里地区",value:Math.round(1e3*Math.random())},{name:"日喀则地区",value:Math.round(1e3*Math.random())},{name:"林芝地区",value:Math.round(1e3*Math.random())},{name:"昌都地区",value:Math.round(1e3*Math.random())},{name:"山南地区",value:Math.round(1e3*Math.random())},{name:"拉萨市",value:Math.round(1e3*Math.random())},{name:"呼伦贝尔市",value:Math.round(1e3*Math.random())},{name:"阿拉善盟",value:Math.round(1e3*Math.random())},{name:"锡林郭勒盟",value:Math.round(1e3*Math.random())},{name:"鄂尔多斯市",value:Math.round(1e3*Math.random())},{name:"赤峰市",value:Math.round(1e3*Math.random())},{name:"巴彦淖尔市",value:Math.round(1e3*Math.random())},{name:"通辽市",value:Math.round(1e3*Math.random())},{name:"乌兰察布市",value:Math.round(1e3*Math.random())},{name:"兴安盟",value:Math.round(1e3*Math.random())},{name:"包头市",value:Math.round(1e3*Math.random())},{name:"呼和浩特市",value:Math.round(1e3*Math.random())},{name:"乌海市",value:Math.round(1e3*Math.random())},{name:"海西蒙古族藏族自治州",value:Math.round(1e3*Math.random())},{name:"玉树藏族自治州",value:Math.round(1e3*Math.random())},{name:"果洛藏族自治州",value:Math.round(1e3*Math.random())},{name:"海南藏族自治州",value:Math.round(1e3*Math.random())},{name:"海北藏族自治州",value:Math.round(1e3*Math.random())},{name:"黄南藏族自治州",value:Math.round(1e3*Math.random())},{name:"海东地区",value:Math.round(1e3*Math.random())},{name:"西宁市",value:Math.round(1e3*Math.random())},{name:"甘孜藏族自治州",value:Math.round(1e3*Math.random())},{name:"阿坝藏族羌族自治州",value:Math.round(1e3*Math.random())},{name:"凉山彝族自治州",value:Math.round(1e3*Math.random())},{name:"绵阳市",value:Math.round(1e3*Math.random())},{name:"达州市",value:Math.round(1e3*Math.random())},{name:"广元市",value:Math.round(1e3*Math.random())},{name:"雅安市",value:Math.round(1e3*Math.random())},{name:"宜宾市",value:Math.round(1e3*Math.random())},{name:"乐山市",value:Math.round(1e3*Math.random())},{name:"南充市",value:Math.round(1e3*Math.random())},{name:"巴中市",value:Math.round(1e3*Math.random())},{name:"泸州市",value:Math.round(1e3*Math.random())},{name:"成都市",value:Math.round(1e3*Math.random())},{name:"资阳市",value:Math.round(1e3*Math.random())},{name:"攀枝花市",value:Math.round(1e3*Math.random())},{name:"眉山市",value:Math.round(1e3*Math.random())},{name:"广安市",value:Math.round(1e3*Math.random())},{name:"德阳市",value:Math.round(1e3*Math.random())},{name:"内江市",value:Math.round(1e3*Math.random())},{name:"遂宁市",value:Math.round(1e3*Math.random())},{name:"自贡市",value:Math.round(1e3*Math.random())},{name:"黑河市",value:Math.round(1e3*Math.random())},{name:"大兴安岭地区",value:Math.round(1e3*Math.random())},{name:"哈尔滨市",value:Math.round(1e3*Math.random())},{name:"齐齐哈尔市",value:Math.round(1e3*Math.random())},{name:"牡丹江市",value:Math.round(1e3*Math.random())},{name:"绥化市",value:Math.round(1e3*Math.random())},{name:"伊春市",value:Math.round(1e3*Math.random())},{name:"佳木斯市",value:Math.round(1e3*Math.random())},{name:"鸡西市",value:Math.round(1e3*Math.random())},{name:"双鸭山市",value:Math.round(1e3*Math.random())},{name:"大庆市",value:Math.round(1e3*Math.random())},{name:"鹤岗市",value:Math.round(1e3*Math.random())},{name:"七台河市",value:Math.round(1e3*Math.random())},{name:"酒泉市",value:Math.round(1e3*Math.random())},{name:"张掖市",value:Math.round(1e3*Math.random())},{name:"甘南藏族自治州",value:Math.round(1e3*Math.random())},{name:"武威市",value:Math.round(1e3*Math.random())},{name:"陇南市",value:Math.round(1e3*Math.random())},{name:"庆阳市",value:Math.round(1e3*Math.random())},{name:"白银市",value:Math.round(1e3*Math.random())},{name:"定西市",value:Math.round(1e3*Math.random())},{name:"天水市",value:Math.round(1e3*Math.random())},{name:"兰州市",value:Math.round(1e3*Math.random())},{name:"平凉市",value:Math.round(1e3*Math.random())},{name:"临夏回族自治州",value:Math.round(1e3*Math.random())},{name:"金昌市",value:Math.round(1e3*Math.random())},{name:"嘉峪关市",value:Math.round(1e3*Math.random())},{name:"普洱市",value:Math.round(1e3*Math.random())},{name:"红河哈尼族彝族自治州",value:Math.round(1e3*Math.random())},{name:"文山壮族苗族自治州",value:Math.round(1e3*Math.random())},{name:"曲靖市",value:Math.round(1e3*Math.random())},{name:"楚雄彝族自治州",value:Math.round(1e3*Math.random())},{name:"大理白族自治州",value:Math.round(1e3*Math.random())},{name:"临沧市",value:Math.round(1e3*Math.random())},{name:"迪庆藏族自治州",value:Math.round(1e3*Math.random())},{name:"昭通市",value:Math.round(1e3*Math.random())},{name:"昆明市",value:Math.round(1e3*Math.random())},{name:"丽江市",value:Math.round(1e3*Math.random())},{name:"西双版纳傣族自治州",value:Math.round(1e3*Math.random())},{name:"保山市",value:Math.round(1e3*Math.random())},{name:"玉溪市",value:Math.round(1e3*Math.random())},{name:"怒江傈僳族自治州",value:Math.round(1e3*Math.random())},{name:"德宏傣族景颇族自治州",value:Math.round(1e3*Math.random())},{name:"百色市",value:Math.round(1e3*Math.random())},{name:"河池市",value:Math.round(1e3*Math.random())},{name:"桂林市",value:Math.round(1e3*Math.random())},{name:"南宁市",value:Math.round(1e3*Math.random())},{name:"柳州市",value:Math.round(1e3*Math.random())},{name:"崇左市",value:Math.round(1e3*Math.random())},{name:"来宾市",value:Math.round(1e3*Math.random())},{name:"玉林市",value:Math.round(1e3*Math.random())},{name:"梧州市",value:Math.round(1e3*Math.random())},{name:"贺州市",value:Math.round(1e3*Math.random())},{name:"钦州市",value:Math.round(1e3*Math.random())},{name:"贵港市",value:Math.round(1e3*Math.random())},{name:"防城港市",value:Math.round(1e3*Math.random())},{name:"北海市",value:Math.round(1e3*Math.random())},{name:"怀化市",value:Math.round(1e3*Math.random())},{name:"永州市",value:Math.round(1e3*Math.random())},{name:"邵阳市",value:Math.round(1e3*Math.random())},{name:"郴州市",value:Math.round(1e3*Math.random())},{name:"常德市",value:Math.round(1e3*Math.random())},{name:"湘西土家族苗族自治州",value:Math.round(1e3*Math.random())},{name:"衡阳市",value:Math.round(1e3*Math.random())},{name:"岳阳市",value:Math.round(1e3*Math.random())},{name:"益阳市",value:Math.round(1e3*Math.random())},{name:"长沙市",value:Math.round(1e3*Math.random())},{name:"株洲市",value:Math.round(1e3*Math.random())},{name:"张家界市",value:Math.round(1e3*Math.random())},{name:"娄底市",value:Math.round(1e3*Math.random())},{name:"湘潭市",value:Math.round(1e3*Math.random())},{name:"榆林市",value:Math.round(1e3*Math.random())},{name:"延安市",value:Math.round(1e3*Math.random())},{name:"汉中市",value:Math.round(1e3*Math.random())},{name:"安康市",value:Math.round(1e3*Math.random())},{name:"商洛市",value:Math.round(1e3*Math.random())},{name:"宝鸡市",value:Math.round(1e3*Math.random())},{name:"渭南市",value:Math.round(1e3*Math.random())},{name:"咸阳市",value:Math.round(1e3*Math.random())},{name:"西安市",value:Math.round(1e3*Math.random())},{name:"铜川市",value:Math.round(1e3*Math.random())},{name:"清远市",value:Math.round(1e3*Math.random())},{name:"韶关市",value:Math.round(1e3*Math.random())},{name:"湛江市",value:Math.round(1e3*Math.random())},{name:"梅州市",value:Math.round(1e3*Math.random())},{name:"河源市",value:Math.round(1e3*Math.random())},{name:"肇庆市",value:Math.round(1e3*Math.random())},{name:"惠州市",value:Math.round(1e3*Math.random())},{name:"茂名市",value:Math.round(1e3*Math.random())},{name:"江门市",value:Math.round(1e3*Math.random())},{name:"阳江市",value:Math.round(1e3*Math.random())},{name:"云浮市",value:Math.round(1e3*Math.random())},{name:"广州市",value:Math.round(1e3*Math.random())},{name:"汕尾市",value:Math.round(1e3*Math.random())},{name:"揭阳市",value:Math.round(1e3*Math.random())},{name:"珠海市",value:Math.round(1e3*Math.random())},{name:"佛山市",value:Math.round(1e3*Math.random())},{name:"潮州市",value:Math.round(1e3*Math.random())},{name:"汕头市",value:Math.round(1e3*Math.random())},{name:"深圳市",value:Math.round(1e3*Math.random())},{name:"东莞市",value:Math.round(1e3*Math.random())},{name:"中山市",value:Math.round(1e3*Math.random())},{name:"延边朝鲜族自治州",value:Math.round(1e3*Math.random())},{name:"吉林市",value:Math.round(1e3*Math.random())},{name:"白城市",value:Math.round(1e3*Math.random())},{name:"松原市",value:Math.round(1e3*Math.random())},{name:"长春市",value:Math.round(1e3*Math.random())},{name:"白山市",value:Math.round(1e3*Math.random())},{name:"通化市",value:Math.round(1e3*Math.random())},{name:"四平市",value:Math.round(1e3*Math.random())},{name:"辽源市",value:Math.round(1e3*Math.random())},{name:"承德市",value:Math.round(1e3*Math.random())},{name:"张家口市",value:Math.round(1e3*Math.random())},{name:"保定市",value:Math.round(1e3*Math.random())},{name:"唐山市",value:Math.round(1e3*Math.random())},{name:"沧州市",value:Math.round(1e3*Math.random())},{name:"石家庄市",value:Math.round(1e3*Math.random())},{name:"邢台市",value:Math.round(1e3*Math.random())},{name:"邯郸市",value:Math.round(1e3*Math.random())},{name:"秦皇岛市",value:Math.round(1e3*Math.random())},{name:"衡水市",value:Math.round(1e3*Math.random())},{name:"廊坊市",value:Math.round(1e3*Math.random())},{name:"恩施土家族苗族自治州",value:Math.round(1e3*Math.random())},{name:"十堰市",value:Math.round(1e3*Math.random())},{name:"宜昌市",value:Math.round(1e3*Math.random())},{name:"襄樊市",value:Math.round(1e3*Math.random())},{name:"黄冈市",value:Math.round(1e3*Math.random())},{name:"荆州市",value:Math.round(1e3*Math.random())},{name:"荆门市",value:Math.round(1e3*Math.random())},{name:"咸宁市",value:Math.round(1e3*Math.random())},{name:"随州市",value:Math.round(1e3*Math.random())},{name:"孝感市",value:Math.round(1e3*Math.random())},{name:"武汉市",value:Math.round(1e3*Math.random())},{name:"黄石市",value:Math.round(1e3*Math.random())},{name:"神农架林区",value:Math.round(1e3*Math.random())},{name:"天门市",value:Math.round(1e3*Math.random())},{name:"仙桃市",value:Math.round(1e3*Math.random())},{name:"潜江市",value:Math.round(1e3*Math.random())},{name:"鄂州市",value:Math.round(1e3*Math.random())},{name:"遵义市",value:Math.round(1e3*Math.random())},{name:"黔东南苗族侗族自治州",value:Math.round(1e3*Math.random())},{name:"毕节地区",value:Math.round(1e3*Math.random())},{name:"黔南布依族苗族自治州",value:Math.round(1e3*Math.random())},{name:"铜仁地区",value:Math.round(1e3*Math.random())},{name:"黔西南布依族苗族自治州",value:Math.round(1e3*Math.random())},{name:"六盘水市",value:Math.round(1e3*Math.random())},{name:"安顺市",value:Math.round(1e3*Math.random())},{name:"贵阳市",value:Math.round(1e3*Math.random())},{name:"烟台市",value:Math.round(1e3*Math.random())},{name:"临沂市",value:Math.round(1e3*Math.random())},{name:"潍坊市",value:Math.round(1e3*Math.random())},{name:"青岛市",value:Math.round(1e3*Math.random())},{name:"菏泽市",value:Math.round(1e3*Math.random())},{name:"济宁市",value:Math.round(1e3*Math.random())},{name:"德州市",value:Math.round(1e3*Math.random())},{name:"滨州市",value:Math.round(1e3*Math.random())},{name:"聊城市",value:Math.round(1e3*Math.random())},{name:"东营市",value:Math.round(1e3*Math.random())},{name:"济南市",value:Math.round(1e3*Math.random())},{name:"泰安市",value:Math.round(1e3*Math.random())},{name:"威海市",value:Math.round(1e3*Math.random())},{name:"日照市",value:Math.round(1e3*Math.random())},{name:"淄博市",value:Math.round(1e3*Math.random())},{name:"枣庄市",value:Math.round(1e3*Math.random())},{name:"莱芜市",value:Math.round(1e3*Math.random())},{name:"赣州市",value:Math.round(1e3*Math.random())},{name:"吉安市",value:Math.round(1e3*Math.random())},{name:"上饶市",value:Math.round(1e3*Math.random())},{name:"九江市",value:Math.round(1e3*Math.random())},{name:"抚州市",value:Math.round(1e3*Math.random())},{name:"宜春市",value:Math.round(1e3*Math.random())},{name:"南昌市",value:Math.round(1e3*Math.random())},{name:"景德镇市",value:Math.round(1e3*Math.random())},{name:"萍乡市",value:Math.round(1e3*Math.random())},{name:"鹰潭市",value:Math.round(1e3*Math.random())},{name:"新余市",value:Math.round(1e3*Math.random())},{name:"南阳市",value:Math.round(1e3*Math.random())},{name:"信阳市",value:Math.round(1e3*Math.random())},{name:"洛阳市",value:Math.round(1e3*Math.random())},{name:"驻马店市",value:Math.round(1e3*Math.random())},{name:"周口市",value:Math.round(1e3*Math.random())},{name:"商丘市",value:Math.round(1e3*Math.random())},{name:"三门峡市",value:Math.round(1e3*Math.random())},{name:"新乡市",value:Math.round(1e3*Math.random())},{name:"平顶山市",value:Math.round(1e3*Math.random())},{name:"郑州市",value:Math.round(1e3*Math.random())},{name:"安阳市",value:Math.round(1e3*Math.random())},{name:"开封市",value:Math.round(1e3*Math.random())},{name:"焦作市",value:Math.round(1e3*Math.random())},{name:"许昌市",value:Math.round(1e3*Math.random())},{name:"濮阳市",value:Math.round(1e3*Math.random())},{name:"漯河市",value:Math.round(1e3*Math.random())},{name:"鹤壁市",value:Math.round(1e3*Math.random())},{name:"大连市",value:Math.round(1e3*Math.random())},{name:"朝阳市",value:Math.round(1e3*Math.random())},{name:"丹东市",value:Math.round(1e3*Math.random())},{name:"铁岭市",value:Math.round(1e3*Math.random())},{name:"沈阳市",value:Math.round(1e3*Math.random())},{name:"抚顺市",value:Math.round(1e3*Math.random())},{name:"葫芦岛市",value:Math.round(1e3*Math.random())},{name:"阜新市",value:Math.round(1e3*Math.random())},{name:"锦州市",value:Math.round(1e3*Math.random())},{name:"鞍山市",value:Math.round(1e3*Math.random())},{name:"本溪市",value:Math.round(1e3*Math.random())},{name:"营口市",value:Math.round(1e3*Math.random())},{name:"辽阳市",value:Math.round(1e3*Math.random())},{name:"盘锦市",value:Math.round(1e3*Math.random())},{name:"忻州市",value:Math.round(1e3*Math.random())},{name:"吕梁市",value:Math.round(1e3*Math.random())},{name:"临汾市",value:Math.round(1e3*Math.random())},{name:"晋中市",value:Math.round(1e3*Math.random())},{name:"运城市",value:Math.round(1e3*Math.random())},{name:"大同市",value:Math.round(1e3*Math.random())},{name:"长治市",value:Math.round(1e3*Math.random())},{name:"朔州市",value:Math.round(1e3*Math.random())},{name:"晋城市",value:Math.round(1e3*Math.random())},{name:"太原市",value:Math.round(1e3*Math.random())},{name:"阳泉市",value:Math.round(1e3*Math.random())},{name:"六安市",value:Math.round(1e3*Math.random())},{name:"安庆市",value:Math.round(1e3*Math.random())},{name:"滁州市",value:Math.round(1e3*Math.random())},{name:"宣城市",value:Math.round(1e3*Math.random())},{name:"阜阳市",value:Math.round(1e3*Math.random())},{name:"宿州市",value:Math.round(1e3*Math.random())},{name:"黄山市",value:Math.round(1e3*Math.random())},{name:"巢湖市",value:Math.round(1e3*Math.random())},{name:"亳州市",value:Math.round(1e3*Math.random())},{name:"池州市",value:Math.round(1e3*Math.random())},{name:"合肥市",value:Math.round(1e3*Math.random())},{name:"蚌埠市",value:Math.round(1e3*Math.random())},{name:"芜湖市",value:Math.round(1e3*Math.random())},{name:"繁昌县",value:Math.round(2e3*Math.random())},{name:"淮北市",value:Math.round(1e3*Math.random())},{name:"淮南市",value:Math.round(1e3*Math.random())},{name:"马鞍山市",value:Math.round(1e3*Math.random())},{name:"铜陵市",value:Math.round(1e3*Math.random())},{name:"南平市",value:Math.round(1e3*Math.random())},{name:"三明市",value:Math.round(1e3*Math.random())},{name:"龙岩市",value:Math.round(1e3*Math.random())},{name:"宁德市",value:Math.round(1e3*Math.random())},{name:"福州市",value:Math.round(1e3*Math.random())},{name:"漳州市",value:Math.round(1e3*Math.random())},{name:"泉州市",value:Math.round(1e3*Math.random())},{name:"莆田市",value:Math.round(1e3*Math.random())},{name:"厦门市",value:Math.round(1e3*Math.random())},{name:"丽水市",value:Math.round(1e3*Math.random())},{name:"杭州市",value:Math.round(1e3*Math.random())},{name:"温州市",value:Math.round(1e3*Math.random())},{name:"宁波市",value:Math.round(1e3*Math.random())},{name:"舟山市",value:Math.round(1e3*Math.random())},{name:"台州市",value:Math.round(1e3*Math.random())},{name:"金华市",value:Math.round(1e3*Math.random())},{name:"衢州市",value:Math.round(1e3*Math.random())},{name:"绍兴市",value:Math.round(1e3*Math.random())},{name:"嘉兴市",value:Math.round(1e3*Math.random())},{name:"湖州市",value:Math.round(1e3*Math.random())},{name:"盐城市",value:Math.round(1e3*Math.random())},{name:"徐州市",value:Math.round(1e3*Math.random())},{name:"南通市",value:Math.round(1e3*Math.random())},{name:"淮安市",value:Math.round(1e3*Math.random())},{name:"苏州市",value:Math.round(1e3*Math.random())},{name:"宿迁市",value:Math.round(1e3*Math.random())},{name:"连云港市",value:Math.round(1e3*Math.random())},{name:"扬州市",value:Math.round(1e3*Math.random())},{name:"南京市",value:Math.round(1e3*Math.random())},{name:"泰州市",value:Math.round(1e3*Math.random())},{name:"无锡市",value:Math.round(1e3*Math.random())},{name:"常州市",value:Math.round(1e3*Math.random())},{name:"镇江市",value:Math.round(1e3*Math.random())},{name:"吴忠市",value:Math.round(1e3*Math.random())},{name:"中卫市",value:Math.round(1e3*Math.random())},{name:"固原市",value:Math.round(1e3*Math.random())},{name:"银川市",value:Math.round(1e3*Math.random())},{name:"石嘴山市",value:Math.round(1e3*Math.random())},{name:"儋州市",value:Math.round(1e3*Math.random())},{name:"文昌市",value:Math.round(1e3*Math.random())},{name:"乐东黎族自治县",value:Math.round(1e3*Math.random())},{name:"三亚市",value:Math.round(1e3*Math.random())},{name:"琼中黎族苗族自治县",value:Math.round(1e3*Math.random())},{name:"东方市",value:Math.round(1e3*Math.random())},{name:"海口市",value:Math.round(1e3*Math.random())},{name:"万宁市",value:Math.round(1e3*Math.random())},{name:"澄迈县",value:Math.round(1e3*Math.random())},{name:"白沙黎族自治县",value:Math.round(1e3*Math.random())},{name:"琼海市",value:Math.round(1e3*Math.random())},{name:"昌江黎族自治县",value:Math.round(1e3*Math.random())
},{name:"临高县",value:Math.round(1e3*Math.random())},{name:"陵水黎族自治县",value:Math.round(1e3*Math.random())},{name:"屯昌县",value:Math.round(1e3*Math.random())},{name:"定安县",value:Math.round(1e3*Math.random())},{name:"保亭黎族苗族自治县",value:Math.round(1e3*Math.random())},{name:"五指山市",value:Math.round(1e3*Math.random())}],{nodes:[{name:"刘备2239",value:20,subtext:"mings",subtext2:"mingssss",symbolSize:40,draggable:"true"},{name:"关羽",symbolSize:10,draggable:"true",value:20},{name:"曹操",symbolSize:30,draggable:"true",value:20},{name:"许褚",value:100,symbolSize:10,draggable:"true"},{name:"典韦",value:100,symbolSize:10,draggable:"true"},{name:"玄德",value:20,symbolSize:10,draggable:"true"},{name:"曹冲",value:50,symbolSize:10,draggable:"true"},{name:"张辽",value:50,symbolSize:10,draggable:"true"},{name:"关云",value:20,symbolSize:10,draggable:"true"},{name:"张飞",value:20,symbolSize:10,draggable:"true"},{name:"云长",value:10,symbolSize:10,draggable:"true"}],links:[{source:"刘备2239",target:"曹操",value:30,subtext1:"ming"},{source:"刘备2239",target:"张飞",value:300},{source:"关羽",target:"云长",value:300},{source:"刘备2239",target:"关云",value:300},{source:"刘备2239",target:"玄德",value:300},{source:"刘备2239",target:"关羽",value:300},{source:"曹操",target:"典韦",value:300},{source:"曹操",target:"许褚",value:300},{source:"曹操",target:"曹冲",value:300},{source:"曹操",target:"张辽",value:300}]})}(window,jQuery),function(e,t){"use strict";function a(){var a=function(e){var a=this,n={container:null,config:{},load:t.noop};return a.$container=null,a.options=t.extend(!0,{},n,e),a.init(),a};return a.prototype.init=function(){var e=this;e.$container=t(e.options.container).addClass("hiekn-table"),e.$container.append('<div class="hiekn-table-filter"></div><div class="hiekn-table-content"></div><div class="hiekn-table-page"><div class="pagination-outter"><ul class="pagination"></ul></div></div>'),e.buildFilter(),e.bindEvent()},a.prototype.bindEvent=function(){var e=this;e.bindFilterEvent(),e.bindTableEvent()},a.prototype.bindFilterEvent=function(){var a=this;this.select(".hiekn-table-filter").on("click","span[option-value]",function(e){var n=t(e.target);n.attr("option-key"),n.attr("option-value");n.closest(".hiekn-table-filter-item").hasClass("multi")?n.toggleClass("active"):(n.hasClass("active")?n.removeClass("active"):n.addClass("active").siblings(".active").removeClass("active"),a.loadData(1))}),this.select(".hiekn-table-filter").on("click",".hiekn-table-filter-more",function(e){var a=t(e.target);a.closest(".hiekn-table-filter-item").addClass("expend")}),this.select(".hiekn-table-filter").on("click",".hiekn-table-filter-less",function(e){var a=t(e.target);a.closest(".hiekn-table-filter-item").removeClass("expend")}),this.select(".hiekn-table-filter").on("click",".hiekn-table-filter-multi",function(e){var a=t(e.target);a.closest(".hiekn-table-filter-item").addClass("multi")}),this.select(".hiekn-table-filter").on("click",".hiekn-table-btn-confirm",function(e){var n=t(e.target);n.closest(".hiekn-table-filter-item").removeClass("multi"),a.loadData(1)}),this.select(".hiekn-table-filter").on("click",".hiekn-table-btn-cancel",function(e){var a=t(e.target);a.closest(".hiekn-table-filter-item").removeClass("multi")}),this.select(".hiekn-table-search-kw-container").on("keydown","input",function(t){var n=e.event?t.keyCode:t.which;13==n&&a.loadData(1)})},a.prototype.bindTableEvent=function(){var e=this;e.select(".hiekn-table-content").on("click",".hiekn-table-data-angle",function(){t(this).toggleClass("on").closest("tr").next("tr.hiekn-table-detail-line").toggleClass("hide")})},a.prototype.buildFilter=function(){var e=this,t="",a=e.options.config.filter;for(var n in a){var o=a[n],r=o.label||o.key,i="";for(var l in o.options){var s=o.options[l];i+=s instanceof Object?'<span option-value="'+s.value+'" option-key="'+o.key+'">'+s.key+"</span>":'<span option-value="'+s+'" option-key="'+o.key+'">'+s+"</span>"}t+='<div class="hiekn-table-filter-item"><div class="hiekn-table-filter-item-label">'+r+'：</div><div class="hiekn-table-filter-item-content">'+i+'<div class="hiekn-table-more-container"><span class="hiekn-table-filter-more">更多 <i class="fa fa-angle-down"></i></span><span class="hiekn-table-filter-less">收起 <i class="fa fa-angle-up"></i></span><span class="hiekn-table-filter-multi"><i class="fa fa-plus"></i> 多选</span><button class="btn btn-primary hiekn-table-btn-confirm">确定</button><button class="btn btn-primary-outline hiekn-table-btn-cancel">取消</button></div></div></div>'}t+='<div class="hiekn-table-filter-item hiekn-table-filter-item-kw"><div class="hiekn-table-filter-item-label">关键词：</div><div class="hiekn-table-filter-item-content"><div class="hiekn-table-search-kw-container"><input type="text"><button class="btn btn-primary hiekn-table-btn-confirm">确定</button></div></div></div>',e.select(".hiekn-table-filter").html(t)},a.prototype.dealContent=function(e){if(e){var a=t("<div>"+e+"</div>").text();return a.length>80?a.substring(0,80)+"...":a}return""},a.prototype.drawPage=function(e,t,a){var n=this;hieknjs.gentPage({data:Math.ceil(e/a),cur:t,p:n.select(".pagination"),event:function(e,t){n.loadData(t)}})},a.prototype.drawData=function(e){var t=this,a=t.options.config;e=hieknjs.dealNull(e),t.data=e;var n="<thead><tr>",o="<tbody>",r=a.fieldsTable||a.fields,i=a.fieldsTableName?a.fieldsTableName:a.fieldsName?a.fieldsName:r,l=a.drawDetail||a.fieldsDetail||a.fieldsTable,s=a.fieldsDetail||a.fields,d=a.fieldsDetailName?a.fieldsDetailName:a.fieldsName?a.fieldsName:r,c=a.fieldsRenderer||{},u={};l&&(n+="<th></th>");for(var h in r){var m=c[r[h]];if(m&&m instanceof Object&&"link"==m.type&&m.fields)for(var g in m.fields){var p=m.fields[g];u[p]=r[h]}else n+="<th>"+i[h]+"</th>"}for(var f in e){var v=e[f],M="<tr>";l&&(M+='<td class="hiekn-table-data-angle"><i class="fa fa-caret-right"></i></td>');var b=0;for(var k in r){b++;var y=r[k];c[y]&&c[y].fields||(M+="<td>"+t.rendererFields(v,y,u,c,!0)+"</td>")}if(M+="</tr>",o+=M,l){var S='<tr class="hiekn-table-detail-line hide"><td colspan="'+(b+1)+'">';for(var g in s){var y=s[g];c[y]&&c[y].fields||(S+='<div class="hiekn-table-detail-'+y+'"><label>'+d[g]+":</label>"+t.rendererFields(v,y,u,c,!1)+"</div>")}S+="</td></tr>",o+=S}}o+="</body>",n+="</tr></thead>",t.select(".hiekn-table-content").html('<table class="hiekn-table-normal">'+n+o+"</table>")},a.prototype.getFilterKw=function(){var e=this,t=e.select(".hiekn-table-search-kw-container");return t.find("input").val()},a.prototype.getFilterOptions=function(){var e=this,a={};return e.select(".hiekn-table-filter-item").each(function(e,n){var o="",r=t(n).find("span[option-value].active");if(r.length){var i=!1,l=[];r.each(function(e,a){var n=t(a).attr("option-value");n?(o=t(a).attr("option-key"),l.push(n)):i=!0}),i||(a[o]=l)}}),a},a.prototype.getTableContainer=function(){var e=this;return e.select(".hiekn-table-content")},a.prototype.getValues=function(e){var t=[];if(e instanceof Array)t=e;else if("string"==typeof e)if(0==e.indexOf("["))try{t=JSON.parse(e)}catch(a){t=[e]}else t=e.split(",");return t},a.prototype.loadData=function(e){var t=this;t.options.load(e,t)},a.prototype.rendererDateTime=function(e){return moment(e).format("YYYY-MM-DD HH:mm:ss")},a.prototype.rendererDate=function(e){return moment(e).format("YYYYMMDD")},a.prototype.rendererFields=function(e,t,a,n,o){var r=this,i="";if(e[t]){var l=r.getValues(e[t]);for(var s in l)i+=n[t]?","+r.rendererValue(n[t].type||n[t],l[s],n[t],o):","+r.rendererValue("string",l[s],void 0,o);i=i.substring(1)}if(a[t]){var d=e[t];e[t]||(d="链接"),i=r.rendererLink(e[a[t]],d)}return i},a.prototype.rendererYear=function(e){return moment(e).format("YYYY")},a.prototype.rendererLink=function(e,t,a){return t=t||"查看",a=a||"",e?'<a href="'+e+'" target="_blank" class="'+a+'">'+t+"</a>":""},a.prototype.rendererValue=function(e,t,a,n){var o=this,r="";try{r="year"==e?o.rendererYear(t):"date"==e?o.rendererDate(t):"dateTime"==e?o.rendererDateTime(t):"json"==e?JSON.stringify(t):"link"==e?o.rendererLink(t,a.name,"hiekn-table-btn-link"):"string"==e&&n?o.dealContent(t):hieknjs.safeHTML(t)}catch(i){}return r},a.prototype.select=function(e){var t=this;return t.$container.find(e)},a}e.HieknTableService=a()}(window,jQuery),function(e,t){"use strict";function a(){var a=function(a){var n=this;n.isInit=!1,n.baseSettings={baseUrl:a.baseUrl,data:a.data,kgName:a.kgName},n.filterSettings={selectedAtts:a.selectedAtts,selectedTypes:a.selectedTypes},n.infoboxSettings={enable:"boolean"!=typeof a.infobox||a.infobox,dataFilter:a.dataFilter,selector:a.selector,imagePrefix:a.imagePrefix},t.extend(!0,n.infoboxSettings,n.baseSettings),n.loaderSettings={dataFilter:a.dataFilter,selector:a.selector,tgc2:null,tgc2Filter:null,tgc2TimeChart:null},t.extend(!0,n.loaderSettings,n.baseSettings),n.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof a.enableAutoUpdateStyle||a.enableAutoUpdateStyle,imagePrefix:a.imagePrefix,images:a.images,nodeColors:a.nodeColors,textColors:a.textColors,minRadius:a.minRadius||10,legendClass:null,legendColor:null,tgc2:null},n.promptSettings=n.baseSettings,n.schemaSettings={preloadData:a.schema,dataFilter:a.dataFilter,that:t(a.selector)[0]},t.extend(!0,n.schemaSettings,n.baseSettings),n.initSettings={dataFilter:a.dataFilter,that:t(a.selector)[0],isTiming:!0,success:function(e){e.entityList&&e.entityList.length&&n.load(e.entityList[0])},failed:t.noop},t.extend(!0,n.initSettings,n.baseSettings),n.tgc2Settings={},n.legendFilter={},n.layoutStatus=a.layoutStatus,n.sdkUtils=new e.HieknSDKService,n.schemaSettings.preloadData?n.init(a,n.schemaSettings.preloadData):n.sdkUtils.schema(n.schemaSettings,function(e){n.init(a,e)})};return a.prototype.init=function(e,a){var n=this;if(e.autoColor){var o={};for(var r in a.types)o[a.types[r].k]=n.sdkUtils.color[r%n.sdkUtils.color.length];t.extend(!0,o,n.nodeSettings.nodeColors||{}),n.nodeSettings.nodeColors=o}var i=n.sdkUtils.buildFilter(a,n.filterSettings),l={selector:e.selector,autoResize:!0,prompt:{enable:!0,settings:{drawPromptItem:n.sdkUtils.drawPromptItem(a),onPrompt:n.sdkUtils.onPrompt(n.promptSettings)}},filter:{enable:!0,filters:i},crumb:{enable:!0},find:{enable:!0},legend:{enable:!0,style:{bottom:"60px"},data:n.nodeSettings.nodeColors||[],legendDraw:n.sdkUtils.legendDraw(a,n,e.legendType),onClick:function(e){n.sdkUtils.legendClick(e,n)},onDblClick:function(e){n.sdkUtils.legendDblClick(e,n)},onMouseEnter:function(e){n.sdkUtils.legendMouseEnter(e,n)},onMouseLeave:function(e){n.sdkUtils.legendMouseLeave(e,n)}},timeChart:{enable:!0},event:{enable:!0},netChart:{settings:{filters:{nodeFilter:function(e){return n.sdkUtils.nodeFilter(e,n)}},nodeMenu:{contentsFunction:n.sdkUtils.infobox()},style:{node:{display:e.display||"circle"},nodeStyleFunction:n.sdkUtils.nodeStyleFunction(n.nodeSettings)},info:{linkContentsFunction:n.sdkUtils.linkContentsFunction}}},loader:n.sdkUtils.timing(n.loaderSettings,a)};n.tgc2Settings=t.extend(!0,{},l,e.tgc2Settings),n.infoboxSettings.enable&&n.sdkUtils.gentInfobox(n.infoboxSettings),n.tgc2=new Tgc2Graph(n.tgc2Settings),n.tgc2Filter=new Tgc2Filter(n.tgc2,n.tgc2Settings.filter),n.tgc2TimeChart=new Tgc2TimeChart(n.tgc2,n.tgc2Settings.timeChart),n.tgc2Event=new Tgc2Event(n.tgc2,n.tgc2Settings.event),n.tgc2Prompt=new Tgc2Prompt(n.tgc2,n.tgc2Settings.prompt),n.tgc2Crumb=new Tgc2Crumb(n.tgc2,n.tgc2Settings.crumb),n.tgc2Find=new Tgc2Find(n.tgc2,n.tgc2Settings.find),n.tgc2Legend=new Tgc2Legend(n.tgc2,n.tgc2Settings.legend),n.loaderSettings.tgc2=n.tgc2,n.loaderSettings.tgc2Filter=n.tgc2Filter,n.loaderSettings.tgc2TimeChart=n.tgc2TimeChart,n.nodeSettings.tgc2=n.tgc2,n.tgc2.init(),n.isInit=!0;try{n.tgc2TimeChart.$settingModal.find(".input-daterange").datepicker({format:"yyyy-mm-dd"}),n.tgc2TimeChart.$settingModal.find(".input-daterange").find("input").prop("type","text")}catch(s){}e.startInfo&&n.load(e.startInfo)},a.prototype.load=function(e){var t=this;setTimeout(function(){t.isInit?e?t.tgc2.load(e):t.sdkUtils.graphInit(t.initSettings):t.load(e)},30)},a}e.HieknTimingGraphService=a()}(window,jQuery);