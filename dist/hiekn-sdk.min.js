/**
     * @author: 
     *    jiangrun002
     * @version: 
     *    v2.2.1
     * @license:
     *    Copyright 2017, jiangrun. All rights reserved.
     */

!function(t,e){"use strict";function n(){var n=function(n){var i=this;i.sdkUtils=new t.HieknSDKService;var a={baseUrl:n.baseUrl,data:n.data,kgName:n.kgName};i.promptSettings=e.extend(!0,{},a,n.promptSettings||{}),i.defaultOptions={lightColor:"#fff",primaryColor:"#00b38a",primaryLightColor:"rgba(0,179,138,0.3)",emphasesColor:"#faa01b",emphasesLightColor:"rgba(250, 160, 27,0.3)",kgName:null,baseUrl:null,data:{},instanceEnable:!1,tgc2Settings:{selector:null,netChart:{settings:{toolbar:{enabled:!1},info:{enabled:!1},nodeMenu:{},style:{selection:{enabled:!1,fillColor:""},nodeStyleFunction:function(t){i.nodeStyleFunction(t)},nodeHovered:{shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0)"},linkStyleFunction:function(t){t.hovered&&(t.label=t.data.attName),t.toDecoration="arrow",t.fillColor="#ddd"},linkLabel:{textStyle:{fillColor:"#999"}}}}},prompt:{enable:!0,settings:{onPrompt:i.sdkUtils.onPromptKnowledge(i.promptSettings)}},page:{enable:!0,style:{right:"15px"},pageSize:20},loader:function(t,e,n){i.loader(t,e,n)}}},i.options=e.extend(!0,{},i.defaultOptions,n),i.options.tgc2Settings.selector=i.options.tgc2Settings.selector||i.options.selector,i.tgc2=null,i.tgc2Prompt=null,i.tgc2Page=null,i.init(),n.startInfo&&i.load(n.startInfo)};return n.prototype.init=function(){var t=this;t.tgc2=new Tgc2Graph(t.options.tgc2Settings),t.tgc2Prompt=new Tgc2Prompt(t.tgc2,t.options.tgc2Settings.prompt),t.tgc2Page=new Tgc2Page(t.tgc2,t.options.tgc2Settings.page),t.tgc2.init(),e(t.options.tgc2Settings.selector).addClass("tgc2 tgc2-concept-graph"),t.options.instanceEnable&&e(t.options.tgc2Settings.selector).append('<div class="tgc2-info-top"><ul class="info-top"><li class="current"><i class="fa fa-circle" style="color:'+t.options.emphasesColor+'"></i><span>当前节点</span></li><li class="concept"><i class="fa fa-circle" style="color:'+t.options.primaryColor+'"></i><span>概念</span></li><li class="instance"><i class="fa fa-circle-o" style="color:'+t.options.primaryColor+'"></i><span>实例</span></li></ul></div>'),e(t.options.tgc2Settings.selector).append('<div class="tgc2-info-bottom"><div class="info-bottom"><span>中心节点：</span><span name="name" style="color:'+t.options.emphasesColor+'"></span></div></div>')},n.prototype.load=function(t){var e=this;e.kgName=e.options.kgName,e.tgc2.load(t),setTimeout(function(){e.tgc2.resize()},300)},n.prototype.loader=function(t,n,i){var a=this,o=a.tgc2.startInfo,r=a.tgc2Page.page,s=a.options.data||{};s.type=o.kgType||0,s.pageNo=r.pageNo,s.pageSize=r.pageSize,s.kgName=a.options.kgName,s.entityId=o.id,hieknjs.kgLoader({url:a.options.baseUrl+"graph/knowlegde?"+e.param(s),type:0,dataFilter:a.options.dataFilter||function(t){return t},that:e(a.options.tgc2Settings.selector)[0],success:function(r){if(r&&r.rsData&&r.rsData.length){if(r=r.rsData[0],r.entityList&&r.entityList.length)for(var s in r.entityList){var l=r.entityList[s];l.id==o.id&&e(a.options.tgc2Settings.selector).find(".tgc2-info-bottom").find('[name="name"]').text(l.name)}r.nodes=r.entityList,r.links=r.relationList,delete r.entityList,delete r.relationList,n(r),t.netChart.resetLayout()}else i&&i(),t.netChart.replaceData({nodes:[],links:[]})},error:function(){i&&i(),toastr.error("网络接口错误！")}})},n.prototype.nodeStyleFunction=function(t){var e=this,n=e.tgc2.startInfo;t.label=t.data.name,t.labelStyle.textStyle.font="18px Microsoft Yahei",t.aura=t.data.auras,t.radius=15,t.imageCropping="fit";var i=t.id==n.id;0==t.data.kgType?(t.lineWidth=10,t.lineColor=e.options.primaryLightColor,t.fillColor=e.options.primaryColor,t.image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhENzQwNUZFMTVFQjExRTc4QTJDOTY3REE4RkM4MjFCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhENzQwNUZGMTVFQjExRTc4QTJDOTY3REE4RkM4MjFCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEQ3NDA1RkMxNUVCMTFFNzhBMkM5NjdEQThGQzgyMUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEQ3NDA1RkQxNUVCMTFFNzhBMkM5NjdEQThGQzgyMUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7rBsIlAAAFUklEQVR42uydX05TURDGp5V3ygq8JJJINIGugLICy4PySF0BdQGGsgLqCixviibCCrisgJLoEybUFUjfNfVM7iESUyi1vXNmzvm+ZCJg0p5753fmzPlfGY1GBKWrCgAAAHgLAAACABAAgAAABAAgAAABAAgAxKDM2Zqzdf8zW83/Pk59Z9fOBt749wv/MwAwIHbuC2cNb9mcPpcByL2deEgAgCLtOGt6k9Cxt0MAELa27zpr+59DiCNB19k7q1HBIgDs7D1nrYCOHwdCz9m+NRCsAcA1vqPI8eNA6PiIAADmKM7a39+TvWsT9x5e+38BwIza87XKotrao4FmADjMf/HdOcviruOW1txAKwDWQr7ZJkEjAOz0U8WJ3iwJ4qY2CLQBEKvz1UKgCYDYna8SAi0ApOL82xDUScEkkwYAat7565SW+j4SXKcOAGf7LUpTPd87SBYAHig5oLT1hooJpeQAyJydJ9Tuq8wHQgLAo3xNgli8tmArJQCaHgDor7Y8CEkAcEXzW64Vi7gJWJb+0mqAB23B+XfmRK0UIgBqv6IoIA1Ag4pBH+hu8eBQHmsT0IJ/db0jyQhQ8+G/Bh9PHBdYJqEhYskI0ITzH1xRGjE2ARIPdeTsubMFjm4l2IL//COByhJdE1B29v/Z2UtBoD86e2W9NyAFAE/1npf8HVwzvwkC8MzZ1xI/f5kE5gekmgCJfv+lcFt9KVBposkBJB5mRRiAFQCg62H2hAF4CwCm69qULU4APzhbdfaoxPe16r9nO4J3JpYE5s42FPW1K/f8n5Zl0mcSXWcpALTtPrEAAI8ELgGAdAGYVE4AAAAAAAAw0gs4I0jlO6viPactAKBXUa0HyOHPqdWPCYAB/Jk2AH34U2elkVwQwm3aIrqBD9KQhOYCJJNA5AEPl9gWsWqMDxWBxCqLZBOQUbEuEE3AZC1RhMvCOanBiOBkid5HID0Q1IV/J6onGgoDbA7lSPAYTcBY/SDhjbPV2Ak3JvEIGSICcP+2HzgK8A6f32P+zmsJfwWs/eskfGxciAhwc6lCSD2d8u8S6lCAMwNDHhIVMhf4ROO3dUms9h2nCwp0UGZIACS2i90n3tvHd/x8d/aEin0F24HKUqdA8yWhD4rskPyGDm3aD9kkajgqlslfS9T5Imv/tQOQeQgWE3P+0DeDg9QBuMkH8oQgGPqaH3ydhKYLI1I6PTTIqaDaAWC1qDg+Pmbx8fA9LYXReGkUQ9CNsDngsN8mZUPhmq+NiyknUNPmWwEgJgjUOl87AERxHC1bJ8Wroi3cHcxt5o5R5x+S8uNxLQAQes5gFokc9RY7AEQ6VhFNK/HVPf8jK5tDBwZrv4kyY3dw4gIAAAACAFAZugYA81NuEIA+AEjsZVoss5VxAGtjAcFW+cYMgKURwTqhCSglpPJiiqHiMg59Gc00WZYiwO1IwAtGNpSVi1f4tq3lKxYBuFFGxXRxpiA3ycnoSWiWAYAAAAQAIAAApdENvC0+ZII3lfKpY6PA9tPZARm9F9liBOAXfUr6Rtq4+7dJRiaBLAPAYwC7SsumfhFoDACUfQn1LBK56St1ALQXuAIAym9rtR4oYWIlsPVeQBdlwziAxkTQXAJoGQBWg4pDJUJ3BwdUbF/LMQ4AAQAIAEAAAAIAYcXZ+MYc++Q8wnfsM30AoFw5lbde0OSET0oASIwPmOzvpwKA1MNUYnlhMW0OlRwQaiACpB0BxO71QwSYTicC33GGJFCvyr6QSsUR7wBgMgQd306vzdHxPA7Qjqn2xwoABAAgAAABAAgAQAAAAgAQAIAAAAQAoH/1R4ABAHF3K+2bw1JCAAAAAElFTkSuQmCC",i&&(t.fillColor=e.options.emphasesColor,t.lineColor=e.options.emphasesLightColor)):(t.lineWidth=2,t.lineColor=e.options.primaryColor,t.fillColor=e.options.lightColor,t.image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjA3RUVGNzVBMTVFQzExRTdBM0FERjI5RjczQUM4N0QyIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjA3RUVGNzVCMTVFQzExRTdBM0FERjI5RjczQUM4N0QyIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDdFRUY3NTgxNUVDMTFFN0EzQURGMjlGNzNBQzg3RDIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDdFRUY3NTkxNUVDMTFFN0EzQURGMjlGNzNBQzg3RDIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5z4BZ4AAADHUlEQVR42uzbTU4UQRyG8QYMbLyBK1mKiR8L3RsXfnABWeugO7mIrkwEcc0FJGFhOIExaohLogtvIDGQCP47NAkboGeYwuqu35O8mYR0MdNTz1Qq1XknDg4OKpTLBAEI4FsgAAgAAoAAIAAIAAKAACAACAACgAAgAAgAAoAAIAAIAAKAACAACAACnMTKysq1eHkaeRi52vx5O7IRWY18L3kCBoNBPwWIiZ+Ol1eRF5HJEy7bj7yLLEX+DPkW9f9/HnkSuR653DM3fke2ImuRtyHKXmcEaCZ/PXK/5ZDNZoVoe5NXIh8iNwtZKL5E5kOCX+P+x5OJPvDrISa/5l6zWrT95Zc0+VVzr+vxw5rJXoD4kHPxsjjC0Ho5n2tx3WJhk3/EjXrL0IUVoN7wTY0wbqoZexYLBe8ZF7ogwIPEY28XLMCtLggwm3jsdMECzHRBgPOwV+FCSSHA9jnG/iTJmWcD2QuwcY6xH1tc87lgAba6IMD7yN8RxtVjVltct1awAGvZCzAYDGpLl0cYutzS8Pq6rwVO/rcRv9f/sglcarmcH7HZjGnDbuRxdXg8Wgq18I/ix7XbCQGaBxf1JL2pDh/4nMR+Y/X8kJu7+kz8buRl5FNkp4eTvtPcW32Pd1I8B6i5iMfB9fHus+rwkGe2megfzQqxmmJj0yV6+zh4CEEqAvTrHAAdggAEAAFAABAABAABQAAQAAQAAUAA9JtLqd9AOzhvtIPzRTv4FLSDM98DaAePF+3gY2gHZ74CaAenQzu40g7OXgDt4HRoByN/AbSD054NZC+AdnA6tIMr7eC8BdAOToZ2cIN2cO4CaAePBe3gEtAO1g7u3TkAOgQBCAACgAAgAAgAAoAAIAAIAAKAAOg32sGFox2cL9rBp6AdnPkeQDt4vGgHH0M7OPMVQDs4HdrBlXZw9gJoB6dDOxj5C6AdnPZsIHsBtIPToR1caQfnLYB2cDK0gxu0g3MXQDt4LGgHl0Dx7WBUBAABQAAQAAQAAUAAEAAEAAFAABAABAABQAAQAAQAAUAAEAAEAAFAABAABAABMCT/BBgA8SDQyY7AsYEAAAAASUVORK5CYII=",i&&(t.fillColor=e.options.lightColor,t.lineColor=e.options.emphasesColor)),t.hovered&&(t.radius=1.25*t.radius)},n}t.HieknConceptGraphService=n()}(window,jQuery),function(t,e){"use strict";function n(){var t=function(t){var n=this,i={beforeDrawPrompt:null,container:null,data:null,baseUrl:null,kgName:null,ready:e.noop,replaceSearch:!1,onSearch:e.noop};n.options=e.extend(!0,{},i,t),n.init()};return t.prototype.init=function(){var t=this,n=new HieknSDKService(t.options),i={0:"概念",1:"实例"},a={drawPromptItem:function(t,e){var n='<span class="prompt-tip-title">'+t.name.replace(new RegExp("("+e+")","gi"),'<span class="highlight">$1</span>')+"</span>";return n='<span class="prompt-tip-type prompt-tip-'+t.kgType+'">'+(i[t.kgType]||"")+"</span>"+n},onPrompt:n.onPromptKnowledge(t.options)};t.options.replaceSearch&&(a.beforeSearch=n.beforeSearch()),e.extend(!0,a,t.options),t.instance=new hieknPrompt(a),t.options.ready(t.instance)},t}t.HieknConceptPromptService=n()}(window,jQuery),function(t,e){"use strict";function n(){var t=function(t){var n=this;n.clickTimeout=null,n.isFirst=!0,n.lastSelectedNode=null,n.startAsync=!1,n.treeDbClick=!1;var i={container:null,data:null,baseUrl:null,kgName:null,getAsyncUrl:function(){var t=n.options.data||{};return t.kgName=n.options.kgName,n.options.readAll?t.id=n.getLastSelectedNodeId()||0:t.id=n.getLastSelectedNodeId()||n.options.initId,t.onlySubTree=n.isFirst?0:1,n.options.baseUrl+"concept?"+e.param(t)},idKey:"id",initId:0,nameKey:"name",onNodeClick:e.noop,nodeHoverTools:{infobox:{enable:!1},graph:{enable:!1,instanceEnable:!1,infobox:!1,conceptGraphSettings:{}}},instance:{enable:!1,url:"",onClick:e.noop},namespace:"hiekn-concept-tree",pIdKey:"parentId",readAll:!1,hiddenIds:{self:[],rec:[]}};n.options=e.extend(!0,{},i,t),n.zTreeSettings=null,n.zTree=null,n.infoboxService=null,n.tgc2ConceptGraph=null,n.instanceSearch=null,n.init()};return t.prototype.init=function(){var t=this;if(t.$container=e(t.options.container),t.treeId=t.options.namespace+"-"+(new Date).getTime(),t.$container.addClass("hiekn-concept-tree").append('<ul class="ztree" id="'+t.treeId+'"></ul>'),t.zTreeSettings=t.updateZTreeSettings(),t.zTree=e.fn.zTree.init(t.$container.find(".ztree"),t.zTreeSettings),t.options.nodeHoverTools.graph.enable&&t.initGraph(),t.options.nodeHoverTools.infobox.enable&&t.initInfobox(),t.options.instance.enable){var n=t.options.namespace+"-prompt-"+(new Date).getTime();t.$instanceContainer=e('<div class="hiekn-instance-container"><div class="hiekn-instance-prompt" id="'+n+'"></div><div class="hiekn-instance-list"></div></div>'),t.$container.append(t.$instanceContainer),t.instanceSearchSettings={container:"#"+n,promptEnable:!1,placeholder:"实例搜索",onSearch:function(n){var i={paramName:"kw",url:t.options.baseUrl+"prompt",type:1};e.extend(!0,i,t.options.instance.searchSettings||{});var a=t.options.data||{},o=t.options.data2||{};o.kgName=t.options.kgName,o[i.paramName||"kw"]=n,hieknjs.kgLoader({url:i.url+"?"+e.param(a),params:o,type:i.type,dataFilter:t.options.dataFilter||function(t){return t},success:function(e){if(e){var n=t.select(".instance-loader-container");n.attr({"data-more":"0","data-page":"1"}),t.drawInstanceList(e.rsData,!1)}}})}},t.instanceSearch=new hieknPrompt(t.instanceSearchSettings),t.bindInstanceEvent()}},t.prototype.addHoverDom=function(t,n){var i=this,a=i.select("#"+n.tId+"_span");if(!(i.select("#button-container_"+n.tId).length>0)){var o=e('<span class="button-container" id="button-container_'+n.tId+'" ></span>');a.after(o),i.onNodeHover(o,n)}},t.prototype.beforeAsync=function(t,e){var n=this;return e&&(n.startAsync=!0,n.lastSelectedNode=e),!0},t.prototype.bindInstanceEvent=function(){var t=this;t.select(".hiekn-instance-list").on("scroll",function(n){e(n.target).height()+e(n.target).scrollTop()>e(n.target)[0].scrollHeight-50&&t.loadInstanceService()}),t.select(".hiekn-instance-list").on("click","li[data-id]",function(){var n=e(this).data("data");e(this).addClass("active").siblings(".active").removeClass("active"),t.options.instance.onClick(n)})},t.prototype.dataFilter=function(t,e,n){var i=this;if(i.options.dataFilter&&(n=i.options.dataFilter(n)),200==n.code){if(!n.data||!n.data.rsData)return null;n=n.data.rsData;for(var a=n.length,o=[],r=0;r<a;r++)!i.options.readAll&&(n[r].isParent=!0),_.indexOf(i.options.hiddenIds.self,n[r][i.options.idKey])<0&&_.indexOf(i.options.hiddenIds.rec,n[r][i.options.idKey])<0&&_.indexOf(i.options.hiddenIds.rec,n[r][i.options.pIdKey])<0&&(e&&n[r][i.options.idKey]==e[i.options.idKey]||o.push(n[r])),_.indexOf(i.options.hiddenIds.rec,n[r][i.options.pIdKey])>=0&&i.options.hiddenIds.rec.push(n[r][i.options.idKey]);if(0!=o.length)return o;e.isParent=!1}else toastr.error(n.msg);return null},t.prototype.expandNodes=function(t){var e=this,n=e.zTree.getNodeByParam(e.options.idKey,t);if(n){e.zTree.expandNode(n,!0,!1,!0,!1);var i=n.getParentNode();i&&e.expandNodes(i[e.options.idKey])}},t.prototype.drawInstanceList=function(t,n){var i=this,a=i.$instanceContainer.find(".hiekn-instance-list ul"),o=e("<ul></ul>");if(t.length)for(var r in t){var s=e('<li data-id="'+t[r].id+'" title="'+t[r].name+'">'+t[r].name+"</li>").data("data",t[r]);o.append(s)}else n||o.append("<li>没有找到相关实例</li>");n?a.append(o.children()):a.html(o.children())},t.prototype.getLastSelectedNodeId=function(){var t=this;return t.lastSelectedNode?t.lastSelectedNode[t.options.idKey]:null},t.prototype.getLastSelectedInstance=function(){var t=this;return t.select(".hiekn-instance-list li[data-id].active").data("data")},t.prototype.getAsyncUrl=function(){var t=this;return"string"==typeof t.options.getAsyncUrl?t.options.getAsyncUrl:t.options.getAsyncUrl(t)},t.prototype.initInfobox=function(){var t=this,e={};e.kgName=t.options.kgName,e.baseUrl=t.options.baseUrl,t.infoboxService=new HieknInfoboxService(e)},t.prototype.initGraph=function(){var t=this,n=t.options.namespace+"-tgc2-"+(new Date).getTime();t.$graphContainer=e('<div class="modal fade hiekn-concept-tree-graph-modal" id="'+n+'-modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><i class="fa fa-times-circle"></i></button><h4 class="modal-title"><span name="title"></span></h4></div><div class="modal-body"><div class="'+n+'"></div></div></div></div></div>'),e("body").append(t.$graphContainer);var i={selector:"."+n,baseUrl:t.options.baseUrl,data:t.options.data,kgName:t.options.kgName,instanceEnable:t.options.nodeHoverTools.graph.instanceEnable,tgc2Settings:{netChart:{settings:{nodeMenu:{}}}}};e.extend(!0,i,t.options.nodeHoverTools.graph.conceptGraphSettings),t.options.nodeHoverTools.graph.infobox&&(t.sdkUtils=new HieknSDKService,t.sdkUtils.gentInfobox({selector:"."+n,baseUrl:t.options.baseUrl,data:t.options.data,kgName:t.options.kgName}),i.tgc2Settings.netChart.settings.nodeMenu.contentsFunction=t.sdkUtils.infobox()),t.tgc2ConceptGraph=new HieknConceptGraphService(i)},t.prototype.loadGraph=function(t){var e=this;e.tgc2ConceptGraph.load({id:t,kgType:0})},t.prototype.reloadInstance=function(){var t=this;t.select(".hiekn-instance-list").html('<ul></ul><div class="instance-loader-container" data-more="1" data-page="1"></div>'),t.loadInstanceService()},t.prototype.loadInstanceService=function(){var t=this,n=t.select(".instance-loader-container");if("0"!=n.attr("data-more")){var i=t.options.data||{};i.conceptId=t.getLastSelectedNodeId()||t.options.initId,i.readAll=0,i.pageNo=n.attr("data-page"),i.pageSize=15,i.kgName=t.options.kgName,1!=n.data("inLoading")&&(n.data("inLoading",1),hieknjs.kgLoader({url:t.options.instance.url+"?"+e.param(i),dataFilter:t.options.dataFilter||function(t){return t},success:function(e,i,a,o){if(e){var r=e.rsData;r.length<=o.pageSize&&n.attr({"data-more":0}),r.length>o.pageSize&&r.pop(),t.drawInstanceList(r,1!=o.pageNo),n.attr({"data-page":parseInt(o.pageNo,10)+1})}},complete:function(){n.data("inLoading",0);var e=t.select(".hiekn-instance-list");e.children("ul").height()<e.height()&&t.loadInstanceService()},that:n[0]}))}else console.log("no more instance")},t.prototype.onAsyncSuccess=function(t,e,n){var i=this,a=n;a&&i.onNodeClick(a),a&&0==a.children.length?(a.isParent=!1,i.zTree.updateNode(a),toastr.info("当前概念没有子概念")):a||(i.expandNodes(i.getLastSelectedNodeId()||i.options.initId),i.getLastSelectedNodeId()||(a=i.zTree.getNodeByParam(i.options.idKey,i.options.initId),i.zTree.selectNode(a),i.onNodeClick(a)));var o=i.zTree.getNodeByParam(i.options.idKey,i.options.initId);i.addHoverDom(e,o),i.isFirst=!1,i.startAsync=!1},t.prototype.onClick=function(t,e,n){var i=this;i.clickTimeout&&clearTimeout(i.clickTimeout),i.clickTimeout=setTimeout(function(){i.lastSelectedNode=n,i.onNodeClick(n),i.treeDbClick=!1},500)},t.prototype.onNodeButtonClick=function(t,e){var n=this;n.select(".tree-button-active").removeClass("tree-button-active"),n.zTree.selectNode(e),t.addClass("tree-button-active"),n.lastSelectedNode=e},t.prototype.onNodeClick=function(t){var e=this;e.options.instance.enable&&e.reloadInstance(),e.options.onNodeClick(t)},t.prototype.onNodeHover=function(t,n){var i=this;for(var a in i.options.nodeHoverTools){var o=i.options.nodeHoverTools[a];if("graph"==a&&o.enable){var r=e('<span class="button" title="图谱可视化" onfocus="this.blur();"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="12"><path d="M892.790083 1009.647551c-58.355904 31.366176-131.161266 9.611215-162.610663-48.591301-24.342972-45.045432-16.764962-98.703426 14.947153-135.21462L698.862198 739.012706c-23.246413 7.764034-48.157246 11.970777-74.066732 11.970777-114.073211 0-208.817925-81.626793-227.545924-188.916672l-96.293279-0.561334c-16.764962 45.964127-60.950442 78.79075-112.82979 78.79075-66.291275 0-120.03249-53.600882-120.03249-119.725715 0-66.119938 53.741215-119.725715 120.03249-119.725715 51.30496 0 95.064544 32.111902 112.242348 77.279717l97.913641 0.567861C419.241111 374.137368 512.680397 295.287873 624.795466 295.287873c18.375534 0 36.248477 2.12948 53.382222 6.132249l39.022512-93.152092c-36.248477-32.934321-49.896729-86.177842-30.174973-134.041367 25.204555-61.154415 95.338684-90.360108 156.651383-65.220824 61.319226 25.132756 90.596716 95.089021 65.398689 156.243437-19.504729 47.334826-65.92086 75.494544-114.326137 74.176062l-39.959157 95.382743c60.924334 41.018186 100.921022 110.062283 100.921022 188.324334 0 70.620402-32.565538 133.736223-83.686106 175.526243l46.409604 87.10796c48.521134-7.086843 98.455394 16.133461 123.065979 61.683114C972.95806 905.658773 951.145986 978.273217 892.790083 1009.647551L892.790083 1009.647551zM892.790083 1009.647551"></path></svg></span>');t.append(r),r.on("click",function(t){i.$graphContainer.modal("show"),i.loadGraph(n[i.options.idKey]),t.stopPropagation()})}else if("infobox"==a&&o.enable){var s=e('<span class="button" title="知识卡片" onfocus="this.blur();"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="12"><path d="M638.596211 191.936191q30.628116 0 54.62014 13.272183t41.347956 32.66999 26.544367 41.858425 9.188435 39.81655l0 576.829511q0 29.607178-11.740778 53.088734t-30.628116 39.81655-42.368893 25.52343-46.963111 9.188435l-503.322034 0q-19.397807 0-42.368893-11.230309t-42.879362-29.607178-33.180459-42.368893-13.272183-48.494516l0-568.662014q0-21.439681 10.209372-44.410768t26.544367-42.368893 37.774676-32.159521 44.921236-12.761715l515.57328 0zM578.360917 830.021934q26.544367 0 45.431705-18.376869t18.887338-44.921236-18.887338-45.431705-45.431705-18.887338l-382.851446 0q-26.544367 0-45.431705 18.887338t-18.887338 45.431705 18.887338 44.921236 45.431705 18.376869l382.851446 0zM578.360917 574.787637q26.544367 0 45.431705-18.376869t18.887338-44.921236-18.887338-45.431705-45.431705-18.887338l-382.851446 0q-26.544367 0-45.431705 18.887338t-18.887338 45.431705 18.887338 44.921236 45.431705 18.376869l382.851446 0zM759.0668 0q43.900299 0 80.654038 26.033898t63.808574 64.319043 42.368893 82.695912 15.314058 81.164506l0 542.117647q0 21.439681-12.761715 39.306082t-31.138584 30.628116-39.81655 20.418744-39.81655 7.657029l-4.083749 0 0-609.499501q-8.167498-70.444666-43.900299-108.219342t-94.947159-49.004985l-498.217348 0q1.020937-2.041874 1.020937-7.14656 0-20.418744 12.251246-41.858425t32.159521-38.795613 44.410768-28.586241 49.004985-11.230309l423.688933 0z"></path></svg></span>');t.append(s),s.tooltipster({side:["bottom"],theme:"tooltipster-shadow",distance:16,interactive:!0,trigger:"click",content:"Loading...",functionBefore:function(t,a){var o=e(a.origin);if(o.data("loaded")!==!0){var r=n[i.options.idKey];i.infoboxService.load(r,function(e){var n=i.infoboxService.buildInfobox(e);t.content(n),i.infoboxService.initEvent(n),o.data("loaded",!0)},function(){t.content("read data failed")})}}}),s.on("click",function(t){t.stopPropagation()})}else o instanceof Function&&o(t,n)}return!0},t.prototype.removeHoverDom=function(t,e){var n=this;if(e.level>0){var i=n.select("#button-container_"+e.tId);i.children().off("click"),i.remove()}},t.prototype.select=function(t){var n=this;return e(n.options.container).find(t)},t.prototype.updateZTreeSettings=function(){var t=this;return{async:{enable:!0,url:function(){return t.getAsyncUrl()},dataFilter:function(e,n,i){return t.dataFilter(e,n,i)},type:"get"},view:{showLine:!1,showIcon:!1,expandSpeed:"fast",dblClickExpand:function(t,e){return e.level>0},selectedMulti:!1,addHoverDom:function(e,n){t.addHoverDom(e,n)},removeHoverDom:function(e,n){t.removeHoverDom(e,n)}},callback:{beforeAsync:function(e,n){return t.beforeAsync(e,n)},onAsyncSuccess:function(e,n,i){return t.onAsyncSuccess(e,n,i)},onClick:function(e,n,i){return t.onClick(e,n,i)},onDblClick:function(){t.treeDbClick=!0}},data:{simpleData:{enable:!0,pIdKey:t.options.pIdKey,idKey:t.options.idKey},key:{name:t.options.nameKey}}}},t}t.HieknConceptTreeService=n()}(window,jQuery),function(){function t(){var t=function(){this.colorList={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}};return t.prototype.drawPromptItem=function(t){var e={};for(var n in t.types){var i=t.types[n];e[i.k]=i.v}return function(t,n){var i=t.name;t.meaningTag&&(i=i+" ( "+t.meaningTag+" )");var a='<span class="prompt-tip-title">'+i.replace(new RegExp("("+n+")","gi"),'<span class="highlight">$1</span>')+"</span>";return a='<span class="prompt-tip-type prompt-tip-'+t.classId+'">'+(t.className||e[t.classId]||"")+"</span>"+a}},t.prototype.drawPromptItems=function(t,e){var n={};for(var i in t.types){var a=t.types[i];n[a.k]=a.v}return function(t,n){var i=$("<div></div>");return t.forEach(function(t){var a=e.instance.options.drawPromptItem(t,n),o=e.instance.options.drawItemTitle(t),r="prompt-item-"+t.classId,s=$('<li title="'+o+'" class="'+r+'">'+a+"</li>").data("data",t),l=i.find("."+r);l.length?($(l[l.length-1]).after(s),s.find(".prompt-tip-type").empty()):i.append(s)}),i.children()}},t.prototype.onPromptStart=function(t){return function(e,n){var i=t.data||{},a=t.data2||{};a.kgName=t.kgName,a[t.paramName]=e,hieknjs.kgLoader({url:t.url+"?"+$.param(i),params:a,type:t.type,dataFilter:t.dataFilter||function(t){return t},success:function(i){if(n.prompt==a[t.paramName]){var o=i.rsData;t.beforeDrawPrompt&&(o=t.beforeDrawPrompt(o,e)),n.startDrawPromptItems(o,e)}}})}},t.prototype.onPrompt=function(t){var e=this;return t.paramName="kw",t.url=t.baseUrl+"prompt",t.type=1,e.onPromptStart(t)},t.prototype.onPromptKnowledge=function(t){var e=this;return t.paramName="text",t.url=t.baseUrl+"prompt/knowledge",t.type=0,e.onPromptStart(t)},t.prototype.beforeSearch=function(){return function(t,e){t&&e.find("input[type=text]").val(t.name)}},t.prototype.schema=function(t,e){var n=t.data||{},i=t.data2||{};i.kgName=t.kgName,hieknjs.kgLoader({url:t.baseUrl+"schema?"+$.param(n),type:1,dataFilter:t.dataFilter||function(t){return t},params:i,beforeSend:function(){t.that&&$(t.that).find(".ajax-loading").html('<div class="schema-init"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 14 32 18" width="32" height="4" preserveAspectRatio="none"><path opacity="0.8" transform="translate(0 0)" d="M2 14 V18 H6 V14z"><animateTransform attributeName="transform" type="translate" values="0 0; 24 0; 0 0" dur="2s" begin="0" repeatCount="indefinite" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" /></path><path opacity="0.5" transform="translate(0 0)" d="M0 14 V18 H8 V14z"><animateTransform attributeName="transform" type="translate" values="0 0; 24 0; 0 0" dur="2s" begin="0.1s" repeatCount="indefinite" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" /></path><path opacity="0.25" transform="translate(0 0)" d="M0 14 V18 H8 V14z"><animateTransform attributeName="transform" type="translate" values="0 0; 24 0; 0 0" dur="2s" begin="0.2s" repeatCount="indefinite" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" /></path></svg></div>')},success:function(t){if(t&&t.rsData&&t.rsData.length){var n=t.rsData[0];e(n)}},error:function(){toastr.error("网络接口错误！")},that:t.that})},t.prototype.segment=function(t,e){var n=t.data||{},i=t.data2||{};n.kgName=t.kgName,n.kw=t.kw,hieknjs.kgLoader({url:t.baseUrl+"segment?"+$.param(n),type:0,dataFilter:t.dataFilter||function(t){return t},params:i,success:function(t){if(t&&t.rsData&&t.rsData.length){var n=t.rsData;e(n)}},error:function(){toastr.error("网络接口错误！")},that:t.that})},t.prototype.disambiguate=function(t,e){var n=t.data||{},i=t.data2||{};n.kgName=t.kgName,n.kw=t.kw,hieknjs.kgLoader({url:t.baseUrl+"disambiguate?"+$.param(n),type:0,dataFilter:t.dataFilter||function(t){return t},params:i,success:function(t){if(t&&t.rsData&&t.rsData.length){var n=t.rsData;e(n)}},error:function(){toastr.error("网络接口错误！")},that:t.that})},t.prototype.tagging=function(t,e){var n=t.data||{},i=t.data2||{};n.kgName=t.kgName,n.kw=t.kw,hieknjs.kgLoader({url:t.baseUrl+"tagging?"+$.param(n),type:0,dataFilter:t.dataFilter||function(t){return t},params:i,success:function(t){if(t&&t.rsData&&t.rsData.length){var n=t.rsData;e(n)}},error:function(){toastr.error("网络接口错误！")},that:t.that})},t.prototype.association=function(t,e){var n=t.data||{},i=t.data2||{};i.kgName=t.kgName,i.id=t.id,i.allowAtts=t.allowAtts,i.pageSize=t.pageSize||6,hieknjs.kgLoader({url:t.baseUrl+"association?"+$.param(n),type:1,dataFilter:t.dataFilter||function(t){return t},params:i,success:function(t){if(t&&t.rsData&&t.rsData.length){var n=t.rsData;e(n)}},error:function(){toastr.error("网络接口错误！")},that:t.that})},t.prototype.gentInfobox=function(t){var e=this,n=t.data||{};n.isRelationAtts=!0,e.infoboxService=new HieknInfoboxService({baseUrl:t.baseUrl,kgName:t.kgName,imagePrefix:t.imagePrefix,data:n}),e.infoboxService.initEvent($(t.selector))},t.prototype.infobox=function(){var t=this;return function(e,n,i){return n.detail?i(n.detail):t.infoboxService.load(e.id,function(e){e=t.infoboxService.buildInfobox(e)[0].outerHTML,n.detail=e,i(e)}),null}},t.prototype.legend=function(t){var e={};for(var n in t.types){var i=t.types[n];e[i.k]=i.v}return function(t,n){return'<i style="background: '+n+'"></i><span title="'+e[t]+'">'+e[t]+"</span>"}},t.prototype.legendDraw=function(t,e,n){var i={};for(var a in t.types){var o=t.types[a];i[o.k]=o.v}return function(t,a){e.legendFilter={};var o=_.filter(e.tgc2.getAvailableData().nodes,function(t){return!t.hidden}),r=_.keys(_.groupBy(o,"classId"));if("fab"==n){var s=[];for(var l in t)if(_.indexOf(r,l)>=0){var d="",c=i[l];d=c.length>3?'<div title="'+c+'"><div>'+c.substring(0,2)+'</div><div class="line-hidden">'+c.substring(2)+"</div></div>":'<div class="line-hidden" title="'+c+'">'+c+"</div>",s.push({html:d,data:{key:l,value:t[l]},style:{background:t[l],color:"#fff"},events:{click:function(t){e.sdkUtils.legendClick(t,e)},mouseenter:function(t){e.sdkUtils.legendMouseEnter(t,e)},mouseleave:function(t){e.sdkUtils.legendMouseLeave(t,e)},dblclick:function(t){e.sdkUtils.legendDblClick(t,e)}}})}new hieknjs.fab({container:a,radius:80,angle:90,startAngle:90,initStatus:e.layoutStatus,main:{html:"图例",style:{background:e.primary||"#00b38a",
color:"#fff"},events:{click:function(){e.layoutStatus=!e.layoutStatus}}},items:s})}else{a.html("");for(var l in t)if(_.indexOf(r,l)>=0){var g=$('<div class="tgc2-legend-item tgc2-legend-item-'+l+'"></div>').data({key:l,value:t[l]}),d=g.html('<i style="background: '+t[l]+'"></i><span title="'+i[l]+'">'+i[l]+"</span>");a.append(d)}}}},t.prototype.legendClick=function(t,e){var n=$(t.currentTarget);n.toggleClass("off");var i=n.data("key");e.legendFilter[i]=n.hasClass("off"),e.tgc2.netChart.updateFilters()},t.prototype.legendDblClick=function(t,e){var n=$(t.currentTarget),i=n.removeClass("off").siblings();i.addClass("off");var a=n.data("key");e.legendFilter={},e.legendFilter[a]=!1;for(var o=0;o<i.length;o++){var r=$(i[o]).data("key");e.legendFilter[r]=!0}e.tgc2.netChart.updateFilters()},t.prototype.legendMouseEnter=function(t,e){var n=$(t.currentTarget);n.addClass("active").siblings().addClass("inactive"),e.nodeSettings.legendClass=n.data("key"),e.nodeSettings.legendColor=n.data("value"),e.tgc2.netChart.updateStyle()},t.prototype.legendMouseLeave=function(t,e){var n=$(t.currentTarget);n.removeClass("active inactive").siblings().removeClass("active inactive"),e.nodeSettings.legendClass=null,e.nodeSettings.legendColor=null,e.tgc2.netChart.updateStyle()},t.prototype.nodeFilter=function(t,e){return e.tgc2.inStart(t.id)||!e.legendFilter[t.classId]},t.prototype.qiniuImg=function(t){return t+"?_="+parseInt((new Date).getTime()/36e5)},t.prototype.nodeStyleFunction=function(t){var e=this;return t.enableAutoUpdateStyle&&setInterval(function(){if(e.centerNode){var n=t.tgc2.netChart.getNodeDimensions(e.centerNode).radius;if(e.nodeRadius!=n){var i=t.tgc2.netChart.nodes(),a=[];for(var o in i)a.push(i[o].id);t.tgc2.netChart.updateStyle(a)}}},30),function(n){t.tgc2.nodeStyleFunction(n),n.imageCropping="fit",!$.isEmptyObject(t.tgc2.nodeIds)||t.legendClass?t.tgc2.nodeIds[n.id]||t.legendClass==n.data.classId?n.radius=1.5*n.radius:(n.fillColor=t.tgc2.settings.netChart.reduceColor,n.label="",n.lineColor=n.fillColor,n.radius=.5*n.radius):t.tgc2.inStart(n.id)||(n.fillColor=n.data.color||"#fff",n.lineColor="#00b38a",n.hovered&&(n.fillColor=n.lineColor,n.shadowBlur=0)),t.nodeColors&&t.nodeColors[n.data.classId]&&(n.lineWidth=2,!$.isEmptyObject(t.tgc2.nodeIds)||t.legendClass?(t.tgc2.nodeIds[n.id]||t.legendClass==n.data.classId)&&(n.fillColor=t.legendColor||t.tgc2.settings.netChart.emphasesColor,n.lineColor=n.fillColor):t.tgc2.inStart(n.id)?(n.fillColor=t.tgc2.settings.netChart.emphasesColor,n.lineColor=n.fillColor):(n.lineColor=t.nodeColors[n.data.classId],t.imagePrefix||t.images||n.data.img||(n.fillColor=n.lineColor),n.hovered&&(n.fillColor=n.lineColor))),n.data.img?(0!=n.data.img.indexOf("http")&&t.imagePrefix?n.image=e.qiniuImg(t.imagePrefix+n.data.img):n.image=n.data.img,!$.isEmptyObject(t.tgc2.nodeIds)||t.legendClass?t.tgc2.nodeIds[n.id]||t.legendClass==n.data.classId||(n.image=""):t.tgc2.inStart(n.id)||n.hovered||(n.image=""),n.fillColor="#fff"):t.images&&t.images[n.data.classId]&&(!$.isEmptyObject(t.tgc2.nodeIds)||t.legendClass?t.tgc2.nodeIds[n.id]||t.legendClass==n.data.classId?n.image=t.legendColor||t.images[n.data.classId].emphases:n.image="":t.tgc2.inStart(n.id)||n.hovered?n.image=t.images[n.data.classId].emphases:n.image=t.images[n.data.classId].normal);var i=t.tgc2.netChart.getNodeDimensions(n).radius;t.enableAutoUpdateStyle&&(i<t.minRadius&&(n.image="",n.fillColor=n.lineColor),t.tgc2.inStart(n.id)&&(e.nodeRadius=i,!e.centerNode&&(e.centerNode=n))),t.textColors&&t.textColors[n.data.classId]&&("string"==typeof t.textColors[n.data.classId]?n.labelStyle.textStyle.fillColor=t.textColors[n.data.classId]:t.tgc2.inStart(n.id)||t.tgc2.nodeIds[n.id]?n.labelStyle.textStyle.fillColor=t.textColors[n.data.classId].emphases:n.hovered?n.labelStyle.textStyle.fillColor=t.textColors[n.data.classId].emphases:n.labelStyle.textStyle.fillColor=t.textColors[n.data.classId].normal);var a=n.label.length;if("roundtext"==n.display){for(var o=n.label,r=1;r<o.length-1;r++){var s=/^[\u4e00-\u9fa5]$/,l=/^[a-zA-Z]$/,d=o.charAt(r),c=o.charAt(r+1);(s.test(d)&&l.test(c)||l.test(d)&&s.test(c))&&(o=o.substring(0,r+1)+" "+o.substring(r+1),r++)}if(n.label=o,n.label.indexOf(" ")<0&&a>5)if(a>9){var g=Math.floor(n.label.length/3),p=a-g;n.label=n.label.substring(0,g)+" "+n.label.substring(g,p)+" "+n.label.substring(p)}else a>5&&(n.label=n.label.substring(0,4)+" "+n.label.substring(4))}}},t.prototype.colorFade=function(t,e){try{var n=[];return this.colorList[t]&&(t=this.colorList[t]),0==t.indexOf("rgb")||0==t.indexOf("hsl")?n=t.substring(t.indexOf("(")+1,t.indexOf(")")).split(","):0==t.indexOf("#")&&(t=t.substring(1),n=t.match(/.{2}/g).map(function(t){return parseInt(t,16)})),n[3]=parseInt((n[3]||1)*e*100)/100,0==t.indexOf("hsl")?"hsla("+n[0]+","+n[1]+","+n[2]+","+n[3]+")":"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"}catch(i){return t}},t.prototype.buildFilter=function(t,e){var n=[],i=[],a=[],o=[];for(var r in t.atts){var s=t.atts[r];1==s.type&&(n.push({value:s.k,label:s.v}),i.push(s.k))}for(var l in t.types){var d=t.types[l];a.push({value:d.k,label:d.v}),o.push(d.k)}return i=e.selectedAtts||i,o=e.selectedTypes||o,[{key:"allowTypes",label:"设定分析主体",selected:o,options:a},{key:"allowAtts",label:"设定分析关系",selected:i,options:n}]},t.prototype.dealGraphData=function(t,e){t.nodes=t.entityList,t.links=t.relationList,delete t.entityList,delete t.relationList;var n={},i=_.concat(e.types,e.atts);for(var a in i){var o=i[a];n[o.k]=o.v}for(var r in t.nodes){var s=t.nodes[r];s.typeName=n[s.classId]}for(var l in t.links){var d=t.links[l];d.typeName=n[d.attId]}return t},t.prototype.linkContentsFunction=function(t){if(t.rInfo=$.extend(!0,[],t.nRInfo||[],t.oRInfo||[]),t.rInfo){var e="";for(var n in t.rInfo){var i=t.rInfo[n];e+="<tr>";var a=i.kvs,o="<tr>",r="<tr>";for(var s in a)a.hasOwnProperty(s)&&(o+='<th><div class="link-info-key">'+a[s].k+"</div></th>",r+='<td><div class="link-info-value">'+a[s].v+"</div></td>");e+="<li><table><thead>"+o+"</thead><tbody>"+r+"</tbody></table></li>"}return'<ul class="link-info">'+e+"</ul>"}return t.typeName},t.prototype.graph=function(t,e){var n=this;return function(i,a,o){var r=t.data||{},s=t.data2||{};if(s.kgName=t.kgName,s.id=t.tgc2.startInfo.id,s.isRelationMerge=!0,t.tgc2Filter){var l=t.tgc2Filter.getFilterOptions();$.extend(!0,s,l)}if(t.tgc2Page){var d=t.tgc2Page.page;s.pageNo=d.pageNo,s.pageSize=d.pageSize}hieknjs.kgLoader({url:t.baseUrl+"graph?"+$.param(r),type:1,dataFilter:t.dataFilter||function(t){return t},params:s,success:function(t){if(t&&t.rsData&&t.rsData.length){var i=t.rsData[0];i&&(i=n.dealGraphData(i,e)),a(i)}else o()},error:function(){o()},that:$(t.selector).find(".tgc2-netchart-container")[0]})}},t.prototype.graphInit=function(t){var e=t.data||{},n=t.data2||{};n.kgName=t.kgName,n.isTiming=t.isTiming,hieknjs.kgLoader({url:t.baseUrl+"graph/init?"+$.param(e),type:1,dataFilter:t.dataFilter||function(t){return t},params:n,success:function(e){if(e&&e.rsData&&e.rsData.length){var n=e.rsData[0];t.success(n)}else t.failed()},error:function(){t.failed()},that:t.that})},t.prototype.timing=function(t,e){var n=this;return function(i,a,o){var r=t.data||{},s=t.data2||{};if(s.kgName=t.kgName,s.id=t.tgc2.startInfo.id,s.isRelationMerge=!0,t.tgc2Filter){var l=t.tgc2Filter.getFilterOptions();$.extend(!0,s,l)}if(t.tgc2TimeChart){var d=t.tgc2TimeChart.getSettings();delete d.type,$.extend(!0,s,d)}hieknjs.kgLoader({url:t.baseUrl+"graph/timing?"+$.param(r),type:1,dataFilter:t.dataFilter||function(t){return t},params:s,success:function(t){if(t&&t.rsData&&t.rsData.length){var i=t.rsData[0];i&&(i=n.dealGraphData(i,e)),a(i)}else o()},error:function(){o()},that:$(t.selector).find(".tgc2-netchart-container")[0]})}},t.prototype.relation=function(t,e){var n=this;return function(i,a,o){var r=_.map(t.tgc2.startInfo.nodes,"id"),s=t.data||{},l=t.data2||{};if(l.kgName=t.kgName,l.ids=r,l.isShortest=!0,l.connectsCompute=!0,l.statsCompute=!0,t.tgc2Stats&&(l.statsConfig=t.tgc2Stats.getStatsConfig()),t.tgc2Filter){var d=t.tgc2Filter.getFilterOptions();$.extend(!0,l,d)}hieknjs.kgLoader({url:t.baseUrl+"relation?"+$.param(s),type:1,dataFilter:t.dataFilter||function(t){return t},params:l,success:function(t){if(t&&t.rsData&&t.rsData.length){var i=t.rsData[0];i&&(i=n.dealGraphData(i,e)),a(i)}else o()},error:function(){toastr.error("网络接口错误！"),o()},that:$(t.selector).find(".tgc2-netchart-container")[0]})}},t.prototype.path=function(t,e){var n=this;return function(i,a,o){var r=t.data||{},s=t.data2||{};if(s.kgName=t.kgName,s.start=t.tgc2.startInfo.start.id,s.end=t.tgc2.startInfo.end.id,s.isShortest=!0,s.connectsCompute=!0,s.statsCompute=!0,t.tgc2Stats&&(s.statsConfig=t.tgc2Stats.getStatsConfig()),t.tgc2Filter){var l=t.tgc2Filter.getFilterOptions();$.extend(!0,s,l)}hieknjs.kgLoader({url:t.baseUrl+"path?"+$.param(r),type:1,dataFilter:t.dataFilter||function(t){return t},params:s,success:function(t){if(t&&t.rsData&&t.rsData.length){var i=t.rsData[0];i&&(i=n.dealGraphData(i,e)),a(i)}else o()},error:function(){toastr.error("网络接口错误！"),o()},that:$(t.selector).find(".tgc2-netchart-container")[0]})}},t}window.HieknSDKService=t()}(),function(t,e){"use strict";function n(){var n=function(n){var i=this;i.isInit=!1,i.baseSettings={baseUrl:n.baseUrl,data:n.data,kgName:n.kgName},i.filterSettings={selectedAtts:n.selectedAtts,selectedTypes:n.selectedTypes},i.infoboxSettings={dataFilter:n.dataFilter,selector:n.selector,imagePrefix:n.imagePrefix},e.extend(!0,i.infoboxSettings,i.baseSettings),i.loaderSettings={dataFilter:n.dataFilter,selector:n.selector,tgc2:null,tgc2Filter:null,tgc2Page:null},e.extend(!0,i.loaderSettings,i.baseSettings),i.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof n.enableAutoUpdateStyle||n.enableAutoUpdateStyle,imagePrefix:n.imagePrefix,images:n.images,nodeColors:n.nodeColors,textColors:n.textColors,minRadius:n.minRadius||10,legendClass:null,legendColor:null,tgc2:null},i.promptSettings=i.baseSettings,i.schemaSettings={dataFilter:n.dataFilter,that:e(n.selector)[0]},e.extend(!0,i.schemaSettings,i.baseSettings),i.initSettings={dataFilter:n.dataFilter,that:e(n.selector)[0],isTiming:!1,success:function(t){t.entityList&&t.entityList.length&&i.load(t.entityList[0])},failed:e.noop},e.extend(!0,i.initSettings,i.baseSettings),i.tgc2Settings={},i.legendFilter={},i.layoutStatus=n.layoutStatus,i.sdkUtils=new t.HieknSDKService,i.sdkUtils.schema(i.schemaSettings,function(t){var a=i.sdkUtils.buildFilter(t,i.filterSettings);a=[{key:"distance",label:"设定显示层数",selected:n.selectedDistance||1,options:[1,2,3]}].concat(a);var o={selector:n.selector,prompt:{enable:!0,settings:{drawPromptItem:i.sdkUtils.drawPromptItem(t),onPrompt:i.sdkUtils.onPrompt(i.promptSettings)}},page:{enable:!0,pageSize:20},filter:{enable:!0,filters:a},crumb:{enable:!0},find:{enable:!0},legend:{enable:!0,data:n.nodeColors||[],legendDraw:i.sdkUtils.legendDraw(t,i,n.legendType),onClick:function(t){i.sdkUtils.legendClick(t,i)},onDblclick:function(t){i.sdkUtils.legendDblClick(t,i)},onMouseEnter:function(t){i.sdkUtils.legendMouseEnter(t,i)},onMouseLeave:function(t){i.sdkUtils.legendMouseLeave(t,i)}},netChart:{settings:{filters:{nodeFilter:function(t){return i.sdkUtils.nodeFilter(t,i)}},nodeMenu:{contentsFunction:i.sdkUtils.infobox()},style:{node:{display:n.display||"circle"},nodeStyleFunction:i.sdkUtils.nodeStyleFunction(i.nodeSettings)},info:{linkContentsFunction:i.sdkUtils.linkContentsFunction}}},loader:i.sdkUtils.graph(i.loaderSettings,t)};i.tgc2Settings=e.extend(!0,{},o,n.tgc2Settings),i.sdkUtils.gentInfobox(i.infoboxSettings),i.init(),n.startInfo&&i.load(n.startInfo)})};return n.prototype.init=function(){var t=this;t.tgc2=new Tgc2Graph(t.tgc2Settings),t.tgc2Filter=new Tgc2Filter(t.tgc2,t.tgc2Settings.filter),t.tgc2Prompt=new Tgc2Prompt(t.tgc2,t.tgc2Settings.prompt),t.tgc2Page=new Tgc2Page(t.tgc2,t.tgc2Settings.page),t.tgc2Crumb=new Tgc2Crumb(t.tgc2,t.tgc2Settings.crumb),t.tgc2Find=new Tgc2Find(t.tgc2,t.tgc2Settings.find),t.tgc2Legend=new Tgc2Legend(t.tgc2,t.tgc2Settings.legend),t.loaderSettings.tgc2=t.tgc2,t.loaderSettings.tgc2Filter=t.tgc2Filter,t.loaderSettings.tgc2Page=t.tgc2Page,t.nodeSettings.tgc2=t.tgc2,t.tgc2.init(),t.isInit=!0},n.prototype.load=function(t){var e=this;setTimeout(function(){e.isInit?t?e.tgc2.load(t):e.sdkUtils.graphInit(e.initSettings):e.load(t)},30)},n}t.HieknGraphService=n()}(window,jQuery),function(t,e){"use strict";function n(){var t=function(t){var n=this,i={atts:{visible:[],hidden:[]},selector:null,data:null,baseUrl:null,kgName:null,enableLink:!1,autoLen:!0,imagePrefix:null,onLoad:e.noop,href:null};n.options=e.extend(!0,{},i,t)};return t.prototype.href=function(t){var e=this;e.load(t,e.callback)},t.prototype.initEvent=function(t){var n=this;t.on("click",".hiekn-infobox-link",function(){var t=e(this).attr("data-id");n.options.href?n.options.href(t,n):n.href(t)}),t.on("click",".hiekn-infobox-info-detail a",function(){e(this).closest(".hiekn-infobox-info-detail").toggleClass("on")})},t.prototype.buildEntity=function(t,e){var n=this,i=t.meaningTag?"("+t.meaningTag+")":"",a='<span class="hiekn-infobox-name">'+t.name+'<span class="hiekn-infobox-meaningTag">'+i+"</span></span>";return e&&n.options.enableLink?'<a href="javascript:void(0)" class="hiekn-infobox-link" data-id="'+t.id+'">'+a+"</a>":a},t.prototype.buildExtra=function(t){var e=this,n=t.v||"-";if(e.options.autoLen){var i="number"==typeof e.options.autoLen?e.options.autoLen:80;t.v.length>i&&(n='<span class="hiekn-infobox-info-detail-short">'+t.v.substring(0,i)+'<a href="javascript:void(0)">查看全部&gt;&gt;</a></span><span class="hiekn-infobox-info-detail-long">'+t.v+'<a href="javascript:void(0)">收起&lt;&lt;</a></span>')}return'<tr><td class="hiekn-infobox-info-label">'+t.k+'</td><td class="hiekn-infobox-info-detail">'+n+"</td></tr>"},t.prototype.load=function(t,n,i){var a=this,o=a.options.data||{},r=a.options.data2||{};r.kgName=a.options.kgName,r.id=t,hieknjs.kgLoader({url:a.options.baseUrl+"infobox?"+e.param(o),type:1,params:r,dataFilter:a.options.dataFilter||function(t){return t},success:function(t){if(t&&t.rsData&&t.rsData.length){var o=t.rsData[0];if(n)a.callback=n,n(o);else if(a.options.selector){var r=a.buildInfobox(o);e(a.options.selector).html(r),a.initEvent(r)}else console.error("selector or callback must be config");a.options.onLoad(o)}else i&&i()},error:function(){toastr.error("网络接口错误！"),i&&i()}})},t.prototype.buildInfobox=function(t){var n=this,i=e('<div class="hiekn-infobox"></div>');if(t.self){i.append('<div class="hiekn-infobox-head"></div><div class="hiekn-infobox-body"></div>');var a=n.buildEntity(t.self,!1);if(i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-title">'+a+"</div>"),t.self.img){var o=t.self.img;0!=t.self.img.indexOf("http")&&(o=n.options.imagePrefix+t.self.img+"?_="+Math.round(new Date/36e5)),i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-img"><img src="'+o+'" alt=""></div>')}if(t.self.extra){var r="",s=n.options.atts.visible||[],l=n.options.atts.hidden||[];for(var d in t.self.extra){var c=t.self.extra[d];s.length&&_.indexOf(s,c.k)>=0?r+=n.buildExtra(c):l.length&&_.indexOf(l,c.k)<0?r+=n.buildExtra(c):s.length||l.length||(r+=n.buildExtra(c))}if(t.atts)for(var g in t.atts)if(t.atts.hasOwnProperty(g)){var p=t.atts[g],f="";for(var u in p.v){var h=p.v[u],a=n.buildEntity(h,!0);f+="<li>"+a+"</li>"}s.length&&_.indexOf(s,p.k)>=0?r+='<tr><td class="hiekn-infobox-info-label">'+p.k+'</td><td class="hiekn-infobox-info-detail">'+f+"</td></tr>":l.length&&_.indexOf(l,p.k)<0?r+='<tr><td class="hiekn-infobox-info-label">'+p.k+'</td><td class="hiekn-infobox-info-detail">'+f+"</td></tr>":s.length||l.length||(r+='<tr><td class="hiekn-infobox-info-label">'+p.k+'</td><td class="hiekn-infobox-info-detail">'+f+"</td></tr>")}i.find(".hiekn-infobox-body").append("<table><tbody>"+r+"</tbody></table>")}if(t.pars){i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">所属：</label><ul></ul></div>');for(var b in t.pars){var h=t.pars[b],a=n.buildEntity(h,!0);i.find(".hiekn-infobox-pars ul").append("<li>"+a+"</li>")}}if(t.sons){var r="";for(var m in t.sons){var h=t.sons[m],a=n.buildEntity(h,!0);r+="<li>"+a+"</li>"}i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">相关：</label><ul>'+r+"</ul></div>")}}else i.append("InfoBox读取错误");return i},t.prototype.buildTabInfobox=function(t){var n=this,i=e('<div class="hiekn-infobox hiekn-infobox-tab"></div>');if(t.self){i.append('<div class="hiekn-infobox-head"></div><div class="hiekn-infobox-body"><ul class="nav nav-tabs" role="tablist"></ul><div class="tab-content"></div></div>');var a=n.buildEntity(t.self,!1);if(i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-title">'+a+"</div>"),t.self.extra){var o="";for(var r in t.self.extra){var s=t.self.extra[r];o+=n.buildExtra(s)}var l="hiekn-infobox-"+(new Date).getTime()+"-"+t.self.id;i.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation" class="active"><a href="#'+l+'" role="tab" data-toggle="tab" aria-expanded="true">基本信息</a></li>'),i.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-detail tab-pane active" id="'+l+'"><table><tbody>'+o+"</tbody></table></div>")}if(t.pars){i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">所属：</label><ul></ul></div>');for(var d in t.pars){var c=t.pars[d],a=n.buildEntity(c,!0);i.find(".hiekn-infobox-pars ul").append("<li>"+a+"</li>")}}if(t.sons){var o="";for(var g in t.sons){var c=t.sons[g],a=n.buildEntity(c,!0);o+="<li>"+a+"</li>"}var l="hiekn-infobox-"+(new Date).getTime()+"-sons-"+t.self.id;i.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation"><a href="#'+l+'" role="tab" data-toggle="tab" aria-expanded="true">子节点</a></li>'),i.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-sons tab-pane" id="'+l+'"><ul>'+o+"</ul></div>")}if(t.atts)for(var p in t.atts)if(t.atts.hasOwnProperty(p)){var f=t.atts[p],o="";for(var u in f.v){var c=f.v[u],a=n.buildEntity(c,!0);o+="<li>"+a+"</li>"}var l="hiekn-infobox-"+(new Date).getTime()+"-att-"+p+"-"+t.self.id;i.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation"><a href="#'+l+'" role="tab" data-toggle="tab" aria-expanded="true">'+f.k+"</a></li>"),i.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-sons tab-pane" id="'+l+'"><ul>'+o+"</ul></div>")}}else i.append("InfoBox读取错误");return i},t}t.HieknInfoboxService=n()}(window,jQuery),function(t,e){"use strict";function n(){var n=function(n){var i=this;i.isInit=!1,i.baseSettings={baseUrl:n.baseUrl,data:n.data,kgName:n.kgName},i.filterSettings={selectedAtts:n.selectedAtts,selectedTypes:n.selectedTypes},i.infoboxSettings={dataFilter:n.dataFilter,selector:n.selector,imagePrefix:n.imagePrefix},e.extend(!0,i.infoboxSettings,i.baseSettings),i.loaderSettings={dataFilter:n.dataFilter,selector:n.selector,tgc2:null,tgc2Filter:null,tgc2Page:null,tgc2Stats:null},e.extend(!0,i.loaderSettings,i.baseSettings),i.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof n.enableAutoUpdateStyle||n.enableAutoUpdateStyle,imagePrefix:n.imagePrefix,images:n.images,nodeColors:n.nodeColors,minRadius:n.minRadius||10,tgc2:null},i.promptSettings=i.baseSettings,i.schemaSettings={dataFilter:n.dataFilter,that:e(n.selector)[0]},e.extend(!0,i.schemaSettings,i.baseSettings),i.tgc2Settings={},i.sdkUtils=new t.HieknSDKService,i.sdkUtils.schema(i.schemaSettings,function(t){var a=i.sdkUtils.buildFilter(t,i.filterSettings);a=[{key:"distance",label:"设定分析步长",selected:n.selectedDistance||3,options:[3,4,5,6]}].concat(a);var o={selector:n.selector,netChart:{settings:{nodeMenu:{contentsFunction:i.sdkUtils.infobox()},style:{nodeStyleFunction:i.sdkUtils.nodeStyleFunction(i.nodeSettings)},info:{linkContentsFunction:i.sdkUtils.linkContentsFunction}}},filter:{enable:!0,filters:a},stats:{enable:!0,editable:!0,atts:t.atts,types:t.types,statsConfig:n.statsConfig},connects:{enable:!0,mode:"click"},crumb:{enable:!0},find:{enable:!0},legend:{enable:!1},loader:i.sdkUtils.path(i.loaderSettings,t),schema:t,path:{prompt:{settings:{drawPromptItem:i.sdkUtils.drawPromptItem(t),onPrompt:i.sdkUtils.onPrompt(i.promptSettings)}}}};i.tgc2Settings=e.extend(!0,{},o,n.tgc2Settings),i.sdkUtils.gentInfobox(i.infoboxSettings),i.init(),n.startInfo&&i.load(n.startInfo)})};return n.prototype.init=function(){var t=this;t.tgc2=new Tgc2Path(t.tgc2Settings),t.tgc2Filter=new Tgc2Filter(t.tgc2,t.tgc2Settings.filter),t.tgc2Stats=new Tgc2Stats(t.tgc2,t.tgc2Settings.stats),t.tgc2Connects=new Tgc2Connects(t.tgc2,t.tgc2Settings.connects),t.tgc2Crumb=new Tgc2Crumb(t.tgc2,t.tgc2Settings.crumb),t.tgc2Find=new Tgc2Find(t.tgc2,t.tgc2Settings.find),t.tgc2Legend=new Tgc2Legend(t.tgc2,t.tgc2Settings.legend),t.loaderSettings.tgc2=t.tgc2,t.loaderSettings.tgc2Filter=t.tgc2Filter,t.loaderSettings.tgc2Page=t.tgc2Page,t.loaderSettings.tgc2Stats=t.tgc2Stats,t.nodeSettings.tgc2=t.tgc2,t.tgc2.init(),t.isInit=!0},n.prototype.load=function(t){var e=this;setTimeout(function(){e.isInit?e.tgc2.load(t):e.load(t)},30)},n}t.HieknPathService=n()}(window,jQuery),function(t,e){"use strict";function n(){var t=function(t){var n=this,i={beforeDrawPrompt:null,container:null,data:null,baseUrl:null,kgName:null,ready:e.noop,group:!1,replaceSearch:!1,onSearch:e.noop};n.options=e.extend(!0,{},i,t),n.init()};return t.prototype.init=function(){var t=this,n=new HieknSDKService(t.options);n.schema(t.options,function(i){var a={drawPromptItem:n.drawPromptItem(i),onPrompt:n.onPrompt(t.options)};t.options.group&&(a.drawPromptItems=n.drawPromptItems(i,t)),t.options.replaceSearch&&(a.beforeSearch=n.beforeSearch()),e.extend(!0,a,t.options),t.instance=new hieknPrompt(a),t.options.ready(t.instance)})},t}t.HieknPromptService=n()}(window,jQuery),function(t,e){"use strict";function n(){var n=function(n){var i=this;i.isInit=!1,i.baseSettings={baseUrl:n.baseUrl,data:n.data,kgName:n.kgName},i.filterSettings={selectedAtts:n.selectedAtts,selectedTypes:n.selectedTypes},i.infoboxSettings={dataFilter:n.dataFilter,selector:n.selector,imagePrefix:n.imagePrefix},e.extend(!0,i.infoboxSettings,i.baseSettings),i.loaderSettings={dataFilter:n.dataFilter,selector:n.selector,tgc2:null,tgc2Filter:null,tgc2Page:null,tgc2Stats:null},e.extend(!0,i.loaderSettings,i.baseSettings),i.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof n.enableAutoUpdateStyle||n.enableAutoUpdateStyle,imagePrefix:n.imagePrefix,images:n.images,nodeColors:n.nodeColors,minRadius:n.minRadius||10,tgc2:null},i.promptSettings=i.baseSettings,i.schemaSettings={dataFilter:n.dataFilter,that:e(n.selector)[0]},e.extend(!0,i.schemaSettings,i.baseSettings),i.tgc2Settings={},i.sdkUtils=new t.HieknSDKService,i.sdkUtils.schema(i.schemaSettings,function(t){var a=i.sdkUtils.buildFilter(t,i.filterSettings);a=[{key:"distance",label:"设定分析步长",selected:n.selectedDistance||3,options:[3,4,5,6]}].concat(a);var o={selector:n.selector,netChart:{settings:{nodeMenu:{contentsFunction:i.sdkUtils.infobox()},style:{nodeStyleFunction:i.sdkUtils.nodeStyleFunction(i.nodeSettings)},info:{linkContentsFunction:i.sdkUtils.linkContentsFunction}}},filter:{enable:!0,filters:a},stats:{enable:!0,editable:!0,atts:t.atts,types:t.types,statsConfig:n.statsConfig},connects:{enable:!0,mode:"click"},crumb:{enable:!0},find:{enable:!0},legend:{enable:!1},loader:i.sdkUtils.relation(i.loaderSettings,t),schema:t,relation:{prompt:{settings:{drawPromptItem:i.sdkUtils.drawPromptItem(t),onPrompt:i.sdkUtils.onPrompt(i.promptSettings)}}}};i.tgc2Settings=e.extend(!0,{},o,n.tgc2Settings),i.sdkUtils.gentInfobox(i.infoboxSettings),i.init(),n.startInfo&&i.load(n.startInfo)})};return n.prototype.init=function(){var t=this;t.tgc2=new Tgc2Relation(t.tgc2Settings),t.tgc2Filter=new Tgc2Filter(t.tgc2,t.tgc2Settings.filter),t.tgc2Stats=new Tgc2Stats(t.tgc2,t.tgc2Settings.stats),t.tgc2Connects=new Tgc2Connects(t.tgc2,t.tgc2Settings.connects),t.tgc2Crumb=new Tgc2Crumb(t.tgc2,t.tgc2Settings.crumb),t.tgc2Find=new Tgc2Find(t.tgc2,t.tgc2Settings.find),t.tgc2Legend=new Tgc2Legend(t.tgc2,t.tgc2Settings.legend),t.loaderSettings.tgc2=t.tgc2,t.loaderSettings.tgc2Filter=t.tgc2Filter,t.loaderSettings.tgc2Page=t.tgc2Page,t.loaderSettings.tgc2Stats=t.tgc2Stats,t.nodeSettings.tgc2=t.tgc2,t.tgc2.init(),t.isInit=!0},n.prototype.load=function(t){var e=this;setTimeout(function(){e.isInit?e.tgc2.load(t):e.load(t)},30)},n}t.HieknRelationService=n()}(window,jQuery),function(t,e){"use strict";function n(){var t=function(t){var n=this,i={baseUrl:null,beforeLoad:e.noop,container:null,config:{},data:null,onLoad:e.noop};n.options=e.extend(!0,{},i,t),n.init()};return t.prototype.getQuery=function(){var t=this,e=[],n=t.tableService.getFilterOptions();for(var i in n){var a=[],o=n[i],r=_.find(t.options.config.filter,["key",i]);if("year"==r.type||"month"==r.type)for(var s in o){var l=o[s],d="",c="";"year"==r.type?(d=moment(l+"-01-01").format(r.format||"YYYY-MM-DD"),c=moment(parseInt(l,10)+1+"-01-01").format(r.format||"YYYY-MM-DD")):(d=moment(l+"-01").format(r.format||"YYYY-MM"),c=moment(parseInt(l,10)+1+"-01").format(r.format||"YYYY-MM"));var g={};g[i]={from:d,to:c,include_lower:!0,include_upper:!1};var p={range:g};a.push(p)}else{var g={};g[i]=o;var f={terms:g};a.push(f)}e.push({bool:{should:a,minimum_should_match:1}})}var u=t.tableService.getFilterKw();if(u){var a=[],h=t.options.config.fieldsKw||t.options.config.fieldsTable||t.options.config.fields,g={};g.query=u,g.fields=h;var f={query_string:g};a.push(f),e.push({bool:{should:a,minimum_should_match:1}})}return{bool:{must:e}}},t.prototype.init=function(){var t=this,e={config:t.options.config,container:t.options.container,load:function(e,n){t.load(e,n)}};t.tableService=new HieknTableService(e)},t.prototype.loadData=function(t){var e=this;e.tableService.loadData(t)},t.prototype.load=function(t,n){var i=this;i.query=i.getQuery(),i.options.beforeLoad(i);var a=i.options.config,o=i.options.data||{},r=i.options.data2||{};r.databases=a.databases,r.tables=a.tables,r.fields=a.fields,r.query=JSON.stringify(i.query),r.pageNo=t,r.pageSize=r.pageSize||15;var s=n.getTableContainer();s.empty(),hieknjs.kgLoader({url:i.options.baseUrl+"search?"+e.param(o),type:1,params:r,dataFilter:i.options.dataFilter||function(t){return t},success:function(t,e,a,o){t?(n.drawPage(t.rsCount,o.pageNo,o.pageSize),n.drawData(t.rsData)):n.drawPage(0,o.pageNo,o.pageSize),i.options.onLoad(t,i)},that:s[0]})},t}t.HieknResourceService=n()}(window,jQuery),function(t,e){"use strict";function n(){var n=function(t){var n=this,i={baseUrl:null,beforeLoad:e.noop,container:null,configs:[],data:null,namespace:"hiekn-resource",onLoad:e.noop};n.options=e.extend(!0,{},i,t),n.resourcesService=[],n.init()};return n.prototype.init=function(){var t=this;t.$container=e(t.options.container),t.$headContainer=e('<div class="hiekn-resource-nav-container"><ul class="hiekn-resource-nav nav nav-tabs" role="tablist"></ul><div class="hiekn-resource-nav-more hide">更多</div><div class="hiekn-resource-nav-more-container hide"><ul class="hiekn-resource-nav-hide-tabs"></ul></div></div>'),t.$bodyContainer=e('<div class="hiekn-resource-container tab-content"></div>'),t.$container.append(t.$headContainer),t.$container.append(t.$bodyContainer);var n=t.select(".hiekn-resource-nav-container ul.hiekn-resource-nav"),i=t.select(".hiekn-resource-nav-container ul.hiekn-resource-nav-hide-tabs"),a=0;for(var o in t.options.configs){var r=0==o?"active":"",s=t.options.namespace+"-tab-"+o+"-"+(new Date).getTime(),l=e('<div role="tabpanel" class="tab-pane '+r+'" id="'+s+'"></div>');t.$bodyContainer.append(l);var d=e.extend(!0,{},t.options);d.config=t.options.configs[o],d.container=l,d.onLoad=function(e,n){var i=n.tableService.$container.attr("id");t.$headContainer.find('a[href="#'+i+'"] .res-count').text(e.rsCount||0),t.options.onLoad(e,n)},delete d.configs,t.resourcesService.push(new HieknResourceService(d));var c='<li role="presentation" class="'+r+'"><a href="#'+s+'" aria-controls="" role="tab" data-toggle="tab"><span class="res-name" title="'+d.config.name+'">'+d.config.name+'</span><span class="res-count"></span></a></li>';n.append(c),i.append(c),a+=n.find("li:last-child").width()}n.css("width",a),t.updateTabVisibility(),t.bindEvent()},n.prototype.bindEvent=function(){var n=this;n.$headContainer.find(".hiekn-resource-nav-more").on("click",function(){n.$headContainer.find(".hiekn-resource-nav-more-container").toggleClass("hide")}),n.$headContainer.on("shown.bs.tab",'a[data-toggle="tab"]',function(){var t=e(this).attr("href");n.$headContainer.find('.hiekn-resource-nav a[href="'+t+'"]').parent().addClass("active").siblings().removeClass("active"),n.$headContainer.find('.hiekn-resource-nav-hide-tabs a[href="'+t+'"]').parent().addClass("active").siblings().removeClass("active")}),e("body").on("click",function(t){e(t.target).closest(".hiekn-resource-nav-more-container,.hiekn-resource-nav-more").length||n.$headContainer.find(".hiekn-resource-nav-more-container").addClass("hide")}),e(t).on("resize",function(){n.updateTabVisibility()})},n.prototype.loadData=function(t){var e=this;for(var n in e.resourcesService)e.resourcesService[n].loadData(t)},n.prototype.select=function(t){var e=this;return e.$container.find(t)},n.prototype.updateTabVisibility=function(){var t=this,n=t.$headContainer,i=n.width(),a=n.find(".nav"),o=a.width(),r=n.find(".hiekn-resource-nav-more");i<o?r.removeClass("hide"):(r.addClass("hide"),n.find(".hiekn-resource-nav-more-container").addClass("hide"));var s=0,l=r.outerWidth(),d=n.find(".hiekn-resource-nav-hide-tabs>li");a.find("li").each(function(t,n){e(n).removeClass("hide"),s+=e(n).width(),s>=i-l?(e(n).addClass("hide"),e(d.get(t)).removeClass("hide")):e(d.get(t)).addClass("hide")})},n}t.HieknResourcesService=n()}(window,jQuery),function(t,e){"use strict";function n(){var n=function(t){var n=this,i={container:null,beforeLoad:null,data:null,config:{},baseUrl:null,kgName:null,chartColor:["#66d1b9","#f0cb69","#88bbf5","#e99592"]};n.options=e.extend(!0,{},i,t),n.init()};return n.prototype.init=function(){var t=this;t.$container=e(t.options.container),t.bindEvent()},n.prototype.bindEvent=function(){var n=this;e(t).on("resize",function(){n.chart&&n.chart.resize()})},n.prototype.drawChart=function(){var t=this;switch(t.options.config.type){case"bar":t.drawLineBarChart("bar");break;case"line":t.drawLineBarChart("line");break;case"pie":t.drawPieChart();break;case"wordCloud":t.drawWordCloudChart()}},n.prototype.drawPieChart=function(){var t=this,n=t.stat,i=t.options.config,a=[];for(var o in n.series){var r=n.series[o];i.seriesName&&(r.name=i.seriesName[r.name]||r.name,a.push(r.name))}var s={name:"",type:"pie",radius:"75%",center:["50%","50%"],data:n.series,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},l={};l=i.chartSettings&&i.chartSettings.series?e.extend(!0,{},s,i.chartSettings.series):s,t.chart=echarts.init(t.$container[0]);var d={color:t.options.chartColor,tooltip:{trigger:"item",formatter:"{b} <br/>{c} ({d}%)"},legend:{orient:"vertical",x:"left",data:a}},c={};c=i.chartSettings?e.extend(!0,{},d,i.chartSettings):d,c.series=[l],t.chart.setOption(c)},n.prototype.drawWordCloudChart=function(){var t=this,n=t.stat,i=t.options.config,a=[];for(var o in n.series)n.series[o].name&&a.push(n.series[o]);var r={type:"wordCloud",sizeRange:[12,50],rotationRange:[-45,90],textPadding:0,autoSize:{enable:!0,minSize:6},textStyle:{normal:{color:function(){return t.options.chartColor[Math.floor(Math.random()*t.options.chartColor.length)]}},emphasis:{shadowBlur:10,shadowColor:"#333"}},data:a},s={};s=i.chartSettings&&i.chartSettings.series?e.extend(!0,{},r,i.chartSettings.series):r,t.chart=echarts.init(t.$container[0]);var l={},d={};d=i.chartSettings?e.extend(!0,{},l,i.chartSettings):l,d.series=[s],t.chart.setOption(d)},n.prototype.drawLineBarChart=function(t){var n=this,i={type:"category",axisLine:{show:!1},axisTick:{show:!1,alignWithLabel:!0},splitLine:{show:!0}},a={name:"",type:t,symbol:"circle",
symbolSize:10},o=n.stat,r=n.options.config,s=[];for(var l in o.series){var d=o.series[l];r.seriesName&&(d.name=r.seriesName[d.name]||d.name,s.push(d.name))}var c=0,g=[];for(var p in o.xAxis){var f=o.xAxis[p];r.chartSettings&&r.chartSettings.xAxis&&(r.chartSettings.xAxis instanceof Array?e.extend(!0,i,r.chartSettings.xAxis[c]):e.extend(!0,i,r.chartSettings.xAxis)),g.push(e.extend(!0,{},i,f))}c=0;var u=[];for(var h in o.series){var b=o.series[h];r.chartSettings&&r.chartSettings.series&&(r.chartSettings.series instanceof Array?e.extend(!0,a,r.chartSettings.series[c]):e.extend(!0,a,r.chartSettings.series)),""==b.name&&delete b.name;var d=e.extend(!0,{},a,b);r.seriesName&&r.seriesName[d.name]&&(d.name=r.seriesName[d.name]||d.name),u.push(d),c++}n.chart=echarts.init(n.$container[0]);var m={color:n.options.chartColor,tooltip:{position:"top",trigger:"axis",axisPointer:{type:"line"}},legend:{show:!1,orient:"vertical",x:"left",data:s},grid:{left:9,right:9,bottom:24,top:24,containLabel:!0},yAxis:[{type:"value",axisLine:{show:!1},axisTick:{show:!1}}]};r.seriesName&&!e.isEmptyObject(r.seriesName)&&(m.tooltip.formatter=function(t){var e="";for(var n in t){var i=t[n];e+=i.seriesName+":"+i.data+"<br>"}return e});var v={};v=r.chartSettings?e.extend(!0,{},m,r.chartSettings):m,r.changeXY?(v.xAxis=v.yAxis,v.yAxis=g):v.xAxis=g,v.series=u,n.chart.setOption(v)},n.prototype.load=function(){var t=this,n=t.options.data||{},i=t.options.data2||{};i=e.extend(!0,i,t.options.config.querySettings),t.options.beforeLoad&&(i=t.options.beforeLoad(i));var a=t.$container;a.empty(),hieknjs.kgLoader({url:t.options.baseUrl+"stat/data?"+e.param(n),type:1,params:i,dataFilter:t.options.dataFilter||function(t){return t},success:function(e,n,i,a){e&&(t.stat=e.rsData[0],t.drawChart())},that:a[0]})},n}t.HieknStatService=n()}(window,jQuery),function(t,e){"use strict";function n(){var n=function(t){var n=this,i={container:null,config:{},load:e.noop};return n.$container=null,n.options=e.extend(!0,{},i,t),n.init(),n};return n.prototype.init=function(){var t=this;t.$container=e(t.options.container).addClass("hiekn-table"),t.$container.append('<div class="hiekn-table-filter"></div><div class="hiekn-table-content"></div><div class="hiekn-table-page"><div class="pagination-outter"><ul class="pagination"></ul></div></div>'),t.buildFilter(),t.bindEvent()},n.prototype.bindEvent=function(){var t=this;t.bindFilterEvent(),t.bindTableEvent()},n.prototype.bindFilterEvent=function(){var n=this;this.select(".hiekn-table-filter").on("click","span[option-value]",function(t){var i=e(t.target);i.attr("option-key"),i.attr("option-value");i.closest(".hiekn-table-filter-item").hasClass("multi")?i.toggleClass("active"):(i.hasClass("active")?i.removeClass("active"):i.addClass("active").siblings(".active").removeClass("active"),n.loadData(1))}),this.select(".hiekn-table-filter").on("click",".hiekn-table-filter-more",function(t){var n=e(t.target);n.closest(".hiekn-table-filter-item").addClass("expend")}),this.select(".hiekn-table-filter").on("click",".hiekn-table-filter-less",function(t){var n=e(t.target);n.closest(".hiekn-table-filter-item").removeClass("expend")}),this.select(".hiekn-table-filter").on("click",".hiekn-table-filter-multi",function(t){var n=e(t.target);n.closest(".hiekn-table-filter-item").addClass("multi")}),this.select(".hiekn-table-filter").on("click",".hiekn-table-btn-confirm",function(t){var i=e(t.target);i.closest(".hiekn-table-filter-item").removeClass("multi"),n.loadData(1)}),this.select(".hiekn-table-filter").on("click",".hiekn-table-btn-cancel",function(t){var n=e(t.target);n.closest(".hiekn-table-filter-item").removeClass("multi")}),this.select(".hiekn-table-search-kw-container").on("keydown","input",function(e){var i=t.event?e.keyCode:e.which;13==i&&n.loadData(1)})},n.prototype.bindTableEvent=function(){var t=this;t.select(".hiekn-table-content").on("click",".hiekn-table-data-angle",function(){e(this).toggleClass("on").closest("tr").next("tr.hiekn-table-detail-line").toggleClass("hide")})},n.prototype.buildFilter=function(){var t=this,e="",n=t.options.config.filter;for(var i in n){var a=n[i],o=a.label||a.key,r="";for(var s in a.options){var l=a.options[s];r+=l instanceof Object?'<span option-value="'+l.value+'" option-key="'+a.key+'">'+l.key+"</span>":'<span option-value="'+l+'" option-key="'+a.key+'">'+l+"</span>"}e+='<div class="hiekn-table-filter-item"><div class="hiekn-table-filter-item-label">'+o+'：</div><div class="hiekn-table-filter-item-content">'+r+'<div class="hiekn-table-more-container"><span class="hiekn-table-filter-more">更多 <i class="fa fa-angle-down"></i></span><span class="hiekn-table-filter-less">收起 <i class="fa fa-angle-up"></i></span><span class="hiekn-table-filter-multi"><i class="fa fa-plus"></i> 多选</span><button class="btn btn-primary hiekn-table-btn-confirm">确定</button><button class="btn btn-primary-outline hiekn-table-btn-cancel">取消</button></div></div></div>'}e+='<div class="hiekn-table-filter-item hiekn-table-filter-item-kw"><div class="hiekn-table-filter-item-label">关键词：</div><div class="hiekn-table-filter-item-content"><div class="hiekn-table-search-kw-container"><input type="text"><button class="btn btn-primary hiekn-table-btn-confirm">确定</button></div></div></div>',t.select(".hiekn-table-filter").html(e)},n.prototype.dealContent=function(t){if(t){var n=e("<div>"+t+"</div>").text();return n.length>80?n.substring(0,80)+"...":n}return""},n.prototype.drawPage=function(t,e,n){var i=this;hieknjs.gentPage({data:Math.ceil(t/n),cur:e,p:i.select(".pagination"),event:function(t,e){i.loadData(e)}})},n.prototype.drawData=function(t){var e=this,n=e.options.config;t=hieknjs.dealNull(t),e.data=t;var i="<thead><tr>",a="<tbody>",o=n.fieldsTable||n.fields,r=n.fieldsTableName?n.fieldsTableName:n.fieldsName?n.fieldsName:o,s=n.drawDetail||n.fieldsDetail||n.fieldsTable,l=n.fieldsDetail||n.fields,d=n.fieldsDetailName?n.fieldsDetailName:n.fieldsName?n.fieldsName:o,c=n.fieldsRenderer||{},g={};s&&(i+="<th></th>");for(var p in o){var f=c[o[p]];if(f&&f instanceof Object&&"link"==f.type&&f.fields)for(var u in f.fields){var h=f.fields[u];g[h]=o[p]}else i+="<th>"+r[p]+"</th>"}for(var b in t){var m=t[b],v="<tr>";s&&(v+='<td class="hiekn-table-data-angle"><i class="fa fa-caret-right"></i></td>');var k=0;for(var y in o){k++;var S=o[y];c[S]&&c[S].fields||(v+="<td>"+e.rendererFields(m,S,g,c,!0)+"</td>")}if(v+="</tr>",a+=v,s){var A='<tr class="hiekn-table-detail-line hide"><td colspan="'+(k+1)+'">';for(var u in l){var S=l[u];c[S]&&c[S].fields||(A+='<div class="hiekn-table-detail-'+S+'"><label>'+d[u]+":</label>"+e.rendererFields(m,S,g,c,!1)+"</div>")}A+="</td></tr>",a+=A}}a+="</body>",i+="</tr></thead>",e.select(".hiekn-table-content").html('<table class="hiekn-table-normal">'+i+a+"</table>")},n.prototype.getFilterKw=function(){var t=this,e=t.select(".hiekn-table-search-kw-container");return e.find("input").val()},n.prototype.getFilterOptions=function(){var t=this,n={};return t.select(".hiekn-table-filter-item").each(function(t,i){var a="",o=e(i).find("span[option-value].active");if(o.length){var r=!1,s=[];o.each(function(t,n){var i=e(n).attr("option-value");i?(a=e(n).attr("option-key"),s.push(i)):r=!0}),r||(n[a]=s)}}),n},n.prototype.getTableContainer=function(){var t=this;return t.select(".hiekn-table-content")},n.prototype.getValues=function(t){var e=[];if(t instanceof Array)e=t;else if("string"==typeof t)if(0==t.indexOf("["))try{e=JSON.parse(t)}catch(n){e=[t]}else e=t.split(",");return e},n.prototype.loadData=function(t){var e=this;e.options.load(t,e)},n.prototype.rendererDateTime=function(t){return moment(t).format("YYYY-MM-DD HH:mm:ss")},n.prototype.rendererDate=function(t){return moment(t).format("YYYYMMDD")},n.prototype.rendererFields=function(t,e,n,i,a){var o=this,r="";if(t[e]){var s=o.getValues(t[e]);for(var l in s)r+=i[e]?","+o.rendererValue(i[e].type||i[e],s[l],i[e],a):","+o.rendererValue("string",s[l],void 0,a);r=r.substring(1)}if(n[e]){var d=t[e];t[e]||(d="链接"),r=o.rendererLink(t[n[e]],d)}return r},n.prototype.rendererYear=function(t){return moment(t).format("YYYY")},n.prototype.rendererLink=function(t,e,n){return e=e||"查看",n=n||"",t?'<a href="'+t+'" target="_blank" class="'+n+'">'+e+"</a>":""},n.prototype.rendererValue=function(t,e,n,i){var a=this,o="";try{o="year"==t?a.rendererYear(e):"date"==t?a.rendererDate(e):"dateTime"==t?a.rendererDateTime(e):"json"==t?JSON.stringify(e):"link"==t?a.rendererLink(e,n.name,"hiekn-table-btn-link"):"string"==t&&i?a.dealContent(e):hieknjs.safeHTML(e)}catch(r){}return o},n.prototype.select=function(t){var e=this;return e.$container.find(t)},n}t.HieknTableService=n()}(window,jQuery),function(t,e){"use strict";function n(){var n=function(n){var i=this;i.isInit=!1,i.baseSettings={baseUrl:n.baseUrl,data:n.data,kgName:n.kgName},i.filterSettings={selectedAtts:n.selectedAtts,selectedTypes:n.selectedTypes},i.infoboxSettings={dataFilter:n.dataFilter,selector:n.selector,imagePrefix:n.imagePrefix},e.extend(!0,i.infoboxSettings,i.baseSettings),i.loaderSettings={dataFilter:n.dataFilter,selector:n.selector,tgc2:null,tgc2Filter:null,tgc2TimeChart:null},e.extend(!0,i.loaderSettings,i.baseSettings),i.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof n.enableAutoUpdateStyle||n.enableAutoUpdateStyle,imagePrefix:n.imagePrefix,images:n.images,nodeColors:n.nodeColors,minRadius:n.minRadius||10,legendClass:null,legendColor:null,tgc2:null},i.promptSettings=i.baseSettings,i.schemaSettings={dataFilter:n.dataFilter,that:e(n.selector)[0]},e.extend(!0,i.schemaSettings,i.baseSettings),i.initSettings={that:e(n.selector)[0],isTiming:!0,success:function(t){t.entityList&&t.entityList.length&&i.load(t.entityList[0])},failed:e.noop},e.extend(!0,i.initSettings,i.baseSettings),i.tgc2Settings={},i.legendFilter={},i.layoutStatus=n.layoutStatus,i.sdkUtils=new t.HieknSDKService,i.sdkUtils.schema(i.schemaSettings,function(t){var a=i.sdkUtils.buildFilter(t,i.filterSettings),o={selector:n.selector,autoResize:!0,prompt:{enable:!0,settings:{drawPromptItem:i.sdkUtils.drawPromptItem(t),onPrompt:i.sdkUtils.onPrompt(i.promptSettings)}},filter:{enable:!0,filters:a},crumb:{enable:!0},find:{enable:!0},legend:{enable:!0,style:{bottom:"60px"},data:n.nodeColors||[],legendDraw:i.sdkUtils.legendDraw(t,i,n.legendType),onClick:function(t){i.sdkUtils.legendClick(t,i)},onDblClick:function(t){i.sdkUtils.legendDblClick(t,i)},onMouseEnter:function(t){i.sdkUtils.legendMouseEnter(t,i)},onMouseLeave:function(t){i.sdkUtils.legendMouseLeave(t,i)}},timeChart:{enable:!0},event:{enable:!0},netChart:{settings:{filters:{nodeFilter:function(t){return i.sdkUtils.nodeFilter(t,i)}},nodeMenu:{contentsFunction:i.sdkUtils.infobox()},style:{nodeStyleFunction:i.sdkUtils.nodeStyleFunction(i.nodeSettings)},info:{linkContentsFunction:i.sdkUtils.linkContentsFunction}}},loader:i.sdkUtils.timing(i.loaderSettings,t)};i.tgc2Settings=e.extend(!0,{},o,n.tgc2Settings),i.sdkUtils.gentInfobox(i.infoboxSettings),i.init(),n.startInfo&&i.load(n.startInfo)})};return n.prototype.init=function(){var t=this;t.tgc2=new Tgc2Graph(t.tgc2Settings),t.tgc2Filter=new Tgc2Filter(t.tgc2,t.tgc2Settings.filter),t.tgc2TimeChart=new Tgc2TimeChart(t.tgc2,t.tgc2Settings.timeChart),t.tgc2Event=new Tgc2Event(t.tgc2,t.tgc2Settings.event),t.tgc2Prompt=new Tgc2Prompt(t.tgc2,t.tgc2Settings.prompt),t.tgc2Crumb=new Tgc2Crumb(t.tgc2,t.tgc2Settings.crumb),t.tgc2Find=new Tgc2Find(t.tgc2,t.tgc2Settings.find),t.tgc2Legend=new Tgc2Legend(t.tgc2,t.tgc2Settings.legend),t.loaderSettings.tgc2=t.tgc2,t.loaderSettings.tgc2Filter=t.tgc2Filter,t.loaderSettings.tgc2TimeChart=t.tgc2TimeChart,t.nodeSettings.tgc2=t.tgc2,t.tgc2.init(),t.isInit=!0;try{t.tgc2TimeChart.$settingModal.find(".input-daterange").datepicker({format:"yyyy-mm-dd"}),t.tgc2TimeChart.$settingModal.find(".input-daterange").find("input").prop("type","text")}catch(e){}},n.prototype.load=function(t){var e=this;setTimeout(function(){e.isInit?t?e.tgc2.load(t):e.sdkUtils.graphInit(e.initSettings):e.load(t)},30)},n}t.HieknTimingGraphService=n()}(window,jQuery);