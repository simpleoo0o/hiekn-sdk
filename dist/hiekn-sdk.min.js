/**
     * @author: 
     *    jiangrun002
     * @version: 
     *    v3.0.0
     * @license:
     *    Copyright 2017, jiangrun. All rights reserved.
     */

var HieknSDKNetChart=function(){function t(t){this.isInit=!1,this.isTiming=!1,this.options={},this.baseSettings={},this.promptSettings={},this.filterSettings={},this.infoboxSettings={},this.loaderSettings={},this.nodeSettings={},this.schemaSettings={},this.initSettings={},this.defaultTgc2Options={},this.defaultColor="#00b38a",this.options=t,this.beforeInit(t)}return t.prototype.load=function(t){var e=this;setTimeout(function(){e.isInit?t?e.tgc2.load(t):e.graphInit(e.initSettings):e.load(t)},30)},t.prototype.beforeInit=function(t){var e=this;this.isInit=!1,this.baseSettings={baseUrl:t.baseUrl,dataFilter:t.dataFilter,formData:t.formData||{},queryData:t.queryData||{}},this.filterSettings={selectedAtts:t.selectedAtts,selectedTypes:t.selectedTypes},this.infoboxSettings={enable:"boolean"!=typeof t.infobox||t.infobox,selector:t.selector,imagePrefix:t.imagePrefix,formData:{kgName:t.kgName}},$.extend(!0,this.infoboxSettings,this.baseSettings),this.loaderSettings={selector:t.selector,formData:{kgName:t.kgName}},$.extend(!0,this.loaderSettings,this.baseSettings),this.nodeSettings={autoUpdateStyle:"boolean"!=typeof t.autoUpdateStyle||t.autoUpdateStyle,imagePrefix:t.imagePrefix,images:t.images,nodeColors:t.nodeColors,textColors:t.textColors,minRadius:t.minRadius||10,legendClass:null,legendColor:null},this.promptSettings={formData:{kgName:t.kgName}},$.extend(!0,this.promptSettings,this.baseSettings),this.schemaSettings={preloadData:t.schema,formData:{kgName:t.kgName},that:$(t.selector)[0]},this.initSettings={formData:{kgName:t.kgName},that:$(t.selector)[0]},$.extend(!0,this.initSettings,this.baseSettings),this.legendFilter={},this.layoutStatus=t.layoutStatus,this.schemaSettings.preloadData?this.init(t,this.schemaSettings.preloadData):($.extend(!0,this.schemaSettings,this.baseSettings),this.schemaSettings.success=function(i){e.init(t,i)},HieknSDKSchema.load(this.schemaSettings))},t.prototype.graphInit=function(t){var e=t.queryData||{},i=t.formData||{};i.isTiming=this.isTiming,HieknSDKUtils.ajax({url:t.baseUrl+"graph/init?"+$.param(e),type:"POST",data:i,dataFilter:t.dataFilter,success:function(e){t.success(e[0])}})},t.prototype.gentInfobox=function(t){t.formData.isRelationAtts="boolean"!=typeof t.formData.isRelationAtts||t.formData.isRelationAtts,this.infoboxService=new HieknSDKInfobox(t),this.infoboxService.initEvent($(t.selector))},t.prototype.infobox=function(t,e,i){var n=this;return e.detail?i(e.detail):this.infoboxService.load(t.id,function(t){t=n.infoboxService.buildInfobox(t)[0].outerHTML,e.detail=t,i(t)}),null},t.prototype.init=function(e,i){var n=this;if(e.autoColor){var a={};for(var o in i.types)a[i.types[o].k]=HieknSDKUtils.color[parseInt(o)%HieknSDKUtils.color.length];$.extend(!0,a,this.nodeSettings.nodeColors||{}),this.nodeSettings.nodeColors=a}this.defaultTgc2Options={selector:e.selector,filter:{enable:!0,filters:t.buildFilter(i,this.filterSettings)},crumb:{enable:!0},find:{enable:!0},legend:{enable:!0,data:this.nodeSettings.nodeColors||{},legendDraw:this.legendDraw(i,e.legendType),onClick:function(t){n.legendClick(t)},onDblClick:function(t){n.legendDblClick(t)},onMouseEnter:function(t){n.legendMouseEnter(t)},onMouseLeave:function(t){n.legendMouseLeave(t)}},netChart:{settings:{filters:{nodeFilter:function(t){return n.nodeFilter(t)}},nodeMenu:{contentsFunction:function(t,e,i){return n.infobox(t,e,i)}},style:{node:{display:e.display||"circle"},nodeStyleFunction:this.nodeStyleFunction(this.nodeSettings)},info:{linkContentsFunction:t.linkContentsFunction}}},loader:this.loader(this.loaderSettings,i)},this.buildPrivateSetting(i),this.tgc2Filter=new Tgc2Filter(this.tgc2,this.tgc2Settings.filter),this.tgc2Crumb=new Tgc2Crumb(this.tgc2,this.tgc2Settings.crumb),this.tgc2Find=new Tgc2Find(this.tgc2,this.tgc2Settings.find),this.tgc2Legend=new Tgc2Legend(this.tgc2,this.tgc2Settings.legend),this.infoboxSettings.enable&&this.gentInfobox(this.infoboxSettings),this.tgc2.init(),this.isInit=!0,e.startInfo&&this.load(e.startInfo)},t.prototype.legend=function(t){for(var e={},i=0,n=t.types;i<n.length;i++){var a=n[i];e[a.k]=a.v}return function(t,i){return'<i style="background: '+i+'"></i><span title="'+e[t]+'">'+e[t]+"</span>"}},t.prototype.legendClick=function(t){var e=$(t.currentTarget);e.toggleClass("off"),this.legendFilter[e.data("key")]=e.hasClass("off"),this.tgc2.netChart.updateFilters()},t.prototype.legendDblClick=function(t){var e=this,i=$(t.currentTarget),n=i.removeClass("off").siblings();n.addClass("off");var a=i.data("key");this.legendFilter={},this.legendFilter[a]=!1,n.each(function(t,i){e.legendFilter[$(i).data("key")]=!0}),this.tgc2.netChart.updateFilters()},t.prototype.legendDraw=function(t,e){for(var i=this,n={},a=0,o=t.types;a<o.length;a++){var s=o[a];n[s.k]=s.v}return function(t,a){i.legendFilter={};var o=_.filter(i.tgc2.getAvailableData().nodes,function(t){return!t.hidden}),s=_.keys(_.groupBy(o,"classId"));if("fab"==e){var r=[];for(var l in t)if(t.hasOwnProperty(l)&&_.indexOf(s,l)>=0){var c="",d=n[l];c=d.length>3?'<div title="'+d+'"><div>'+d.substring(0,2)+'</div><div class="line-hidden">'+d.substring(2)+"</div></div>":'<div class="line-hidden" title="'+d+'">'+d+"</div>",r.push({html:c,data:{key:l,value:t[l]},style:{background:t[l],color:"#fff"},events:{click:function(t){i.legendClick(t)},mouseenter:function(t){i.legendMouseEnter(t)},mouseleave:function(t){i.legendMouseLeave(t)},dblclick:function(t){i.legendDblClick(t)}}})}new hieknjs.fab({container:a,radius:80,angle:90,startAngle:90,initStatus:i.layoutStatus,main:{html:"图例",style:{background:i.defaultColor,color:"#fff"},events:{click:function(){i.layoutStatus=!i.layoutStatus}}},items:r})}else{a.html("");for(var l in t)if(t.hasOwnProperty(l)&&_.indexOf(s,l)>=0){var p=$('<div class="tgc2-legend-item tgc2-legend-item-'+l+'"></div>').data({key:l,value:t[l]});a.append(p.html('<i style="background: '+t[l]+'"></i><span title="'+n[l]+'">'+n[l]+"</span>"))}}}},t.prototype.legendMouseEnter=function(t){var e=$(t.currentTarget);e.addClass("active").siblings().addClass("inactive"),this.nodeSettings.legendClass=e.data("key"),this.nodeSettings.legendColor=e.data("value"),this.tgc2.netChart.updateStyle()},t.prototype.legendMouseLeave=function(t){var e=$(t.currentTarget);e.removeClass("active inactive").siblings().removeClass("active inactive"),this.nodeSettings.legendClass=null,this.nodeSettings.legendColor=null,this.tgc2.netChart.updateStyle()},t.prototype.loader=function(e,i){var n=this;return function(a,o,s){var r=n.buildLoaderParams(e);HieknSDKUtils.ajax({url:e.baseUrl+r.url+"?"+$.param(r.queryData),type:"POST",data:r.formData,dataFilter:e.dataFilter,success:function(e){e=e[0],e&&(e=t.dealGraphData(e,i)),o(e)},error:function(){s()},that:$(e.selector).find(".tgc2-netchart-container")[0]})}},t.prototype.nodeFilter=function(t){return this.tgc2.inStart(t.id)||!this.legendFilter[t.classId]},t.prototype.nodeStyleFunction=function(e){var i=this;return e.autoUpdateStyle&&setInterval(function(){i.updateStyle()},30),function(n){var a=n.data,o=a.classId,s=i.tgc2.getEmphasesNode(),r=i.tgc2.settings.netChart;if(n.label=n.data.name,n.lineWidth=2,n.fillColor=n.data.color||r.nodeDefaultColor||n.fillColor,n.labelStyle.textStyle.font="18px Microsoft Yahei",n.aura=n.data.auras,i.tgc2.inStart(n.id)&&(n.radius=50,n.fillColor=r.emphasesColor),s[n.id]?(n.fillColor=r.emphasesColor,n.label=n.data.name,n.radius=1.5*n.radius):$.isEmptyObject(s)||(n.fillColor=r.reduceColor,n.radius=.5*n.radius),n.imageCropping="fit",!$.isEmptyObject(s)||e.legendClass?s[n.id]||e.legendClass==a.classId?n.radius=1.5*n.radius:(n.fillColor=i.tgc2.settings.netChart.reduceColor,n.label="",n.lineColor=n.fillColor,n.radius=.5*n.radius):i.tgc2.inStart(n.id)||(n.fillColor=a.color||"#fff",n.lineColor=i.defaultColor,n.hovered&&(n.fillColor=n.lineColor,n.shadowBlur=0)),e.nodeColors){var l=t.getHieknTypeUnionMapValue(e.nodeColors[o]);l&&(!$.isEmptyObject(s)||e.legendClass?(s[n.id]||e.legendClass==o)&&(n.fillColor=e.legendColor||i.tgc2.settings.netChart.emphasesColor,n.lineColor=n.fillColor):i.tgc2.inStart(n.id)?(n.fillColor=i.tgc2.settings.netChart.emphasesColor,n.lineColor=n.fillColor):(n.lineColor=l,e.imagePrefix||e.images||a.img||(n.fillColor=n.lineColor),n.hovered&&(n.fillColor=n.lineColor)))}if(a.img)0!=a.img.indexOf("http")&&e.imagePrefix?n.image=HieknSDKUtils.qiniuImg(e.imagePrefix+a.img):n.image=a.img,!$.isEmptyObject(s)||e.legendClass?s[n.id]||e.legendClass==o||(n.image=""):i.tgc2.inStart(n.id)||n.hovered||(n.image=""),n.fillColor="#fff";else if(e.images&&e.images[o]){var l=t.getHieknTypeUnionMapValue(e.images[o]);l&&(!$.isEmptyObject(s)||e.legendClass?s[n.id]||e.legendClass==o?n.image=e.legendColor||l.emphases:n.image="":i.tgc2.inStart(n.id)||n.hovered?n.image=l.emphases:n.image=l.normal)}var c=i.tgc2.netChart.getNodeDimensions(n).radius;if(e.autoUpdateStyle&&(c<e.minRadius&&(n.image="",n.fillColor=n.lineColor),i.tgc2.inStart(n.id)&&(i.centerNodeRadius=c,!i.centerNode&&(i.centerNode=n))),e.textColors){var l=t.getHieknTypeUnionMapValue(e.textColors[o]);l&&("string"==typeof l?n.labelStyle.textStyle.fillColor=l:i.tgc2.inStart(n.id)||s[n.id]?n.labelStyle.textStyle.fillColor=l.emphases:n.hovered?n.labelStyle.textStyle.fillColor=l.emphases:n.labelStyle.textStyle.fillColor=l.normal)}var d=n.label.length;if("roundtext"==n.display){for(var p=n.label,h=HieknSDKUtils.regChinese,u=HieknSDKUtils.regEnglish,f=1;f<p.length-1;f++){var g=p.charAt(f),v=p.charAt(f+1);(h.test(g)&&u.test(v)||u.test(g)&&h.test(v))&&(p=p.substring(0,f+1)+" "+p.substring(f+1),f++)}if(n.label=p,n.label.indexOf(" ")<0&&d>5)if(d>9){var m=Math.floor(n.label.length/3),b=d-m;n.label=n.label.substring(0,m)+" "+n.label.substring(m,b)+" "+n.label.substring(b)}else d>5&&(n.label=n.label.substring(0,4)+" "+n.label.substring(4))}}},t.prototype.updateStyle=function(){if(this.centerNode){var t=this.tgc2.netChart.getNodeDimensions(this.centerNode).radius;if(this.centerNodeRadius!=t){for(var e=this.tgc2.netChart.nodes(),i=[],n=0,a=e;n<a.length;n++){var o=a[n];i.push(o.id)}this.tgc2.netChart.updateStyle(i)}}},t.buildFilter=function(t,e){var i=[],n=[],a=[],o=[];for(var s in t.atts){var r=t.atts[s];1==r.type&&(i.push({value:r.k,label:r.v}),n.push(r.k))}for(var l in t.types){var c=t.types[l];a.push({value:c.k,label:c.v}),o.push(c.k)}return n=e.selectedAtts||n,o=e.selectedTypes||o,[{key:"allowTypes",label:"设定分析主体",selected:o,options:a},{key:"allowAtts",label:"设定分析关系",selected:n,options:i}]},t.dealGraphData=function(t,e){t.nodes=t.entityList,t.links=t.relationList,delete t.entityList,delete t.relationList;for(var i={},n=_.concat(e.types,e.atts),a=0,o=n;a<o.length;a++){var s=o[a];i[s.k]=s.v}for(var r=0,l=t.nodes;r<l.length;r++){var c=l[r];c.typeName=i[c.classId]}for(var d=0,p=t.links;d<p.length;d++){var h=p[d];h.typeName=i[h.attId]}return t},t.getHieknTypeUnionMapValue=function(t,e){return t instanceof String?t:e?t[e]:t},t.linkContentsFunction=function(t){var e=$.extend(!0,[],t.nRInfo||[],t.oRInfo||[]);if(e){for(var i="",n=0,a=e;n<a.length;n++){var o=a[n];i+="<tr>";var s=o.kvs,r="<tr>",l="<tr>";for(var c in s)s.hasOwnProperty(c)&&(r+='<th><div class="link-info-key">'+s[c].k+"</div></th>",l+='<td><div class="link-info-value">'+s[c].v+"</div></td>");i+="<li><table><thead>"+r+"</thead><tbody>"+l+"</tbody></table></li>"}return'<ul class="link-info">'+i+"</ul>"}return t.typeName},t.orderRelation=function(t){var e={},i=_.countBy(t,"from"),n=_.countBy(t,"to");for(var a in i)e[a]=(e[a]||0)+(n[a]||0)+i[a];for(var o in n)e[o]=(e[o]||0)+(i[o]||0)+n[o];var s=[];for(var r in e)s.push({k:r,v:e[r]});return _.orderBy(s,"v","desc")},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),HieknSDKGraph=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.buildPrivateSetting=function(t){var e=this,i={success:function(t){t.entityList&&t.entityList.length&&e.load(t.entityList[0])}};$.extend(!0,this.initSettings,i);var n=[{key:"distance",label:"设定显示层数",selected:this.options.selectedDistance||1,options:[1,2,3]}].concat(this.defaultTgc2Options.filter.filters),a={prompt:{enable:!0,settings:{drawPromptItem:HieknSDKPrompt.drawPromptItem(t),onPrompt:HieknSDKPrompt.onPrompt(this.promptSettings)}},page:{enable:!0,pageSize:20}};this.tgc2Settings=$.extend(!0,{},this.defaultTgc2Options,a,this.options.tgc2Settings),this.tgc2Settings.filter.filters=n,this.tgc2=new Tgc2Graph(this.tgc2Settings),this.tgc2Prompt=new Tgc2Prompt(this.tgc2,this.tgc2Settings.prompt),this.tgc2Page=new Tgc2Page(this.tgc2,this.tgc2Settings.page)},e.prototype.buildLoaderParams=function(t){var e=t.queryData||{},i=t.formData||{};if(i.id=this.tgc2.startInfo.id,i.isRelationMerge=!0,this.tgc2Filter){var n=this.tgc2Filter.getFilterOptions();$.extend(!0,i,n)}if(this.tgc2Page){var a=this.tgc2Page.page;i.pageNo=a.pageNo,i.pageSize=a.pageSize}return{queryData:e,formData:i,url:"graph"}},e}(HieknSDKNetChart),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),HieknSDKPath=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.buildPrivateSetting=function(t){var e=this,i={success:function(t){if(t.relationList&&t.relationList.length){var i=HieknSDKNetChart.orderRelation(t.relationList),n=i[2]?i[2].k:i[0].k,a=i[1].k;e.load({id:(new Date).getTime(),start:{id:n},end:{id:a}})}}};$.extend(!0,this.initSettings,i);var n=[{key:"distance",label:"设定分析步长",selected:this.options.selectedDistance||3,options:[3,4,5,6]}].concat(this.defaultTgc2Options.filter.filters),a={stats:{enable:!0,editable:!0,atts:t.atts,types:t.types,statsConfig:this.options.statsConfig},connects:{enable:!0,mode:"click"},legend:{enable:!1},path:{prompt:{settings:{drawPromptItem:HieknSDKPrompt.drawPromptItem(t),onPrompt:HieknSDKPrompt.onPrompt(this.promptSettings)}}}};this.tgc2Settings=$.extend(!0,{},this.defaultTgc2Options,a,this.options.tgc2Settings),this.tgc2Settings.filter.filters=n,this.tgc2=new Tgc2Path(this.tgc2Settings),this.tgc2Stats=new Tgc2Stats(this.tgc2,this.tgc2Settings.stats),this.tgc2Connects=new Tgc2Connects(this.tgc2,this.tgc2Settings.connects)},e.prototype.buildLoaderParams=function(t){var e=t.queryData||{},i=t.formData||{};if(i.start=this.tgc2.startInfo.start.id,i.end=this.tgc2.startInfo.end.id,i.isShortest=!0,i.connectsCompute=!0,i.statsCompute=!0,this.tgc2Filter){var n=this.tgc2Filter.getFilterOptions();$.extend(!0,i,n)}return this.tgc2Stats&&(i.statsConfig=this.tgc2Stats.getStatsConfig()),{queryData:e,formData:i,url:"path"}},e}(HieknSDKNetChart),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),HieknSDKRelation=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.buildPrivateSetting=function(t){var e=this,i={success:function(t){if(t.relationList&&t.relationList.length){var i=HieknSDKNetChart.orderRelation(t.relationList),n=[];for(var a in i)parseInt(a)<3&&n.push({id:i[a].k});e.load({id:(new Date).getTime(),nodes:n})}}};$.extend(!0,this.initSettings,i);var n=[{key:"distance",label:"设定分析步长",selected:this.options.selectedDistance||3,options:[3,4,5,6]}].concat(this.defaultTgc2Options.filter.filters),a={stats:{enable:!0,editable:!0,atts:t.atts,types:t.types,statsConfig:this.options.statsConfig},connects:{enable:!0,mode:"click"},legend:{enable:!1},relation:{prompt:{settings:{drawPromptItem:HieknSDKPrompt.drawPromptItem(t),onPrompt:HieknSDKPrompt.onPrompt(this.promptSettings)}}}};this.tgc2Settings=$.extend(!0,{},this.defaultTgc2Options,a,this.options.tgc2Settings),this.tgc2Settings.filter.filters=n,this.tgc2=new Tgc2Relation(this.tgc2Settings),this.tgc2Stats=new Tgc2Stats(this.tgc2,this.tgc2Settings.stats),this.tgc2Connects=new Tgc2Connects(this.tgc2,this.tgc2Settings.connects)},e.prototype.buildLoaderParams=function(t){var e=_.map(this.tgc2.startInfo.nodes,"id"),i=t.queryData||{},n=t.formData||{};if(n.ids=e,n.isShortest=!0,n.connectsCompute=!0,n.statsCompute=!0,this.tgc2Filter){var a=this.tgc2Filter.getFilterOptions();$.extend(!0,n,a)}return this.tgc2Stats&&(n.statsConfig=this.tgc2Stats.getStatsConfig()),{queryData:i,formData:n,url:"relation"}},e}(HieknSDKNetChart),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),HieknSDKTiming=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.buildPrivateSetting=function(t){var e=this,i={success:function(t){t.entityList&&t.entityList.length&&e.load(t.entityList[0])}};$.extend(!0,this.initSettings,i);var n={autoResize:!0,prompt:{enable:!0,settings:{drawPromptItem:HieknSDKPrompt.drawPromptItem(t),onPrompt:HieknSDKPrompt.onPrompt(this.promptSettings)}},legend:{style:{bottom:"60px"}},timeChart:{enable:!0},event:{enable:!0}};this.tgc2Settings=$.extend(!0,{},this.defaultTgc2Options,n,this.options.tgc2Settings),this.tgc2=new Tgc2Graph(this.tgc2Settings),this.tgc2Prompt=new Tgc2Prompt(this.tgc2,this.tgc2Settings.prompt),this.tgc2TimeChart=new Tgc2TimeChart(this.tgc2,this.tgc2Settings.timeChart),this.tgc2Event=new Tgc2Event(this.tgc2,this.tgc2Settings.event);try{this.tgc2TimeChart.$settingModal.find(".input-daterange").datepicker({format:"yyyy-mm-dd"}),this.tgc2TimeChart.$settingModal.find(".input-daterange").find("input").prop("type","text")}catch(a){}},e.prototype.buildLoaderParams=function(t){var e=t.queryData||{},i=t.formData||{};if(i.id=this.tgc2.startInfo.id,i.isRelationMerge=!0,this.tgc2Filter){var n=this.tgc2Filter.getFilterOptions();$.extend(!0,i,n)}if(this.tgc2TimeChart){var a=this.tgc2TimeChart.getSettings();delete a.type,$.extend(!0,i,a)}return{queryData:e,formData:i,url:"graph/timing"}},e}(HieknSDKNetChart),HieknSDKStat=function(){function t(t){this.defaults={chartColor:HieknSDKUtils.color},this.options=$.extend(!0,{},this.defaults,t),this.init()}return t.prototype.init=function(){this.$container=$(this.options.container),this.bindEvent()},t.prototype.bindEvent=function(){var t=this;$(window).on("resize",function(){t.chart&&t.chart.resize()})},t.prototype.load=function(){var t=this,e=this.options.queryData||{},i=this.options.formData||{};this.options.formDataUpdater&&(i=this.options.formDataUpdater(i));var n=this.$container.empty(),a={url:HieknSDKUtils.buildUrl(this.options.baseUrl+"stat/data",e),type:"POST",data:i,success:function(e,i,n){t.stat=e[0],t.drawChart()},that:n[0]};a=$.extend(!0,{},this.options,a),HieknSDKUtils.ajax(a)},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),HieknSDKStatLineBar=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.drawChart=function(){for(var t=this.options.config.type,e={type:"category",axisLine:{show:!1},axisTick:{show:!1,alignWithLabel:!0},splitLine:{show:!0}},i={name:"",type:t,symbol:"circle",symbolSize:10},n=this.stat,a=this.options.config,o=[],s=0,r=n.series;s<r.length;s++){var l=r[s];a.seriesName&&(l.name=a.seriesName[l.name]||l.name,o.push(l.name))}for(var c=0,d=[],p=0,h=n.xAxis;p<h.length;p++){var u=h[p];a.chartSettings&&a.chartSettings.xAxis&&(a.chartSettings.xAxis instanceof Array?$.extend(!0,e,a.chartSettings.xAxis[c]):$.extend(!0,e,a.chartSettings.xAxis)),d.push($.extend(!0,{},e,u))}c=0;for(var f=[],g=0,v=n.series;g<v.length;g++){var m=v[g];a.chartSettings&&a.chartSettings.series&&(a.chartSettings.series instanceof Array?$.extend(!0,i,a.chartSettings.series[c]):$.extend(!0,i,a.chartSettings.series)),""==m.name&&delete m.name;var l=$.extend(!0,{},i,m);a.seriesName&&a.seriesName[l.name]&&(l.name=a.seriesName[l.name]||l.name),f.push(l),c++}this.chart=echarts.init(this.$container[0]);var b={color:this.options.chartColor,tooltip:{position:"top",trigger:"axis",axisPointer:{type:"line"}},legend:{show:!1,orient:"vertical",x:"left",data:o},grid:{left:9,right:9,bottom:24,top:24,containLabel:!0},yAxis:[{type:"value",axisLine:{show:!1},axisTick:{show:!1}}]};a.seriesName&&!$.isEmptyObject(a.seriesName)&&(b.tooltip.formatter=function(t){for(var e="",i=0,n=t;i<n.length;i++){var a=n[i];e+=a.seriesName+":"+a.data+"<br>"}return e});var y={};y=a.chartSettings?$.extend(!0,{},b,a.chartSettings):b,a.changeXY?(y.xAxis=y.yAxis,y.yAxis=d):y.xAxis=d,y.series=f,this.chart.setOption(y)},e}(HieknSDKStat),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),HieknSDKStatPie=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.drawChart=function(){for(var t=this.stat,e=this.options.config,i=[],n=0,a=t.series;n<a.length;n++){var o=a[n];e.seriesName&&(o.name=e.seriesName[o.name]||o.name,i.push(o.name))}var s={name:"",type:"pie",radius:"75%",center:["50%","50%"],data:t.series,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},r={};r=e.chartSettings&&e.chartSettings.series?$.extend(!0,{},s,e.chartSettings.series):s,this.chart=echarts.init(this.$container[0]);var l={color:this.options.chartColor,tooltip:{trigger:"item",formatter:"{b} <br/>{c} ({d}%)"},legend:{orient:"vertical",x:"left",data:i}},c={};c=e.chartSettings?$.extend(!0,{},l,e.chartSettings):l,c.series=[r],this.chart.setOption(c)},e}(HieknSDKStat),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),HieknSDKStatWordCloud=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.drawChart=function(){for(var t=this,e=this.stat,i=this.options.config,n=[],a=0,o=e.series;a<o.length;a++){var s=o[a];s.name&&n.push(s)}var r={type:"wordCloud",sizeRange:[12,50],rotationRange:[-45,90],textPadding:0,autoSize:{enable:!0,minSize:6},textStyle:{normal:{color:function(){return t.options.chartColor[Math.floor(Math.random()*t.options.chartColor.length)]}},emphasis:{shadowBlur:10,shadowColor:"#333"}},data:n},l={};l=i.chartSettings&&i.chartSettings.series?$.extend(!0,{},r,i.chartSettings.series):r,this.chart=echarts.init(this.$container[0]);var c={},d={};d=i.chartSettings?$.extend(!0,{},c,i.chartSettings):c,d.series=[l],this.chart.setOption(d)},e}(HieknSDKStat),HieknSDKAssociation=function(){function t(){}return t.load=function(e){e=$.extend(!0,{},t.defaults,e);var i=e.queryData||{},n=e.formData||{};n.kgName=e.kgName;var a={url:HieknSDKUtils.buildUrl(e.baseUrl+"association",i),type:"POST",data:n};a=$.extend(!0,{},e,a),HieknSDKUtils.ajax(a)},t}();HieknSDKAssociation.defaults={formData:{pageSize:6}};var HieknSDKConceptGraph=function(){function t(t){var e=this;this.options={};var i={baseUrl:t.baseUrl,queryData:t.queryData,kgName:t.kgName};this.promptSettings=$.extend(!0,i,t.promptSettings);var n={lightColor:"#fff",primaryColor:"#00b38a",primaryLightColor:"rgba(0,179,138,0.3)",emphasesColor:"#faa01b",emphasesLightColor:"rgba(250, 160, 27,0.3)",instanceEnable:!1,tgc2Settings:{netChart:{settings:{toolbar:{enabled:!1},info:{enabled:!1},nodeMenu:{},style:{selection:{enabled:!1,fillColor:""},nodeStyleFunction:function(t){e.nodeStyleFunction(t)},nodeHovered:{shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0)"},linkStyleFunction:function(t){t.hovered&&(t.label=t.data.attName),t.toDecoration="arrow",t.fillColor="#ddd"},linkLabel:{textStyle:{fillColor:"#999"}}}}},prompt:{enable:!0,settings:{onPrompt:HieknSDKPrompt.onPromptKnowledge(this.promptSettings)}},page:{enable:!0,style:{right:"15px"},pageSize:20},loader:function(t,i,n){e.loader(t,i,n)}}};this.options=$.extend(!0,{},n,t);var a=this.options.infobox;a&&a.enable&&(this.graphInfobox=this.buildInfobox(a),this.graphInfobox.initEvent($(this.options.selector)),this.options.tgc2Settings.netChart.settings.nodeMenu.contentsFunction=function(t,i,n){return e.contentsFunction(t,i,n)}),this.options.tgc2Settings.selector=this.options.tgc2Settings.selector||this.options.selector,this.init(),t.startInfo&&this.load(t.startInfo)}return t.prototype.buildInfobox=function(t){var e={baseUrl:this.options.baseUrl,dataFilter:this.options.dataFilter,queryData:this.options.queryData,formData:this.options.formData,kgName:this.options.kgName};return $.extend(!0,e,t),new HieknSDKInfobox(e)},t.prototype.contentsFunction=function(t,e,i){var n=this;return e.detail?i(e.detail):this.graphInfobox.load(t.id,function(t){t=t?n.graphInfobox.buildInfobox(t)[0].outerHTML:"没有知识卡片信息",e.detail=t,i(t)}),null},t.prototype.init=function(){this.tgc2=new Tgc2Graph(this.options.tgc2Settings),this.tgc2Prompt=new Tgc2Prompt(this.tgc2,this.options.tgc2Settings.prompt),this.tgc2Page=new Tgc2Page(this.tgc2,this.options.tgc2Settings.page),this.tgc2.init(),$(this.options.tgc2Settings.selector).addClass("tgc2 tgc2-concept-graph"),this.options.instanceEnable&&$(this.options.tgc2Settings.selector).append('<div class="tgc2-info-top"><ul class="info-top"><li class="current"><div class="legend-circle" style="background-color:'+this.options.emphasesColor+'"></div><span>当前节点</span></li><li class="concept"><div class="legend-circle" style="background-color:'+this.options.primaryColor+'"></div><span>概念</span></li><li class="instance"><div class="legend-circle-o" style="border-color:'+this.options.primaryColor+'"></div><span>实例</span></li></ul></div>'),$(this.options.tgc2Settings.selector).append('<div class="tgc2-info-bottom"><div class="info-bottom"><span>中心节点：</span><span name="name" style="color:'+this.options.emphasesColor+'"></span></div></div>')},t.prototype.load=function(t){var e=this;this.tgc2.load(t),setTimeout(function(){e.tgc2.resize()},300)},t.prototype.loader=function(t,e,i){var n=this,a=this.tgc2.startInfo,o=this.tgc2Page.page,s=this.options.queryData||{};s.type=a.kgType||0,s.pageNo=o.pageNo,s.pageSize=o.pageSize,s.kgName=this.options.kgName,s.entityId=a.id,HieknSDKUtils.ajax({url:HieknSDKUtils.buildUrl(this.options.baseUrl+"graph/knowlegde",s),type:"GET",dataFilter:this.options.dataFilter,that:$(this.options.tgc2Settings.selector)[0],success:function(i){if(i=i[0],i.entityList&&i.entityList.length)for(var o=0,s=i.entityList;o<s.length;o++){var r=s[o];r.id==a.id&&$(n.options.tgc2Settings.selector).find(".tgc2-info-bottom").find('[name="name"]').text(r.name)}i.nodes=i.entityList,i.links=i.relationList,delete i.entityList,delete i.relationList,e(i),t.netChart.resetLayout()},error:function(){i&&i(),t.netChart.replaceData({nodes:[],links:[]})}})},t.prototype.nodeStyleFunction=function(t){var e=t.data,i=this.tgc2.startInfo;t.label=e.name,t.labelStyle.textStyle.font="18px Microsoft Yahei",t.radius=15,t.imageCropping="fit";var n=t.id==i.id;0==e.kgType?(t.lineWidth=10,t.lineColor=this.options.primaryLightColor,t.fillColor=this.options.primaryColor,t.image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhENzQwNUZFMTVFQjExRTc4QTJDOTY3REE4RkM4MjFCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhENzQwNUZGMTVFQjExRTc4QTJDOTY3REE4RkM4MjFCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEQ3NDA1RkMxNUVCMTFFNzhBMkM5NjdEQThGQzgyMUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEQ3NDA1RkQxNUVCMTFFNzhBMkM5NjdEQThGQzgyMUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7rBsIlAAAFUklEQVR42uydX05TURDGp5V3ygq8JJJINIGugLICy4PySF0BdQGGsgLqCixviibCCrisgJLoEybUFUjfNfVM7iESUyi1vXNmzvm+ZCJg0p5753fmzPlfGY1GBKWrCgAAAHgLAAACABAAgAAABAAgAAABAAgAxKDM2Zqzdf8zW83/Pk59Z9fOBt749wv/MwAwIHbuC2cNb9mcPpcByL2deEgAgCLtOGt6k9Cxt0MAELa27zpr+59DiCNB19k7q1HBIgDs7D1nrYCOHwdCz9m+NRCsAcA1vqPI8eNA6PiIAADmKM7a39+TvWsT9x5e+38BwIza87XKotrao4FmADjMf/HdOcviruOW1txAKwDWQr7ZJkEjAOz0U8WJ3iwJ4qY2CLQBEKvz1UKgCYDYna8SAi0ApOL82xDUScEkkwYAat7565SW+j4SXKcOAGf7LUpTPd87SBYAHig5oLT1hooJpeQAyJydJ9Tuq8wHQgLAo3xNgli8tmArJQCaHgDor7Y8CEkAcEXzW64Vi7gJWJb+0mqAB23B+XfmRK0UIgBqv6IoIA1Ag4pBH+hu8eBQHmsT0IJ/db0jyQhQ8+G/Bh9PHBdYJqEhYskI0ITzH1xRGjE2ARIPdeTsubMFjm4l2IL//COByhJdE1B29v/Z2UtBoD86e2W9NyAFAE/1npf8HVwzvwkC8MzZ1xI/f5kE5gekmgCJfv+lcFt9KVBposkBJB5mRRiAFQCg62H2hAF4CwCm69qULU4APzhbdfaoxPe16r9nO4J3JpYE5s42FPW1K/f8n5Zl0mcSXWcpALTtPrEAAI8ELgGAdAGYVE4AAAAAAAAw0gs4I0jlO6viPactAKBXUa0HyOHPqdWPCYAB/Jk2AH34U2elkVwQwm3aIrqBD9KQhOYCJJNA5AEPl9gWsWqMDxWBxCqLZBOQUbEuEE3AZC1RhMvCOanBiOBkid5HID0Q1IV/J6onGgoDbA7lSPAYTcBY/SDhjbPV2Ak3JvEIGSICcP+2HzgK8A6f32P+zmsJfwWs/eskfGxciAhwc6lCSD2d8u8S6lCAMwNDHhIVMhf4ROO3dUms9h2nCwp0UGZIACS2i90n3tvHd/x8d/aEin0F24HKUqdA8yWhD4rskPyGDm3aD9kkajgqlslfS9T5Imv/tQOQeQgWE3P+0DeDg9QBuMkH8oQgGPqaH3ydhKYLI1I6PTTIqaDaAWC1qDg+Pmbx8fA9LYXReGkUQ9CNsDngsN8mZUPhmq+NiyknUNPmWwEgJgjUOl87AERxHC1bJ8Wroi3cHcxt5o5R5x+S8uNxLQAQes5gFokc9RY7AEQ6VhFNK/HVPf8jK5tDBwZrv4kyY3dw4gIAAAACAFAZugYA81NuEIA+AEjsZVoss5VxAGtjAcFW+cYMgKURwTqhCSglpPJiiqHiMg59Gc00WZYiwO1IwAtGNpSVi1f4tq3lKxYBuFFGxXRxpiA3ycnoSWiWAYAAAAQAIAAApdENvC0+ZII3lfKpY6PA9tPZARm9F9liBOAXfUr6Rtq4+7dJRiaBLAPAYwC7SsumfhFoDACUfQn1LBK56St1ALQXuAIAym9rtR4oYWIlsPVeQBdlwziAxkTQXAJoGQBWg4pDJUJ3BwdUbF/LMQ4AAQAIAEAAAAIAYcXZ+MYc++Q8wnfsM30AoFw5lbde0OSET0oASIwPmOzvpwKA1MNUYnlhMW0OlRwQaiACpB0BxO71QwSYTicC33GGJFCvyr6QSsUR7wBgMgQd306vzdHxPA7Qjqn2xwoABAAgAAABAAgAQAAAAgAQAIAAAAQAoH/1R4ABAHF3K+2bw1JCAAAAAElFTkSuQmCC",n&&(t.fillColor=this.options.emphasesColor,t.lineColor=this.options.emphasesLightColor)):(t.lineWidth=2,t.lineColor=this.options.primaryColor,t.fillColor=this.options.lightColor,t.image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjA3RUVGNzVBMTVFQzExRTdBM0FERjI5RjczQUM4N0QyIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjA3RUVGNzVCMTVFQzExRTdBM0FERjI5RjczQUM4N0QyIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDdFRUY3NTgxNUVDMTFFN0EzQURGMjlGNzNBQzg3RDIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDdFRUY3NTkxNUVDMTFFN0EzQURGMjlGNzNBQzg3RDIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5z4BZ4AAADHUlEQVR42uzbTU4UQRyG8QYMbLyBK1mKiR8L3RsXfnABWeugO7mIrkwEcc0FJGFhOIExaohLogtvIDGQCP47NAkboGeYwuqu35O8mYR0MdNTz1Qq1XknDg4OKpTLBAEI4FsgAAgAAoAAIAAIAAKAACAACAACgAAgAAgAAoAAIAAIAAKAACAACAACnMTKysq1eHkaeRi52vx5O7IRWY18L3kCBoNBPwWIiZ+Ol1eRF5HJEy7bj7yLLEX+DPkW9f9/HnkSuR653DM3fke2ImuRtyHKXmcEaCZ/PXK/5ZDNZoVoe5NXIh8iNwtZKL5E5kOCX+P+x5OJPvDrISa/5l6zWrT95Zc0+VVzr+vxw5rJXoD4kHPxsjjC0Ho5n2tx3WJhk3/EjXrL0IUVoN7wTY0wbqoZexYLBe8ZF7ogwIPEY28XLMCtLggwm3jsdMECzHRBgPOwV+FCSSHA9jnG/iTJmWcD2QuwcY6xH1tc87lgAba6IMD7yN8RxtVjVltct1awAGvZCzAYDGpLl0cYutzS8Pq6rwVO/rcRv9f/sglcarmcH7HZjGnDbuRxdXg8Wgq18I/ix7XbCQGaBxf1JL2pDh/4nMR+Y/X8kJu7+kz8buRl5FNkp4eTvtPcW32Pd1I8B6i5iMfB9fHus+rwkGe2megfzQqxmmJj0yV6+zh4CEEqAvTrHAAdggAEAAFAABAABAABQAAQAAQAAUAA9JtLqd9AOzhvtIPzRTv4FLSDM98DaAePF+3gY2gHZ74CaAenQzu40g7OXgDt4HRoByN/AbSD054NZC+AdnA6tIMr7eC8BdAOToZ2cIN2cO4CaAePBe3gEtAO1g7u3TkAOgQBCAACgAAgAAgAAoAAIAAIAAKAAOg32sGFox2cL9rBp6AdnPkeQDt4vGgHH0M7OPMVQDs4HdrBlXZw9gJoB6dDOxj5C6AdnPZsIHsBtIPToR1caQfnLYB2cDK0gxu0g3MXQDt4LGgHl0Dx7WBUBAABQAAQAAQAAUAAEAAEAAFAABAABAABQAAQAAQAAUAAEAAEAAFAABAABAABMCT/BBgA8SDQyY7AsYEAAAAASUVORK5CYII=",
n&&(t.fillColor=this.options.lightColor,t.lineColor=this.options.emphasesColor)),t.hovered&&(t.radius=1.25*t.radius)},t}(),HieknSDKConceptTree=function(){function t(t){var e=this;this.isFirst=!0,this.startAsync=!1,this.treeDbClick=!1,this.defaults={getAsyncUrl:function(){var t={};return t.kgName=e.options.kgName,e.options.readAll?t.id=e.getLastSelectedNodeId()||0:t.id=e.getLastSelectedNodeId()||e.options.initId,t.onlySubTree=e.isFirst?0:1,$.extend(!0,t,e.options.queryData),HieknSDKUtils.buildUrl(e.options.baseUrl+"concept",t)},idKey:"id",initId:0,nameKey:"name",onNodeClick:$.noop,nodeHoverTools:{infobox:{enable:!1},graph:{enable:!1,instanceEnable:!1,infobox:{enable:!1}}},instance:{enable:!1,onClick:$.noop},namespace:"hiekn-concept-tree",pIdKey:"parentId",readAll:!1,hiddenIds:{self:[],rec:[]}},this.options=$.extend(!0,{},this.defaults,t),this.init()}return t.prototype.init=function(){var t=this;if(this.$container=$(this.options.container),this.treeId=HieknSDKUtils.randomId(this.options.namespace+"-"),this.$container.addClass("hiekn-concept-tree").append('<ul class="ztree" id="'+this.treeId+'"></ul>'),this.zTreeSettings=this.updateZTreeSettings(),this.zTree=$.fn.zTree.init(this.$container.find(".ztree"),this.zTreeSettings),this.options.nodeHoverTools.graph.enable&&this.buildGraph(),this.options.nodeHoverTools.infobox.enable&&(this.treeInfobox=this.buildInfobox(this.options.nodeHoverTools.infobox)),this.options.instance.enable){var e=HieknSDKUtils.randomId(this.options.namespace+"-prompt-");this.$instanceContainer=$('<div class="hiekn-instance-container"><div class="hiekn-instance-prompt" id="'+e+'"></div><div class="hiekn-instance-list"></div></div>'),this.$container.append(this.$instanceContainer),this.instanceSearchSettings={container:"#"+e,promptEnable:!1,placeholder:"实例搜索",onSearch:function(e){var i={paramName:"kw",url:t.options.baseUrl+"prompt",type:"POST",formData:{kgName:t.options.kgName}};$.extend(!0,i,t.options.instance.searchSettings),i.formData[i.paramName]=e;var n={url:HieknSDKUtils.buildUrl(i.url,i.queryData),dataFilter:i.dataFilter||t.options.dataFilter,data:i.formData,success:function(e,n,a){if(e){var o=t.select(".instance-loader-container");o.attr({"data-more":"0","data-page":"1"}),t.drawInstanceList(e,!1),i.success&&i.success(e,n,a)}}};n=$.extend(!0,{},i,n),HieknSDKUtils.ajax(n)}},this.instanceSearch=new hieknPrompt(this.instanceSearchSettings),this.bindInstanceEvent()}},t.prototype.addHoverDom=function(t,e){var i=this.select("#"+e.tId+"_span");if(!(this.select("#button-container_"+e.tId).length>0)){var n=$('<span class="button-container" id="button-container_'+e.tId+'" ></span>');i.after(n),this.onNodeHover(n,e)}},t.prototype.beforeAsync=function(t,e){return e&&(this.startAsync=!0,this.lastSelectedNode=e),!0},t.prototype.bindInstanceEvent=function(){var t=this;this.select(".hiekn-instance-list").on("scroll",function(e){$(e.target).height()+$(e.target).scrollTop()>$(e.target)[0].scrollHeight-50&&t.loadInstanceService()}),this.select(".hiekn-instance-list").on("click","li[data-id]",function(e){var i=$(e.currentTarget).data("data");$(e.currentTarget).addClass("active").siblings(".active").removeClass("active"),t.options.instance.onClick(i)})},t.prototype.buildInfobox=function(t){var e={baseUrl:this.options.baseUrl,dataFilter:this.options.dataFilter,kgName:this.options.kgName};return $.extend(!0,e,t),new HieknSDKInfobox(e)},t.prototype.buildGraph=function(){var t=HieknSDKUtils.randomId(this.options.namespace+"-tgc2-");this.$graphContainer=$('<div class="modal fade hiekn-concept-tree-graph-modal" id="'+t+'-modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><i class="fa fa-times-circle"></i></button><h4 class="modal-title"><span name="title"></span></h4></div><div class="modal-body"><div class="'+t+'"></div></div></div></div></div>'),$("body").append(this.$graphContainer);var e={selector:"."+t,baseUrl:this.options.baseUrl,dataFilter:this.options.dataFilter,kgName:this.options.kgName,infobox:this.options.nodeHoverTools.graph.infobox,instanceEnable:this.options.nodeHoverTools.graph.instanceEnable,promptSettings:{dataFilter:this.options.dataFilter}};$.extend(!0,e,this.options.nodeHoverTools.graph.conceptGraphSettings),this.tgc2ConceptGraph=new HieknConceptGraphService(e)},t.prototype.dataFilter=function(t,e,i){if(this.options.dataFilter&&(i=this.options.dataFilter(i,void 0)),200==i.code){if(!i.data||!i.data.rsData)return null;i=i.data.rsData;for(var n=i.length,a=[],o=0;o<n;o++)!this.options.readAll&&(i[o].isParent=!0),_.indexOf(this.options.hiddenIds.self,i[o][this.options.idKey])<0&&_.indexOf(this.options.hiddenIds.rec,i[o][this.options.idKey])<0&&_.indexOf(this.options.hiddenIds.rec,i[o][this.options.pIdKey])<0&&(e&&i[o][this.options.idKey]==e[this.options.idKey]||a.push(i[o])),_.indexOf(this.options.hiddenIds.rec,i[o][this.options.pIdKey])>=0&&this.options.hiddenIds.rec.push(i[o][this.options.idKey]);if(0!=a.length)return a;e.isParent=!1}else HieknSDKUtils.error(i.msg);return null},t.prototype.drawInstanceList=function(t,e){var i=this.$instanceContainer.find(".hiekn-instance-list ul"),n=$("<ul></ul>");if(t.length)for(var a=0,o=t;a<o.length;a++){var s=o[a];n.append($('<li data-id="'+s.id+'" title="'+s.name+'">'+s.name+"</li>").data("data",s))}else e||n.append("<li>没有找到相关实例</li>");e?i.append(n.children()):i.empty().append(n.children())},t.prototype.expandNodes=function(t){var e=this.zTree.getNodeByParam(this.options.idKey,t);if(e){this.zTree.expandNode(e,!0,!1,!0,!1);var i=e.getParentNode();i&&this.expandNodes(i[this.options.idKey])}},t.prototype.getAsyncUrl=function(){return"string"==typeof this.options.getAsyncUrl?this.options.getAsyncUrl:this.options.getAsyncUrl(this)},t.prototype.getLastSelectedNodeId=function(){return this.lastSelectedNode?this.lastSelectedNode[this.options.idKey]:null},t.prototype.getLastSelectedInstance=function(){return this.select(".hiekn-instance-list li[data-id].active").data("data")},t.prototype.loadGraph=function(t){this.tgc2ConceptGraph.load({id:t,kgType:0})},t.prototype.reloadInstance=function(){this.select(".hiekn-instance-list").html('<ul></ul><div class="instance-loader-container" data-more="1" data-page="1"></div>'),this.loadInstanceService()},t.prototype.loadInstanceService=function(){var t=this,e=this.select(".instance-loader-container");if("0"!=e.attr("data-more")){if(1!=e.data("inLoading")){e.data("inLoading",1);var i={queryData:{conceptId:this.getLastSelectedNodeId()||this.options.initId,readAll:0,pageNo:e.attr("data-page"),pageSize:15,kgName:this.options.kgName}};$.extend(!0,i,this.options.instance);var n={url:HieknSDKUtils.buildUrl(i.url,i.queryData),dataFilter:i.dataFilter||this.options.dataFilter,success:function(n,a,o,s,r){var l=n;l.length<=r.pageSize&&e.attr({"data-more":0}),l.length>r.pageSize&&l.pop(),t.drawInstanceList(l,1!=r.pageNo),e.attr({"data-page":parseInt(r.pageNo,10)+1}),i.success&&i.success(n,a,o)},complete:function(n,a){e.data("inLoading",0);var o=t.select(".hiekn-instance-list");o.children("ul").height()<o.height()&&t.loadInstanceService(),i.complete&&i.complete(n,a)},that:e[0]};n=$.extend(!0,{},i,n),HieknSDKUtils.ajax(n)}}else console.log("no more instance")},t.prototype.onAsyncSuccess=function(t,e,i){var n=i;n&&this.onNodeClick(n),n&&0==n.children.length?(n.isParent=!1,this.zTree.updateNode(n),HieknSDKUtils.info("当前概念没有子概念")):n||(this.expandNodes(this.getLastSelectedNodeId()||this.options.initId),this.getLastSelectedNodeId()||(n=this.zTree.getNodeByParam(this.options.idKey,this.options.initId),this.zTree.selectNode(n),this.onNodeClick(n)));var a=this.zTree.getNodeByParam(this.options.idKey,this.options.initId);this.addHoverDom(e,a),this.isFirst=!1,this.startAsync=!1},t.prototype.onClick=function(t,e,i){var n=this;this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout(function(){n.lastSelectedNode=i,n.onNodeClick(i),n.treeDbClick=!1},500)},t.prototype.onNodeButtonClick=function(t,e){this.select(".tree-button-active").removeClass("tree-button-active"),this.zTree.selectNode(e),t.addClass("tree-button-active"),this.lastSelectedNode=e},t.prototype.onNodeClick=function(t){this.options.instance.enable&&this.reloadInstance(),this.options.onNodeClick(t)},t.prototype.onNodeHover=function(t,e){var i=this;for(var n in this.options.nodeHoverTools){var a=this.options.nodeHoverTools[n];if("graph"==n&&a.enable){var o=$('<span class="button" title="图谱可视化"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="12"><path d="M892.790083 1009.647551c-58.355904 31.366176-131.161266 9.611215-162.610663-48.591301-24.342972-45.045432-16.764962-98.703426 14.947153-135.21462L698.862198 739.012706c-23.246413 7.764034-48.157246 11.970777-74.066732 11.970777-114.073211 0-208.817925-81.626793-227.545924-188.916672l-96.293279-0.561334c-16.764962 45.964127-60.950442 78.79075-112.82979 78.79075-66.291275 0-120.03249-53.600882-120.03249-119.725715 0-66.119938 53.741215-119.725715 120.03249-119.725715 51.30496 0 95.064544 32.111902 112.242348 77.279717l97.913641 0.567861C419.241111 374.137368 512.680397 295.287873 624.795466 295.287873c18.375534 0 36.248477 2.12948 53.382222 6.132249l39.022512-93.152092c-36.248477-32.934321-49.896729-86.177842-30.174973-134.041367 25.204555-61.154415 95.338684-90.360108 156.651383-65.220824 61.319226 25.132756 90.596716 95.089021 65.398689 156.243437-19.504729 47.334826-65.92086 75.494544-114.326137 74.176062l-39.959157 95.382743c60.924334 41.018186 100.921022 110.062283 100.921022 188.324334 0 70.620402-32.565538 133.736223-83.686106 175.526243l46.409604 87.10796c48.521134-7.086843 98.455394 16.133461 123.065979 61.683114C972.95806 905.658773 951.145986 978.273217 892.790083 1009.647551L892.790083 1009.647551zM892.790083 1009.647551"></path></svg></span>');t.append(o),o.on("click",function(t){i.$graphContainer.modal("show"),i.loadGraph(e[i.options.idKey]),t.stopPropagation()})}else if("infobox"==n&&a.enable){var s=$('<span class="button" title="知识卡片"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="12" height="12"><path d="M638.596211 191.936191q30.628116 0 54.62014 13.272183t41.347956 32.66999 26.544367 41.858425 9.188435 39.81655l0 576.829511q0 29.607178-11.740778 53.088734t-30.628116 39.81655-42.368893 25.52343-46.963111 9.188435l-503.322034 0q-19.397807 0-42.368893-11.230309t-42.879362-29.607178-33.180459-42.368893-13.272183-48.494516l0-568.662014q0-21.439681 10.209372-44.410768t26.544367-42.368893 37.774676-32.159521 44.921236-12.761715l515.57328 0zM578.360917 830.021934q26.544367 0 45.431705-18.376869t18.887338-44.921236-18.887338-45.431705-45.431705-18.887338l-382.851446 0q-26.544367 0-45.431705 18.887338t-18.887338 45.431705 18.887338 44.921236 45.431705 18.376869l382.851446 0zM578.360917 574.787637q26.544367 0 45.431705-18.376869t18.887338-44.921236-18.887338-45.431705-45.431705-18.887338l-382.851446 0q-26.544367 0-45.431705 18.887338t-18.887338 45.431705 18.887338 44.921236 45.431705 18.376869l382.851446 0zM759.0668 0q43.900299 0 80.654038 26.033898t63.808574 64.319043 42.368893 82.695912 15.314058 81.164506l0 542.117647q0 21.439681-12.761715 39.306082t-31.138584 30.628116-39.81655 20.418744-39.81655 7.657029l-4.083749 0 0-609.499501q-8.167498-70.444666-43.900299-108.219342t-94.947159-49.004985l-498.217348 0q1.020937-2.041874 1.020937-7.14656 0-20.418744 12.251246-41.858425t32.159521-38.795613 44.410768-28.586241 49.004985-11.230309l423.688933 0z"></path></svg></span>');t.append(s),s.tooltipster({side:["bottom"],theme:"tooltipster-shadow",distance:16,interactive:!0,trigger:"click",content:"Loading...",functionBefore:function(t,n){var a=$(n.origin);if(a.data("loaded")!==!0){var o=e[i.options.idKey];i.treeInfobox.load(o,function(e){if(e){var n=i.treeInfobox.buildInfobox(e);t.content(n),i.treeInfobox.initEvent(n)}else t.content("没有当前概念的知识卡片信息");a.data("loaded",!0)},function(){t.content("read data failed")})}}}),s.on("click",function(t){t.stopPropagation()})}else a instanceof Function&&a(t,e)}return!0},t.prototype.removeHoverDom=function(t,e){if(e.level>0){var i=this.select("#button-container_"+e.tId);i.children().off("click"),i.remove()}},t.prototype.select=function(t){return $(this.options.container).find(t)},t.prototype.updateZTreeSettings=function(){var t=this;return{async:{enable:!0,url:function(){return t.getAsyncUrl()},dataFilter:function(e,i,n){return t.dataFilter(e,i,n)},type:"get"},view:{showLine:!1,showIcon:!1,expandSpeed:"fast",dblClickExpand:function(t,e){return e.level>0},selectedMulti:!1,addHoverDom:function(e,i){t.addHoverDom(e,i)},removeHoverDom:function(e,i){t.removeHoverDom(e,i)}},callback:{beforeAsync:function(e,i){return t.beforeAsync(e,i)},onAsyncSuccess:function(e,i,n){return t.onAsyncSuccess(e,i,n)},onClick:function(e,i,n){return t.onClick(e,i,n)},onDblClick:function(){t.treeDbClick=!0}},data:{simpleData:{enable:!0,pIdKey:this.options.pIdKey,idKey:this.options.idKey},key:{name:this.options.nameKey}}}},t}(),HieknSDKDisambiguate=function(){function t(){}return t.load=function(e){e=$.extend(!0,{},t.defaults,e);var i=e.queryData||{},n=e.formData||{},a={url:HieknSDKUtils.buildUrl(e.baseUrl+"disambiguate",i),type:"GET",data:n};a=$.extend(!0,{},e,a),HieknSDKUtils.ajax(a)},t}();HieknSDKDisambiguate.defaults={queryData:{useConcept:!0,useEntity:!0,useAttr:!0}};var HieknSDKInfobox=function(){function t(t){this.callback=$.noop,this.defaults={atts:{visible:[],hidden:[]},enableLink:!1,autoLen:!0,onLoad:$.noop,onFailed:$.noop},this.options=$.extend(!0,{},this.defaults,t)}return t.prototype.changeInfobox=function(t){this.load(t,this.callback)},t.prototype.initEvent=function(t){var e=this;t.on("click",".hiekn-infobox-link",function(t){var i=$(t.currentTarget).attr("data-id");e.options.changeInfobox?e.options.changeInfobox(i,e):e.changeInfobox(i)}),t.on("click",".hiekn-infobox-info-detail a",function(t){$(t.currentTarget).closest(".hiekn-infobox-info-detail").toggleClass("on")})},t.prototype.buildEntity=function(t,e){var i=t.meaningTag?"("+t.meaningTag+")":"",n='<span class="hiekn-infobox-name">'+t.name+'<span class="hiekn-infobox-meaningTag">'+i+"</span></span>";return e&&this.options.enableLink?'<a href="javascript:void(0)" class="hiekn-infobox-link" data-id="'+t.id+'">'+n+"</a>":n},t.prototype.buildExtra=function(t){var e=t.v||"-";if(this.options.autoLen){var i="number"==typeof this.options.autoLen?this.options.autoLen:80;t.v.length>i&&(e='<span class="hiekn-infobox-info-detail-short">'+t.v.substring(0,i)+'<a href="javascript:void(0)">查看全部&gt;&gt;</a></span><span class="hiekn-infobox-info-detail-long">'+t.v+'<a href="javascript:void(0)">收起&lt;&lt;</a></span>')}return'<tr><td class="hiekn-infobox-info-label">'+t.k+'</td><td class="hiekn-infobox-info-detail">'+e+"</td></tr>"},t.prototype.load=function(t,e,i){var n=this,a=this.options.queryData||{},o=this.options.formData||{};o.id=t,o.kgName=this.options.kgName,HieknSDKUtils.ajax({url:HieknSDKUtils.buildUrl(this.options.baseUrl+"infobox",a),type:"POST",data:o,dataFilter:this.options.dataFilter,success:function(t){if(t=t[0]){if(e)n.callback=e,e(t);else if(n.options.selector){var a=n.buildInfobox(t);$(n.options.selector).html(a[0].outerHTML),n.initEvent(a)}else console.error("selector or callback can not be null");n.options.onLoad(t)}else i&&i(t)||n.options.onFailed(t)},error:function(t){i&&i(null)||n.options.onFailed(null)}})},t.prototype.buildInfobox=function(t){var e=$('<div class="hiekn-infobox"></div>');if(t.self){e.append('<div class="hiekn-infobox-head"></div><div class="hiekn-infobox-body"></div>');var i=this.buildEntity(t.self,!1);if(e.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-title">'+i+"</div>"),t.self.img){var n=t.self.img;0!=t.self.img.indexOf("http")&&(n=HieknSDKUtils.qiniuImg(this.options.imagePrefix+t.self.img)),e.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-img"><img src="'+n+'" alt=""></div>')}if(t.self.extra){var a="",o=this.options.atts.visible||[],s=this.options.atts.hidden||[];for(var r in t.self.extra)if(t.self.extra.hasOwnProperty(r)){var l=t.self.extra[r];(o.length&&_.indexOf(o,l.k)>=0||s.length&&_.indexOf(s,l.k)<0||!o.length&&!s.length)&&(a+=this.buildExtra(l))}if(t.atts)for(var c in t.atts)if(t.atts.hasOwnProperty(c)){var d=t.atts[c],p="";for(var h in d.v)d.v.hasOwnProperty(h)&&(p+="<li>"+this.buildEntity(d.v[h],!0)+"</li>");o.length&&_.indexOf(o,d.k)>=0?a+='<tr><td class="hiekn-infobox-info-label">'+d.k+'</td><td class="hiekn-infobox-info-detail">'+p+"</td></tr>":s.length&&_.indexOf(s,d.k)<0?a+='<tr><td class="hiekn-infobox-info-label">'+d.k+'</td><td class="hiekn-infobox-info-detail">'+p+"</td></tr>":o.length||s.length||(a+='<tr><td class="hiekn-infobox-info-label">'+d.k+'</td><td class="hiekn-infobox-info-detail">'+p+"</td></tr>")}e.find(".hiekn-infobox-body").append("<table><tbody>"+a+"</tbody></table>")}if(t.pars){e.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">所属：</label><ul></ul></div>');for(var u in t.pars)t.pars.hasOwnProperty(u)&&e.find(".hiekn-infobox-pars ul").append("<li>"+this.buildEntity(t.pars[u],!0)+"</li>")}if(t.sons){var a="";for(var f in t.sons)t.sons.hasOwnProperty(f)&&(a+="<li>"+this.buildEntity(t.sons[f],!0)+"</li>");e.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">相关：</label><ul>'+a+"</ul></div>")}}else e.append("InfoBox读取错误");return e},t.prototype.buildTabInfobox=function(t){var e=$('<div class="hiekn-infobox hiekn-infobox-tab"></div>');if(t.self){e.append('<div class="hiekn-infobox-head"></div><div class="hiekn-infobox-body"><ul class="nav nav-tabs" role="tablist"></ul><div class="tab-content"></div></div>'),e.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-title">'+this.buildEntity(t.self,!1)+"</div>");var i=this.options.atts.visible||[],n=this.options.atts.hidden||[];if(t.self.extra){var a="";for(var o in t.self.extra)if(t.self.extra.hasOwnProperty(o)){var s=t.self.extra[o];(i.length&&_.indexOf(i,s.k)>=0||n.length&&_.indexOf(n,s.k)<0||!i.length&&!n.length)&&(a+=this.buildExtra(s))}var r="hiekn-infobox-"+(new Date).getTime()+"-"+t.self.id;e.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation" class="active"><a href="#'+r+'" role="tab" data-toggle="tab" aria-expanded="true">基本信息</a></li>'),e.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-detail tab-pane active" id="'+r+'"><table><tbody>'+a+"</tbody></table></div>")}if(t.pars){e.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">所属：</label><ul></ul></div>');for(var l in t.pars)t.pars.hasOwnProperty(l)&&e.find(".hiekn-infobox-pars ul").append("<li>"+this.buildEntity(t.pars[l],!0)+"</li>")}if(t.sons){var a="";for(var c in t.sons)t.sons.hasOwnProperty(c)&&(a+="<li>"+this.buildEntity(t.sons[c],!0)+"</li>");var r="hiekn-infobox-"+(new Date).getTime()+"-sons-"+t.self.id;e.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation"><a href="#'+r+'" role="tab" data-toggle="tab" aria-expanded="true">子节点</a></li>'),e.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-sons tab-pane" id="'+r+'"><ul>'+a+"</ul></div>")}if(t.atts)for(var d in t.atts)if(t.atts.hasOwnProperty(d)){var p=t.atts[d],a="";for(var h in p.v)p.v.hasOwnProperty(h)&&(a+="<li>"+this.buildEntity(p.v[h],!0)+"</li>");if(i.length&&_.indexOf(i,p.k)>=0||n.length&&_.indexOf(n,p.k)<0||!i.length&&!n.length){var r="hiekn-infobox-"+(new Date).getTime()+"-att-"+d+"-"+t.self.id;e.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation"><a href="#'+r+'" role="tab" data-toggle="tab" aria-expanded="true">'+p.k+"</a></li>"),e.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-sons tab-pane" id="'+r+'"><ul>'+a+"</ul></div>")}}}else e.append("InfoBox读取错误");return e},t}(),HieknSDKPrompt=function(){function t(t){this.defaults={ready:$.noop,group:!1,replaceSearch:!1,onSearch:$.noop,promptType:0},this.options=$.extend(!0,{},this.defaults,t),this.init()}return t.prototype.init=function(){var e=this,i=$.extend(!0,{kgName:this.options.kgName},this.options,this.options.schemaSetting);i.success=function(i){var n;n=0===e.options.promptType?{drawPromptItem:t.drawPromptItem(i),onPrompt:t.onPrompt(e.options)}:{drawPromptItem:t.drawPromptKnowledgeItem(),onPrompt:t.onPromptKnowledge(e.options)},e.options.group&&(n.drawPromptItems=e.drawPromptItems(i)),e.options.replaceSearch&&(n.beforeSearch=function(t,e){t&&e.find("input[type=text]").val(t.name)}),$.extend(!0,n,e.options),e.instance=new hieknPrompt(n),e.options.ready(e.instance)},HieknSDKSchema.load(i)},t.drawPromptItem=function(t){for(var e={},i=0,n=t.types;i<n.length;i++){var a=n[i];e[a.k]=a.v}return function(t,i){var n=t.name;t.meaningTag&&(n=n+" ( "+t.meaningTag+" )");var a='<span class="prompt-tip-title">'+n.replace(new RegExp("("+i+")","gi"),'<span class="highlight">$1</span>')+"</span>";return a='<span class="prompt-tip-type prompt-tip-'+t.classId+'">'+(t.className||e[t.classId]||"")+"</span>"+a}},t.drawPromptKnowledgeItem=function(){var t={0:"概念",1:"实例"};return function(e,i){var n='<span class="prompt-tip-title">'+e.name.replace(new RegExp("("+i+")","gi"),'<span class="highlight">$1</span>')+"</span>";return n='<span class="prompt-tip-type prompt-tip-'+e.kgType+'">'+(t[e.kgType]||"")+"</span>"+n}},t.prototype.drawPromptItems=function(t){for(var e=this,i={},n=0,a=t.types;n<a.length;n++){var o=a[n];i[o.k]=o.v}return function(t,i){for(var n=$("<div></div>"),a=0,o=t;a<o.length;a++){var s=o[a],r=e.instance.options.drawPromptItem(s,i),l=e.instance.options.drawItemTitle(s),c="prompt-item-"+s.classId,d=$('<li title="'+l+'" class="'+c+'">'+r+"</li>").data("data",s),p=n.find("."+c);p.length?($(p[p.length-1]).after(d),d.find(".prompt-tip-type").empty()):n.append(d)}return n.children()}},t.onPromptStart=function(t){return function(e,i){var n=t.queryData||{},a=t.formData||{};a[t.paramName]=e,a.kgName=t.kgName,HieknSDKUtils.ajax({url:HieknSDKUtils.buildUrl(t.url,n),type:t.type,data:a,dataFilter:t.dataFilter,success:function(n){if(i.prompt==a[t.paramName]){var o=n;t.beforeDrawPrompt&&(o=t.beforeDrawPrompt(o,e)),i.startDrawPromptItems(o,e)}}})}},t.onPrompt=function(e){var i=e;return i.paramName="kw",i.url=e.baseUrl+"prompt",i.type="POST",t.onPromptStart(i)},t.onPromptKnowledge=function(e){var i=e;return i.paramName="text",i.url=e.baseUrl+"prompt/knowledge",i.type="GET",t.onPromptStart(e)},t}(),HieknSDKResource=function(){function t(t){this.options=t,this.init()}return t.prototype.getQuery=function(){var t=[],e=this.tableService.getFilterOptions();for(var i in e){var n=[],a=e[i],o=_.find(this.options.config.filter,["key",i]);if("year"==o.type||"month"==o.type)for(var s=0,r=a;s<r.length;s++){var l=r[s],c="",d="";"year"==o.type?(c=moment(l+"-01-01").format(o.format||"YYYY-MM-DD"),d=moment(parseInt(l,10)+1+"-01-01").format(o.format||"YYYY-MM-DD")):(c=moment(l+"-01").format(o.format||"YYYY-MM"),d=moment(parseInt(l,10)+1+"-01").format(o.format||"YYYY-MM"));var p={};p[i]={from:c,to:d,include_lower:!0,include_upper:!1},n.push({range:p})}else{var p={};p[i]=a,n.push({terms:p})}t.push({bool:{should:n,minimum_should_match:1}})}var h=this.tableService.getFilterKw();if(h){var n=[],u=this.options.config.fieldsKw||this.options.config.fieldsTable||this.options.config.fields,p={query:h,fields:u};n.push({query_string:p}),t.push({bool:{should:n,minimum_should_match:1}})}return{bool:{must:t}}},t.prototype.init=function(){var t=this,e={config:this.options.config,container:this.options.container,load:function(e,i){t.load(e,i)}};this.tableService=new HieknSDKTable(e)},t.prototype.load=function(t,e){var i=this;this.query=this.getQuery(),this.options.beforeLoad&&this.options.beforeLoad(this);var n=this.options.config,a=this.options.queryData||{},o=this.options.formData||{};o.databases=n.databases,o.tables=n.tables,o.fields=n.fields,o.query=JSON.stringify(this.query),o.pageNo=t,o.pageSize=o.pageSize||15;var s=e.getTableContainer();s.empty();var r={url:HieknSDKUtils.buildUrl(this.options.baseUrl+"search",a),type:"POST",data:o,dataFilter:this.options.dataFilter,success:function(t,n,a,o,s){o?(e.drawPage(o.rsCount,s.pageNo,s.pageSize),e.drawData(o.rsData)):e.drawPage(0,s.pageNo,s.pageSize),i.options.onLoad&&i.options.onLoad(o,i)},error:function(t,i,n,a,o){e.drawPage(0,o.pageNo,o.pageSize)},that:s[0]};HieknSDKUtils.ajax(r)},t.prototype.loadData=function(t){this.tableService.loadData(t)},t}(),HieknSDKResources=function(){function t(t){this.resourcesService=[],this.options=t,this.init(this.options.namespace)}return t.prototype.bindEvent=function(){var t=this;this.$headContainer.find(".hiekn-resource-nav-more").on("click",function(){t.$headContainer.find(".hiekn-resource-nav-more-container").toggleClass("hide")}),this.$headContainer.on("shown.bs.tab",'a[data-toggle="tab"]',function(){var e=$(t).attr("href");t.$headContainer.find('.hiekn-resource-nav a[href="'+e+'"]').parent().addClass("active").siblings().removeClass("active"),t.$headContainer.find('.hiekn-resource-nav-hide-tabs a[href="'+e+'"]').parent().addClass("active").siblings().removeClass("active")}),$("body").on("click",function(e){$(e.target).closest(".hiekn-resource-nav-more-container,.hiekn-resource-nav-more").length||t.$headContainer.find(".hiekn-resource-nav-more-container").addClass("hide")}),$(window).on("resize",function(){t.updateTabVisibility()})},t.prototype.init=function(t){var e=this;void 0===t&&(t="hiekn-resource"),this.$container=$(this.options.container),this.$headContainer=$('<div class="hiekn-resource-nav-container"><ul class="hiekn-resource-nav nav nav-tabs" role="tablist"></ul><div class="hiekn-resource-nav-more hide">更多</div><div class="hiekn-resource-nav-more-container hide"><ul class="hiekn-resource-nav-hide-tabs"></ul></div></div>'),this.$bodyContainer=$('<div class="hiekn-resource-container tab-content"></div>'),this.$container.append(this.$headContainer),this.$container.append(this.$bodyContainer);var i=this.select(".hiekn-resource-nav-container ul.hiekn-resource-nav"),n=this.select(".hiekn-resource-nav-container ul.hiekn-resource-nav-hide-tabs"),a=0;for(var o in this.options.configs){var s="0"==o?"active":"",r=t+"-tab-"+o+"-"+(new Date).getTime(),l=$('<div role="tabpanel" class="tab-pane '+s+'" id="'+r+'"></div>');this.$bodyContainer.append(l);var c=$.extend(!0,{},this.options);c.config=this.options.configs[o],c.container=l,c.onLoad=function(t,i){var n=i.tableService.$container.attr("id");e.$headContainer.find('a[href="#'+n+'"] .res-count').text(t.rsCount||0),e.options.onLoad&&e.options.onLoad(t,i)},delete c.namespace,delete c.configs,this.resourcesService.push(new HieknSDKResource(c));var d='<li role="presentation" class="'+s+'"><a href="#'+r+'" aria-controls="" role="tab" data-toggle="tab"><span class="res-name" title="'+c.config.name+'">'+c.config.name+'</span><span class="res-count"></span></a></li>';i.append(d),n.append(d),a+=i.find("li:last-child").width()}i.css("width",a),this.updateTabVisibility(),this.bindEvent()},t.prototype.loadData=function(t){for(var e=0,i=this.resourcesService;e<i.length;e++){var n=i[e];n.loadData(t)}},t.prototype.select=function(t){return this.$container.find(t)},t.prototype.updateTabVisibility=function(){var t=this.$headContainer,e=t.width(),i=t.find(".nav"),n=i.width(),a=t.find(".hiekn-resource-nav-more");e<n?a.removeClass("hide"):(a.addClass("hide"),t.find(".hiekn-resource-nav-more-container").addClass("hide"));var o=0,s=a.outerWidth(),r=t.find(".hiekn-resource-nav-hide-tabs>li");i.find("li").each(function(t,i){$(i).removeClass("hide"),o+=$(i).width(),o>=e-s?($(i).addClass("hide"),$(r.get(t)).removeClass("hide")):$(r.get(t)).addClass("hide")})},t}(),HieknSDKSchema=function(){function t(){}return t.load=function(t){var e=t.queryData||{},i=$.extend(!0,{kgName:t.kgName},t.formData),n={url:HieknSDKUtils.buildUrl(t.baseUrl+"schema",e),type:"POST",data:i,beforeSend:function(){t.that&&$(t.that).find(".ajax-loading").html(HieknSDKUtils.loadingHTML)},success:function(e,i,n){t.success(e[0],i,n)}};n=$.extend(!0,{},t,n),HieknSDKUtils.ajax(n)},t}(),HieknSDKSegment=function(){function t(){}return t.load=function(e){e=$.extend(!0,t.defaults,e);var i=e.queryData||{},n=e.formData||{},a={url:HieknSDKUtils.buildUrl(e.baseUrl+"segment",i),type:"GET",data:n};a=$.extend(!0,{},e,a),HieknSDKUtils.ajax(a)},t}();HieknSDKSegment.defaults={queryData:{useConcept:!0,useEntity:!0,useAttr:!0}};var HieknSDKTable=function(){function t(t){this.options=t,this.init()}return t.prototype.buildFilter=function(){for(var t="",e=this.options.config.filter,i=0,n=e;i<n.length;i++){for(var a=n[i],o=a.label||a.key,s="",r=0,l=a.options;r<l.length;r++){var c=l[r];if(c instanceof Object)if(void 0!==c.key&&void 0!==c.value){var d=c;s+='<span option-value="'+d.value+'" option-key="'+d.key+'">'+d.key+"</span>"}else{var d=c;for(var p in d)s+='<span option-value="'+d[p]+'" option-key="'+p+'">'+d[p]+"</span>"}else s+='<span option-value="'+c+'" option-key="'+a.key+'">'+c+"</span>"}t+='<div class="hiekn-table-filter-item"><div class="hiekn-table-filter-item-label">'+o+'：</div><div class="hiekn-table-filter-item-content">'+s+'<div class="hiekn-table-more-container"><span class="hiekn-table-filter-more">更多 <svg height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/></svg></span><span class="hiekn-table-filter-less">收起 <svg height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/></svg></span><span class="hiekn-table-filter-multi"><svg height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg> 多选</span><button class="btn btn-primary hiekn-table-btn-confirm">确定</button><button class="btn btn-primary-outline hiekn-table-btn-cancel">取消</button></div></div></div>'}t+='<div class="hiekn-table-filter-item hiekn-table-filter-item-kw"><div class="hiekn-table-filter-item-label">关键词：</div><div class="hiekn-table-filter-item-content"><div class="hiekn-table-search-kw-container"><input type="text"><button class="btn btn-primary hiekn-table-btn-confirm">确定</button></div></div></div>',this.select(".hiekn-table-filter").html(t)},t.prototype.bindFilterEvent=function(){var t=this;this.select(".hiekn-table-filter").on("click","span[option-value]",function(e){var i=$(e.currentTarget);i.attr("option-key"),i.attr("option-value");i.closest(".hiekn-table-filter-item").hasClass("multi")?i.toggleClass("active"):(i.hasClass("active")?i.removeClass("active"):i.addClass("active").siblings(".active").removeClass("active"),t.loadData(1))}),this.select(".hiekn-table-filter").on("click",".hiekn-table-filter-more",function(t){var e=$(t.currentTarget);e.closest(".hiekn-table-filter-item").addClass("expend")}),this.select(".hiekn-table-filter").on("click",".hiekn-table-filter-less",function(t){var e=$(t.currentTarget);e.closest(".hiekn-table-filter-item").removeClass("expend")}),this.select(".hiekn-table-filter").on("click",".hiekn-table-filter-multi",function(t){var e=$(t.currentTarget);e.closest(".hiekn-table-filter-item").addClass("multi")}),this.select(".hiekn-table-filter").on("click",".hiekn-table-btn-confirm",function(e){var i=$(e.currentTarget);i.closest(".hiekn-table-filter-item").removeClass("multi"),t.loadData(1)}),this.select(".hiekn-table-filter").on("click",".hiekn-table-btn-cancel",function(t){var e=$(t.currentTarget);e.closest(".hiekn-table-filter-item").removeClass("multi")}),this.select(".hiekn-table-search-kw-container").on("keydown","input",function(e){var i=window.event?e.keyCode:e.which;13==i&&t.loadData(1)})},t.prototype.bindTableEvent=function(){this.select(".hiekn-table-content").on("click",".hiekn-table-data-angle",function(t){
$(t.currentTarget).toggleClass("on").closest("tr").next("tr.hiekn-table-detail-line").toggleClass("hide")})},t.dealContent=function(t,e){if(void 0===e&&(e=80),t){var i=$("<div>"+t+"</div>").text();return i.length>e?i.substring(0,e)+"...":i}return""},t.prototype.drawData=function(e){var i=this.options.config;this.data=e;var n="<thead><tr>",a="<tbody>",o=i.fieldsTable||i.fields,s=i.fieldsTableName?i.fieldsTableName:i.fieldsName?i.fieldsName:o,r=i.drawDetail||i.fieldsDetail||i.fieldsTable,l=i.fieldsDetail||i.fields,c=i.fieldsDetailName?i.fieldsDetailName:i.fieldsName?i.fieldsName:o,d=i.fieldsRenderer||{},p={};r&&(n+="<th></th>");for(var h in o){var u=d[o[h]];if(u&&u instanceof Object&&"link"==u.type&&u.fields)for(var f=0,g=u.fields;f<g.length;f++){var v=g[f];p[v]=o[h]}else n+="<th>"+s[h]+"</th>"}for(var m=0,b=e;m<b.length;m++){var y=b[m],k="<tr>";r&&(k+='<td class="hiekn-table-data-angle"><svg height="20" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg></td>');for(var S=0,A=0,D=o;A<D.length;A++){var x=D[A];S++,d[x]&&d[x].fields||(k+="<td>"+t.rendererFields(y,x,p,d,!0)+"</td>")}if(k+="</tr>",a+=k,r){var C='<tr class="hiekn-table-detail-line hide"><td colspan="'+(S+1)+'">';for(var w in l){var x=l[w];d[x]&&d[x].fields||(C+='<div class="hiekn-table-detail-'+x+'"><label>'+c[w]+":</label>"+t.rendererFields(y,x,p,d,!1)+"</div>")}C+="</td></tr>",a+=C}}a+="</body>",n+="</tr></thead>",this.select(".hiekn-table-content").html('<table class="hiekn-table-normal">'+n+a+"</table>")},t.prototype.drawPage=function(t,e,i){var n=this,a={totalItem:t,pageSize:i,current:e,selector:this.select(".pagination"),callback:function(t,e){n.loadData(e)}};HieknSDKUtils.drawPagination(a)},t.prototype.getFilterKw=function(){return this.select(".hiekn-table-search-kw-container").find("input").val()},t.prototype.getFilterOptions=function(){var t={};return this.select(".hiekn-table-filter-item").each(function(e,i){var n="",a=$(i).find("span[option-value].active");if(a.length){var o=!1,s=[];a.each(function(t,e){var i=$(e).attr("option-value");i?(n=$(e).attr("option-key"),s.push(i)):o=!0}),o||(t[n]=s)}}),t},t.prototype.getTableContainer=function(){return this.select(".hiekn-table-content")},t.getValues=function(t){var e=[];if(t instanceof Array)e=t;else if("string"==typeof t)if(0==t.indexOf("["))try{e=JSON.parse(t)}catch(i){e=[t]}else e=t.split(",");return e},t.prototype.init=function(){this.$container=$(this.options.container).addClass("hiekn-table"),this.$container.append('<div class="hiekn-table-filter"></div><div class="hiekn-table-content"></div><div class="hiekn-table-page"><div class="pagination-outter"><ul class="pagination"></ul></div></div>'),this.buildFilter(),this.bindFilterEvent(),this.bindTableEvent()},t.prototype.loadData=function(t){this.options.load(t,this)},t.rendererDate=function(t){return moment(t).format("YYYYMMDD")},t.rendererDateTime=function(t){return moment(t).format("YYYY-MM-DD HH:mm:ss")},t.rendererFields=function(e,i,n,a,o){var s="";if(e[i]){for(var r=t.getValues(e[i]),l=0,c=r;l<c.length;l++){var d=c[l];s+=a[i]?","+t.rendererValue(a[i].type||a[i],d,a[i],o,e):","+t.rendererValue("string",d,void 0,o,e)}s=s.substring(1)}if(n[i]){var p=e[i];e[i]||(p="链接"),s=t.rendererLink(e[n[i]],p)}return s},t.rendererLink=function(t,e,i){return void 0===e&&(e="查看"),void 0===i&&(i=""),t?'<a href="'+t+'" target="_blank" class="'+i+'">'+e+"</a>":""},t.rendererValue=function(e,i,n,a,o){var s="";try{s="year"==e?t.rendererYear(i):"date"==e?t.rendererDate(i):"dateTime"==e?t.rendererDateTime(i):"json"==e?JSON.stringify(i):"link"==e?t.rendererLink(i,n.name,"hiekn-table-btn-link"):"string"==e&&a?t.dealContent(i):e instanceof Function?e(i,o):HieknSDKUtils.safeHTML(i)}catch(r){}return s},t.rendererYear=function(t){return moment(t).format("YYYY")},t.prototype.select=function(t){return this.$container.find(t)},t}(),HieknSDKTagging=function(){function t(){}return t.load=function(t){var e=t.queryData||{},i=t.formData||{},n={url:HieknSDKUtils.buildUrl(t.baseUrl+"tagging",e),type:"GET",data:i};n=$.extend(!0,{},t,n),HieknSDKUtils.ajax(n)},t}(),HieknSDKUtils=function(){function t(){}return t.ajax=function(e){var i=e.error||$.noop,n=e.type;switch(n){case"GET":n=0;break;case"POST":n=1}var a={type:n,dataFilter:e.dataFilter||t.dataFilter,params:e.data,success:function(t,n,a,o){t&&t.rsData?e.success(t.rsData,n,a,t,o):i(t,n,a,null,o)},error:function(t,e,n){i(null,e,t,n)}};a=$.extend(!0,{},e,a),hieknjs.kgLoader(a)},t.buildUrl=function(t,e){if(e&&!$.isEmptyObject(e)){var i=t.indexOf("?")>0?"&":"?";return t+i+$.param(e)}return t},t.dataFilter=function(t){return t},t.drawPagination=function(t){$.extend(!0,t,{data:Math.ceil(t.totalItem/t.pageSize),cur:t.current,p:t.selector,event:t.callback}),hieknjs.gentPage(t)},t.error=function(t){toastr.error(t)},t.info=function(t){toastr.info(t)},t.qiniuImg=function(t){return t+"?_="+Math.floor((new Date).getTime()/36e5)},t.randomId=function(t,e,i){return void 0===t&&(t=""),void 0===e&&(e=""),void 0===i&&(i=""),t+(i?i:(new Date).getTime()+Math.ceil(1e4*Math.random()))+e},t.safeHTML=function(t){return hieknjs.safeHTML(t)},t.dealNull=function(t){return hieknjs.dealNull(t)},t}();HieknSDKUtils.regChinese=/^[\u4e00-\u9fa5]$/,HieknSDKUtils.regEnglish=/^[a-zA-Z]$/,HieknSDKUtils.colorBase=["#7bc0e1","#9ec683","#fde14d","#ab89f4","#e26f63","#dca8c6","#596690","#eaad84","#abe8bf","#7979fc"],HieknSDKUtils.colorEx=["#6db5d6","#d0648a","#c0d684","#f2bac9","#847d99","#baf2d8","#bfb3de","#f4817c","#94cdba","#b2cede"],HieknSDKUtils.color=HieknSDKUtils.colorBase.concat(HieknSDKUtils.colorEx),HieknSDKUtils.loadingHTML='<div class="schema-init">\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 14 32 18" width="32" height="4" preserveAspectRatio="none">\n        <path opacity="0.8" transform="translate(0 0)" d="M2 14 V18 H6 V14z">\n        <animateTransform attributeName="transform" type="translate" values="0 0; 24 0; 0 0" dur="2s" begin="0" repeatCount="indefinite" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" /></path>\n        <path opacity="0.5" transform="translate(0 0)" d="M0 14 V18 H8 V14z">\n        <animateTransform attributeName="transform" type="translate" values="0 0; 24 0; 0 0" dur="2s" begin="0.1s" repeatCount="indefinite" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" /></path>\n        <path opacity="0.25" transform="translate(0 0)" d="M0 14 V18 H8 V14z">\n        <animateTransform attributeName="transform" type="translate" values="0 0; 24 0; 0 0" dur="2s" begin="0.2s" repeatCount="indefinite"\n         keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" /></path>\n        </svg>\n        </div>';var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),HieknSDKService=function(){function t(){}return t.prototype.schema=function(t,e){var i=$.extend(!0,{},t,{queryData:t.data||{},formData:t.data2||{},success:e});HieknSDKSchema.load(i)},t.prototype.association=function(t,e){var i=$.extend(!0,{},t.data2||{},{allowAtts:t.allowAtts,id:t.id,pageSize:t.pageSize}),n={queryData:t.data||{},formData:i,success:e};n=$.extend(!0,{},t,n),HieknSDKAssociation.load(n)},t.prototype.tagging=function(t,e){var i=$.extend(!0,{},t.data||{},{kw:t.kw}),n={queryData:i,formData:t.data2||{},success:e};n=$.extend(!0,{},t,n),HieknSDKTagging.load(n)},t.prototype.disambiguate=function(t,e){var i=$.extend(!0,{},t.data||{},{kw:t.kw}),n={queryData:i,formData:t.data2||{},success:e};n=$.extend(!0,{},t,n),HieknSDKDisambiguate.load(n)},t.prototype.segment=function(t,e){var i=$.extend(!0,{},t.data||{},{kw:t.kw}),n={queryData:i,formData:t.data2||{},success:e};n=$.extend(!0,{},t,n),HieknSDKSegment.load(n)},t.updateOptionsData=function(t){return t.formData=t.formData||t.data2||{},t.queryData=t.queryData||t.data||{},t},t}(),HieknNetChartUpdateService=function(){function t(){}return t.updateOptions=function(t){return t=HieknSDKService.updateOptionsData(t),void 0!=t.enableAutoUpdateStyle&&(t.autoUpdateStyle=t.enableAutoUpdateStyle),t},t}(),HieknGraphService=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.beforeInit=function(e){t.prototype.beforeInit.call(this,HieknNetChartUpdateService.updateOptions(e))},e}(HieknSDKGraph),HieknTimingGraphService=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.beforeInit=function(e){t.prototype.beforeInit.call(this,HieknNetChartUpdateService.updateOptions(e))},e}(HieknSDKTiming),HieknPathService=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.beforeInit=function(e){t.prototype.beforeInit.call(this,HieknNetChartUpdateService.updateOptions(e))},e}(HieknSDKPath),HieknRelationService=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.beforeInit=function(e){t.prototype.beforeInit.call(this,HieknNetChartUpdateService.updateOptions(e))},e}(HieknSDKRelation),HieknInfoboxService=function(t){function e(e){var i=this;return e=HieknSDKService.updateOptionsData(e),e.changeInfobox=e.href,i=t.call(this,e)||this}return __extends(e,t),e}(HieknSDKInfobox),HieknPromptService=function(t){function e(e){var i=this;return e=HieknSDKService.updateOptionsData(e),e.promptType=0,i=t.call(this,e)||this}return __extends(e,t),e}(HieknSDKPrompt),HieknConceptPromptService=function(t){function e(e){var i=this;return e=HieknSDKService.updateOptionsData(e),e.promptType=1,i=t.call(this,e)||this}return __extends(e,t),e}(HieknSDKPrompt),HieknConceptGraphService=function(t){function e(e){var i=this;return e=HieknSDKService.updateOptionsData(e),i=t.call(this,e)||this}return __extends(e,t),e}(HieknSDKConceptGraph),HieknTableService=function(t){function e(e){var i=this;return e=HieknSDKService.updateOptionsData(e),i=t.call(this,e)||this}return __extends(e,t),e}(HieknSDKTable),HieknResourceService=function(t){function e(e){var i=this;return e=HieknSDKService.updateOptionsData(e),i=t.call(this,e)||this}return __extends(e,t),e}(HieknSDKResource),HieknResourcesService=function(t){function e(e){var i=this;return e=HieknSDKService.updateOptionsData(e),i=t.call(this,e)||this}return __extends(e,t),e}(HieknSDKResources),HieknConceptTreeService=function(t){function e(e){var i=this;return e=HieknSDKService.updateOptionsData(e),i=t.call(this,e)||this}return __extends(e,t),e}(HieknSDKConceptTree),HieknStatService=function(){function t(t){t=HieknSDKService.updateOptionsData(t),$.extend(!0,t.formData,t.config.querySettings),t.formDataUpdater=t.beforeLoad;var e=t.config.type;return"pie"==e?new HieknSDKStatPie(t):"line"==e||"bar"==e?new HieknSDKStatLineBar(t):"wordCloud"==e?new HieknSDKStatWordCloud(t):void 0}return t}();