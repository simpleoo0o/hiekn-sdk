/**
     * @author: 
     *    jiangrun002
     * @version: 
     *    v0.5.6
     * @license:
     *    Copyright 2017, jiangrun. All rights reserved.
     */

!function(e,t){"use strict";function n(){var e=function(e){var n=this;n.clickTimeout=null,n.isFirst=!0,n.lastSelectedNode=null,n.startAsync=!1,n.treeDbClick=!1;var i={container:null,data:null,baseUrl:null,kgName:null,getAsyncUrl:function(){var e=n.options.data||{};return e.kgName=n.options.kgName,n.options.readAll?e.id=n.getLastSelectedNodeId()||0:e.id=n.getLastSelectedNodeId()||n.options.initId,e.onlySubTree=n.isFirst?0:1,n.options.baseUrl+"concept?"+t.param(e)},idKey:"id",initId:0,nameKey:"name",onNodeClick:t.noop,onNodeHover:t.noop,pIdKey:"parentId",readAll:!1};n.options=t.extend(!0,{},i,e),n.zTreeSettings=null,n.zTree=null,n.init()};return e.prototype.init=function(){var e=this;e.$container=t(e.options.container),e.$container.addClass("ztree hiekn-concept-tree"),e.zTreeSettings=e.updateZTreeSettings(),e.zTree=t.fn.zTree.init(e.$container,e.zTreeSettings)},e.prototype.addHoverDom=function(e,n){var i=this,a=i.select("#"+n.tId+"_span");if(!(i.select("#button-container_"+n.tId).length>0)){var o=t('<span class="button-container" id="button-container_'+n.tId+'" ></span>');a.after(o),i.options.onNodeHover&&i.options.onNodeHover(o,n)}},e.prototype.beforeAsync=function(e,t){var n=this;return t&&(n.startAsync=!0,n.lastSelectedNode=t),!0},e.prototype.dataFilter=function(e,t,n){var i=this;if(200==n.code){if(!n.data||!n.data.rsData)return null;n=n.data.rsData;for(var a=n.length,o=[],s=0;s<a;s++)!i.options.readAll&&(n[s].isParent=!0),t&&n[s][i.options.idKey]==t[i.options.idKey]||o.push(n[s]);if(0!=o.length)return o;t.isParent=!1}else toastr.error(n.msg);return null},e.prototype.expandNodes=function(e){var t=this,n=t.zTree.getNodeByParam(t.options.idKey,e);if(n){t.zTree.expandNode(n,!0,!1,!0,!1);var i=n.getParentNode();i&&t.expandNodes(i[t.options.idKey])}},e.prototype.getLastSelectedNodeId=function(){var e=this;return e.lastSelectedNode?e.lastSelectedNode[e.options.idKey]:null},e.prototype.getAsyncUrl=function(){var e=this;return"string"==typeof e.options.getAsyncUrl?e.options.getAsyncUrl:e.options.getAsyncUrl(e)},e.prototype.onAsyncSuccess=function(e,t,n){var i=this,a=n;a&&i.options.onNodeClick(a),a&&0==a.children.length?(a.isParent=!1,i.zTree.updateNode(a),toastr.info("当前概念没有子概念")):a||(i.expandNodes(i.getLastSelectedNodeId()||i.options.initId),i.getLastSelectedNodeId()||(a=i.zTree.getNodeByParam(i.options.idKey,i.options.initId),i.zTree.selectNode(a),i.options.onNodeClick(a)));var o=i.zTree.getNodeByParam(i.options.idKey,0);i.addHoverDom(t,o),i.isFirst=!1,i.startAsync=!1},e.prototype.onClick=function(e,t,n){var i=this;i.clickTimeout&&clearTimeout(i.clickTimeout),i.clickTimeout=setTimeout(function(){i.lastSelectedNode=n,i.options.onNodeClick(n),i.treeDbClick=!1},500)},e.prototype.onNodeButtonClick=function(e,t){var n=this;n.select(".tree-button-active").removeClass("tree-button-active"),n.zTree.selectNode(t),e.addClass("tree-button-active"),n.lastSelectedNode=t},e.prototype.removeHoverDom=function(e,t){var n=this;if(t.level>0){var i=n.select("#button-container_"+t.tId);i.children().off("click"),i.remove()}},e.prototype.select=function(e){var n=this;return t(n.options.container).find(e)},e.prototype.updateZTreeSettings=function(){var e=this;return{async:{enable:!0,url:function(){return e.getAsyncUrl()},dataFilter:function(t,n,i){return e.dataFilter(t,n,i)},type:"get"},view:{showLine:!1,showIcon:!1,expandSpeed:"fast",dblClickExpand:function(e,t){return t.level>0},selectedMulti:!1,addHoverDom:function(t,n){e.addHoverDom(t,n)},removeHoverDom:function(t,n){e.removeHoverDom(t,n)}},callback:{beforeAsync:function(t,n){return e.beforeAsync(t,n)},onAsyncSuccess:function(t,n,i){return e.onAsyncSuccess(t,n,i)},onClick:function(t,n,i){return e.onClick(t,n,i)},onDblClick:function(){e.treeDbClick=!0}},data:{simpleData:{enable:!0,pIdKey:e.options.pIdKey,idKey:e.options.idKey},key:{name:e.options.nameKey}}}},e}e.HieknConceptTreeService=n()}(window,jQuery),function(e,t){"use strict";function n(){var n=function(n){var i=this;i.isInit=!1,i.baseSettings={baseUrl:n.baseUrl,data:n.data,kgName:n.kgName},i.filterSettings={selectedAtts:n.selectedAtts,selectedTypes:n.selectedTypes},i.infoboxSettings={selector:n.selector,imagePrefix:n.imagePrefix},t.extend(!0,i.infoboxSettings,i.baseSettings),i.loaderSettings={selector:n.selector,tgc2:null,tgc2Filter:null,tgc2Page:null},t.extend(!0,i.loaderSettings,i.baseSettings),i.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof n.enableAutoUpdateStyle||n.enableAutoUpdateStyle,imagePrefix:n.imagePrefix,images:n.images,nodeColors:n.nodeColors,minRadius:n.minRadius||10,tgc2:null},i.promptSettings=i.baseSettings,i.schemaSettings=i.baseSettings,i.tgc2Settings={},i.sdkUtils=new e.HieknSDKService,i.sdkUtils.schema(i.schemaSettings,function(e){var a=i.sdkUtils.buildFilter(e,i.filterSettings);a=[{key:"distance",label:"设定显示层数",selected:n.selectedDistance||1,options:[1,2,3]}].concat(a);var o={selector:n.selector,prompt:{enable:!0,style:{left:"20px",top:"40px"},settings:{drawPromptItem:i.sdkUtils.drawPromptItem(e),onPrompt:i.sdkUtils.onPrompt(i.promptSettings)}},page:{style:{right:"10px",bottom:"20px"},enable:!0,pageSize:20},filter:{enable:!0,filters:a},crumb:{enable:!0},find:{enable:!0},legend:{enable:!0,data:n.nodeColors||[],onDraw:i.sdkUtils.legend(e)},netChart:{settings:{nodeMenu:{contentsFunction:i.sdkUtils.infobox()},style:{nodeStyleFunction:i.sdkUtils.nodeStyleFunction(i.nodeSettings)},info:{linkContentsFunction:i.sdkUtils.linkContentsFunction}}},loader:i.sdkUtils.graph(i.loaderSettings,e)};i.tgc2Settings=t.extend(!0,{},o,n.tgc2Settings),i.sdkUtils.gentInfobox(i.infoboxSettings),i.init()})};return n.prototype.init=function(){var e=this;e.tgc2=new Tgc2Graph(e.tgc2Settings),e.tgc2Filter=new Tgc2Filter(e.tgc2,e.tgc2Settings.filter),e.tgc2Prompt=new Tgc2Prompt(e.tgc2,e.tgc2Settings.prompt),e.tgc2Page=new Tgc2Page(e.tgc2,e.tgc2Settings.page),e.tgc2Crumb=new Tgc2Crumb(e.tgc2,e.tgc2Settings.crumb),e.tgc2Find=new Tgc2Find(e.tgc2,e.tgc2Settings.find),e.tgc2Legend=new Tgc2Legend(e.tgc2,e.tgc2Settings.legend),e.loaderSettings.tgc2=e.tgc2,e.loaderSettings.tgc2Filter=e.tgc2Filter,e.loaderSettings.tgc2Page=e.tgc2Page,e.nodeSettings.tgc2=e.tgc2,e.tgc2.init(),e.isInit=!0},n.prototype.load=function(e){var t=this;setTimeout(function(){t.isInit?t.tgc2.load(e):t.load(e)},30)},n}e.HieknGraphService=n()}(window,jQuery),function(e,t){"use strict";function n(){var e=function(e){var n=this,i={selector:null,data:null,baseUrl:null,kgName:null,enableLink:!1,imagePrefix:null,href:null};n.settings=t.extend(!0,{},i,e)};return e.prototype.href=function(e){var t=this;t.load(e,t.callback)},e.prototype.initEvent=function(e){var n=this;e.on("click",".hiekn-infobox-link",function(){var e=t(this).attr("data-id");n.settings.href?n.settings.href(e,n):n.href(e)}),e.on("click",".hiekn-infobox-info-detail a",function(){t(this).closest(".hiekn-infobox-info-detail").toggleClass("on")})},e.prototype.buildEntity=function(e,t){var n=this,i=e.meaningTag?"("+e.meaningTag+")":"",a='<span class="hiekn-infobox-name">'+e.name+'<span class="hiekn-infobox-meaningTag">'+i+"</span></span>";return t&&n.settings.enableLink?'<a href="javascript:void(0)" class="hiekn-infobox-link" data-id="'+e.id+'">'+a+"</a>":a},e.prototype.buildExtra=function(e){var t=e.v||"-";return e.v.length>80&&(t='<span class="hiekn-infobox-info-detail-short">'+e.v.substring(0,56)+'<a href="javascript:void(0)">查看全部&gt;&gt;</a></span><span class="hiekn-infobox-info-detail-long">'+e.v+'<a href="javascript:void(0)">收起&lt;&lt;</a></span>'),'<tr><td class="hiekn-infobox-info-label">'+e.k+'</td><td class="hiekn-infobox-info-detail">'+t+"</td></tr>"},e.prototype.load=function(e,n,i){var a=this,o=a.settings.data||{};o.id=e,o.kgName=a.settings.kgName,hieknjs.kgLoader({url:a.settings.baseUrl+"infobox",type:1,params:o,success:function(e){if(e&&e.rsData&&e.rsData.length){var o=e.rsData[0];if(n)a.callback=n,n(o);else if(a.settings.selector){var s=a.buildInfobox(o);t(a.settings.selector).html(s),a.initEvent(s)}else console.error("selector or callback must be config")}else i&&i()},error:function(){toastr.error("网络接口错误！"),i&&i()}})},e.prototype.buildInfobox=function(e){var n=this,i=t('<div class="hiekn-infobox"></div>');if(e.self){i.append('<div class="hiekn-infobox-head"></div><div class="hiekn-infobox-body"></div>');var a=n.buildEntity(e.self,!1);if(i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-title">'+a+"</div>"),e.self.img){var o=e.self.img;0!=e.self.img.indexOf("http")&&(o=n.settings.imagePrefix+e.self.img+"?_="+Math.round(new Date/36e5)),i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-img"><img src="'+o+'" alt=""></div>')}if(e.self.extra){var s="";for(var r in e.self.extra){var l=e.self.extra[r];s+=n.buildExtra(l)}if(e.atts)for(var d in e.atts)if(e.atts.hasOwnProperty(d)){var c=e.atts[d],g="";for(var f in c.v){var p=c.v[f],a=n.buildEntity(p,!0);g+="<li>"+a+"</li>"}s+='<tr><td class="hiekn-infobox-info-label">'+c.k+'</td><td class="hiekn-infobox-info-detail">'+g+"</td></tr>"}i.find(".hiekn-infobox-body").append("<table><tbody>"+s+"</tbody></table>")}if(e.pars){i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">所属：</label><ul></ul></div>');for(var u in e.pars){var p=e.pars[u],a=n.buildEntity(p,!0);i.find(".hiekn-infobox-pars ul").append("<li>"+a+"</li>")}}if(e.sons){var s="";for(var b in e.sons){var p=e.sons[b],a=n.buildEntity(p,!0);s+="<li>"+a+"</li>"}i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">相关：</label><ul>'+s+"</ul></div>")}}else i.append("InfoBox读取错误");return i},e.prototype.buildTabInfobox=function(e){var n=this,i=t('<div class="hiekn-infobox hiekn-infobox-tab"></div>');if(e.self){i.append('<div class="hiekn-infobox-head"></div><div class="hiekn-infobox-body"><ul class="nav nav-tabs" role="tablist"></ul><div class="tab-content"></div></div>');var a=n.buildEntity(e.self,!1);if(i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-title">'+a+"</div>"),e.self.extra){var o="";for(var s in e.self.extra){var r=e.self.extra[s];o+=n.buildExtra(r)}var l="hiekn-infobox-"+(new Date).getTime()+"-"+e.self.id;i.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation" class="active"><a href="#'+l+'" role="tab" data-toggle="tab" aria-expanded="true">基本信息</a></li>'),i.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-detail tab-pane active" id="'+l+'"><table><tbody>'+o+"</tbody></table></div>")}if(e.pars){i.find(".hiekn-infobox-head").append('<div class="hiekn-infobox-pars"><label class="hiekn-infobox-label">所属：</label><ul></ul></div>');for(var d in e.pars){var c=e.pars[d],a=n.buildEntity(c,!0);i.find(".hiekn-infobox-pars ul").append("<li>"+a+"</li>")}}if(e.sons){var o="";for(var g in e.sons){var c=e.sons[g],a=n.buildEntity(c,!0);o+="<li>"+a+"</li>"}var l="hiekn-infobox-"+(new Date).getTime()+"-sons-"+e.self.id;i.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation"><a href="#'+l+'" role="tab" data-toggle="tab" aria-expanded="true">子节点</a></li>'),i.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-sons tab-pane" id="'+l+'"><ul>'+o+"</ul></div>")}if(e.atts)for(var f in e.atts)if(e.atts.hasOwnProperty(f)){var p=e.atts[f],o="";for(var u in p.v){var c=p.v[u],a=n.buildEntity(c,!0);o+="<li>"+a+"</li>"}var l="hiekn-infobox-"+(new Date).getTime()+"-att-"+f+"-"+e.self.id;i.find(".hiekn-infobox-body>.nav-tabs").append('<li role="presentation"><a href="#'+l+'" role="tab" data-toggle="tab" aria-expanded="true">'+p.k+"</a></li>"),i.find(".hiekn-infobox-body>.tab-content").append('<div role="tabpanel" class="tab-pane-sons tab-pane" id="'+l+'"><ul>'+o+"</ul></div>")}}else i.append("InfoBox读取错误");return i},e}e.HieknInfoboxService=n()}(window,jQuery),function(e,t){"use strict";function n(){var n=function(n){var i=this;i.isInit=!1,i.baseSettings={baseUrl:n.baseUrl,data:n.data,kgName:n.kgName},i.filterSettings={selectedAtts:n.selectedAtts,selectedTypes:n.selectedTypes},i.infoboxSettings={selector:n.selector,imagePrefix:n.imagePrefix},t.extend(!0,i.infoboxSettings,i.baseSettings),i.loaderSettings={selector:n.selector,statsConfig:n.statsConfig,tgc2:null,tgc2Filter:null,tgc2Page:null},t.extend(!0,i.loaderSettings,i.baseSettings),i.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof n.enableAutoUpdateStyle||n.enableAutoUpdateStyle,imagePrefix:n.imagePrefix,images:n.images,nodeColors:n.nodeColors,minRadius:n.minRadius||10,tgc2:null},i.promptSettings=i.baseSettings,i.schemaSettings=i.baseSettings,i.tgc2Settings={},i.sdkUtils=new e.HieknSDKService,i.sdkUtils.schema(i.schemaSettings,function(e){var a=i.sdkUtils.buildFilter(e,i.filterSettings);a=[{key:"distance",label:"设定分析步长",selected:n.selectedDistance||3,options:[3,4,5,6]}].concat(a);var o={selector:n.selector,netChart:{style:{left:"320px"},settings:{nodeMenu:{contentsFunction:i.sdkUtils.infobox()},style:{nodeStyleFunction:i.sdkUtils.nodeStyleFunction(i.nodeSettings)},info:{linkContentsFunction:i.sdkUtils.linkContentsFunction}}},filter:{enable:!0,filters:a},stats:{enable:!0},connects:{enable:!0},crumb:{enable:!0},find:{enable:!0},legend:{enable:!1,style:{left:"390px"},data:n.nodeColors||[],onDraw:i.sdkUtils.legend(e)},loader:i.sdkUtils.path(i.loaderSettings,e),schema:e,path:{prompt:{settings:{drawPromptItem:i.sdkUtils.drawPromptItem(e),onPrompt:i.sdkUtils.onPrompt(i.promptSettings)}}}};i.tgc2Settings=t.extend(!0,{},o,n.tgc2Settings),i.sdkUtils.gentInfobox(i.infoboxSettings),i.init()})};return n.prototype.init=function(){var e=this;e.tgc2=new Tgc2Path(e.tgc2Settings),e.tgc2Filter=new Tgc2Filter(e.tgc2,e.tgc2Settings.filter),e.tgc2Stats=new Tgc2Stats(e.tgc2,e.tgc2Settings.stats),e.tgc2Connects=new Tgc2Connects(e.tgc2,e.tgc2Settings.connects),e.tgc2Crumb=new Tgc2Crumb(e.tgc2,e.tgc2Settings.crumb),e.tgc2Find=new Tgc2Find(e.tgc2,e.tgc2Settings.find),e.tgc2Legend=new Tgc2Legend(e.tgc2,e.tgc2Settings.legend),e.loaderSettings.tgc2=e.tgc2,e.loaderSettings.tgc2Filter=e.tgc2Filter,e.loaderSettings.tgc2Page=e.tgc2Page,e.nodeSettings.tgc2=e.tgc2,e.tgc2.init(),e.isInit=!0},n.prototype.load=function(e){var t=this;setTimeout(function(){t.isInit?t.tgc2.load(e):t.load(e)},30)},n}e.HieknPathService=n()}(window,jQuery),function(e,t){"use strict";function n(){var e=function(e){var n=this,i={beforeDrawPrompt:null,container:null,data:null,baseUrl:null,kgName:null,ready:t.noop,onSearch:t.noop};n.settings=t.extend(!0,{},i,e),n.init()};return e.prototype.init=function(){var e=this,n=new HieknSDKService(e.settings);n.schema(e.settings,function(i){var a={drawPromptItem:n.drawPromptItem(i),onPrompt:n.onPrompt(e.settings)};t.extend(!0,a,e.settings),e.instance=new hieknPrompt(a),e.settings.ready(e.instance)})},e}e.HieknPromptService=n()}(window,jQuery),function(e,t){"use strict";function n(){var n=function(n){var i=this;i.isInit=!1,i.baseSettings={baseUrl:n.baseUrl,data:n.data,kgName:n.kgName},i.filterSettings={selectedAtts:n.selectedAtts,selectedTypes:n.selectedTypes},i.infoboxSettings={selector:n.selector,imagePrefix:n.imagePrefix},t.extend(!0,i.infoboxSettings,i.baseSettings),i.loaderSettings={selector:n.selector,statsConfig:n.statsConfig,tgc2:null,tgc2Filter:null,tgc2Page:null},t.extend(!0,i.loaderSettings,i.baseSettings),i.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof n.enableAutoUpdateStyle||n.enableAutoUpdateStyle,imagePrefix:n.imagePrefix,images:n.images,nodeColors:n.nodeColors,minRadius:n.minRadius||10,tgc2:null},i.promptSettings=i.baseSettings,i.schemaSettings=i.baseSettings,i.tgc2Settings={},i.sdkUtils=new e.HieknSDKService,i.sdkUtils.schema(i.schemaSettings,function(e){var a=i.sdkUtils.buildFilter(e,i.filterSettings);a=[{key:"distance",label:"设定分析步长",selected:n.selectedDistance||3,options:[3,4,5,6]}].concat(a);var o={selector:n.selector,netChart:{style:{left:"320px"},settings:{nodeMenu:{contentsFunction:i.sdkUtils.infobox()},style:{nodeStyleFunction:i.sdkUtils.nodeStyleFunction(i.nodeSettings)},info:{linkContentsFunction:i.sdkUtils.linkContentsFunction}}},filter:{enable:!0,filters:a},stats:{enable:!0},connects:{enable:!0},crumb:{enable:!0},find:{enable:!0},legend:{enable:!1,style:{left:"390px"},data:n.nodeColors||[],onDraw:i.sdkUtils.legend(e)},loader:i.sdkUtils.relation(i.loaderSettings,e),schema:e,relation:{prompt:{settings:{drawPromptItem:i.sdkUtils.drawPromptItem(e),onPrompt:i.sdkUtils.onPrompt(i.promptSettings)}}}};i.tgc2Settings=t.extend(!0,{},o,n.tgc2Settings),i.sdkUtils.gentInfobox(i.infoboxSettings),i.init()})};return n.prototype.init=function(){var e=this;e.tgc2=new Tgc2Relation(e.tgc2Settings),e.tgc2Filter=new Tgc2Filter(e.tgc2,e.tgc2Settings.filter),e.tgc2Stats=new Tgc2Stats(e.tgc2,e.tgc2Settings.stats),e.tgc2Connects=new Tgc2Connects(e.tgc2,e.tgc2Settings.connects),e.tgc2Crumb=new Tgc2Crumb(e.tgc2,e.tgc2Settings.crumb),e.tgc2Find=new Tgc2Find(e.tgc2,e.tgc2Settings.find),e.tgc2Legend=new Tgc2Legend(e.tgc2,e.tgc2Settings.legend),e.loaderSettings.tgc2=e.tgc2,e.loaderSettings.tgc2Filter=e.tgc2Filter,e.loaderSettings.tgc2Page=e.tgc2Page,e.nodeSettings.tgc2=e.tgc2,e.tgc2.init(),e.isInit=!0},n.prototype.load=function(e){var t=this;setTimeout(function(){t.isInit?t.tgc2.load(e):t.load(e)},30)},n}e.HieknRelationService=n()}(window,jQuery),function(){function e(){var e=function(){this.colorList={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}};return e.prototype.drawPromptItem=function(e){var t={};for(var n in e.types){var i=e.types[n];t[i.k]=i.v}return function(e,n){var i='<span class="prompt-tip-title">'+e.name.replace(new RegExp("("+n+")","gi"),'<span class="highlight">$1</span>')+"</span>";return i='<span class="prompt-tip-type prompt-tip-'+e.classId+'">'+(e.className||t[e.classId]||"")+"</span>"+i}},e.prototype.onPrompt=function(e){return function(t,n){var i=e.data||{};i.kgName=e.kgName,i.kw=t,hieknjs.kgLoader({url:e.baseUrl+"prompt",params:i,type:1,success:function(a){if(n.prompt==i.kw){var o=a.rsData;e.beforeDrawPrompt&&(o=e.beforeDrawPrompt(o,t)),n.startDrawPromptItems(o,t)}}})}},e.prototype.schema=function(e,t){var n=e.data||{};n.kgName=e.kgName,hieknjs.kgLoader({url:e.baseUrl+"schema",type:1,params:n,success:function(e){if(e&&e.rsData&&e.rsData.length){var n=e.rsData[0];t(n)}},error:function(){toastr.error("网络接口错误！")}})},e.prototype.gentInfobox=function(e){var t=this,n=e.data||{};n.isRelationAtts=!0,t.infoboxService=new HieknInfoboxService({baseUrl:e.baseUrl,kgName:e.kgName,imagePrefix:e.imagePrefix,data:n}),t.infoboxService.initEvent($(e.selector))},e.prototype.infobox=function(){var e=this;return function(t,n,i){return n.detail?i(n.detail):e.infoboxService.load(t.id,function(t){t=e.infoboxService.buildInfobox(t)[0].outerHTML,n.detail=t,i(t)}),null}},e.prototype.legend=function(e){var t={};for(var n in e.types){var i=e.types[n];t[i.k]=i.v}return function(e,n){return'<div class="tgc2-legend-item tgc2-legend-item-'+e+'"><i style="background: '+n+'"></i><span>'+t[e]+"</span></div>"}},e.prototype.qiniuImg=function(e){return e+"?_="+parseInt((new Date).getTime()/36e5)},e.prototype.nodeStyleFunction=function(e){var t=this;return e.enableAutoUpdateStyle&&setInterval(function(){if(t.centerNode){var n=e.tgc2.netChart.getNodeDimensions(t.centerNode).radius;if(t.nodeRadius!=n){var i=e.tgc2.netChart.nodes(),a=[];for(var o in i)a.push(i[o].id);e.tgc2.netChart.updateStyle(a)}}},30),function(n){e.tgc2.nodeStyleFunction(n),n.imageCropping="fit",e.tgc2.inStart(n.id)||e.tgc2.nodeIds[n.id]||($.isEmptyObject(e.tgc2.nodeIds)?(n.fillColor=n.data.color||"#fff",n.lineColor="#00b38a",n.hovered&&(n.fillColor=n.lineColor,n.shadowBlur=0)):(n.fillColor=e.tgc2.settings.netChart.reduceColor,n.lineColor=n.fillColor,n.label="")),e.nodeColors&&e.nodeColors[n.data.classId]&&(n.lineWidth=2,e.tgc2.inStart(n.id)||e.tgc2.nodeIds[n.id]?(n.fillColor=e.tgc2.settings.netChart.emphasesColor,n.lineColor=n.fillColor):$.isEmptyObject(e.tgc2.nodeIds)&&(n.lineColor=e.nodeColors[n.data.classId],n.hovered&&(n.fillColor=n.lineColor))),n.data.img?(0!=n.data.img.indexOf("http")&&e.imagePrefix?n.image=t.qiniuImg(e.imagePrefix+n.data.img):n.image=n.data.img,e.tgc2.inStart(n.id)||e.tgc2.nodeIds[n.id]||$.isEmptyObject(e.tgc2.nodeIds)||(n.image=""),n.fillColor="#fff"):e.images&&e.images[n.data.classId]&&(e.tgc2.inStart(n.id)||e.tgc2.nodeIds[n.id]?n.image=e.images[n.data.classId].emphases:$.isEmptyObject(e.tgc2.nodeIds)?n.hovered?n.image=e.images[n.data.classId].emphases:n.image=e.images[n.data.classId].normal:n.image="");var i=e.tgc2.netChart.getNodeDimensions(n).radius;e.enableAutoUpdateStyle&&(i<e.minRadius&&(n.image="",n.fillColor=n.lineColor),e.tgc2.inStart(n.id)&&(t.nodeRadius=i,!t.centerNode&&(t.centerNode=n)))}},e.prototype.colorFade=function(e,t){try{var n=[];return this.colorList[e]&&(e=this.colorList[e]),0==e.indexOf("rgb")||0==e.indexOf("hsl")?n=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(","):0==e.indexOf("#")&&(e=e.substring(1),n=e.match(/.{2}/g).map(function(e){return parseInt(e,16)})),n[3]=parseInt((n[3]||1)*t*100)/100,0==e.indexOf("hsl")?"hsla("+n[0]+","+n[1]+","+n[2]+","+n[3]+")":"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"}catch(i){return e}},e.prototype.buildFilter=function(e,t){var n=[],i=[],a=[],o=[];for(var s in e.atts){var r=e.atts[s];1==r.type&&(n.push({value:r.k,label:r.v}),i.push(r.k))}for(var l in e.types){var d=e.types[l];a.push({value:d.k,label:d.v}),o.push(d.k)}return i=t.selectedAtts||i,o=t.selectedTypes||o,[{key:"allowTypes",label:"设定分析主体",selected:o,options:a},{key:"allowAtts",label:"设定分析关系",selected:i,options:n}]},e.prototype.dealGraphData=function(e,t){e.nodes=e.entityList,e.links=e.relationList,delete e.entityList,delete e.relationList;var n={},i=_.concat(t.types,t.atts);for(var a in i){var o=i[a];n[o.k]=o.v}for(var s in e.nodes){var r=e.nodes[s];r.typeName=n[r.classId]}for(var l in e.links){var d=e.links[l];d.typeName=n[d.attId]}return e},e.prototype.linkContentsFunction=function(e){if(e.rInfo){var t="";for(var n in e.rInfo){var i=e.rInfo[n];t+="<tr>";var a=i.kvs,o="<tr>",s="<tr>";for(var r in a)a.hasOwnProperty(r)&&(o+='<th><div class="link-info-key">'+a[r].k+"</div></th>",s+='<td><div class="link-info-value">'+a[r].v+"</div></td>");t+="<li><table><thead>"+o+"</thead><tbody>"+s+"</tbody></table></li>"}return'<ul class="link-info">'+t+"</ul>"}return e.typeName},e.prototype.graph=function(e,t){var n=this;return function(i,a,o){var s=e.data||{};if(s.kgName=e.kgName,s.id=e.tgc2.startInfo.id,s.isRelationMerge=!0,e.tgc2Filter){var r=e.tgc2Filter.getFilterOptions();$.extend(!0,s,r)}if(e.tgc2Page){var l=e.tgc2Page.page;s.pageNo=l.pageNo,s.pageSize=l.pageSize}hieknjs.kgLoader({url:e.baseUrl+"graph",type:1,params:s,success:function(e){if(e&&e.rsData&&e.rsData.length){var i=e.rsData[0];i&&(i=n.dealGraphData(i,t)),a(i)}else o()},error:function(){o()},that:$(e.selector).find(".tgc2-netchart-container")[0]})}},e.prototype.timing=function(e,t){var n=this;return function(i,a,o){var s=e.data||{};if(s.kgName=e.kgName,s.id=e.tgc2.startInfo.id,e.tgc2Filter){var r=e.tgc2Filter.getFilterOptions();$.extend(!0,s,r)}if(e.tgc2TimeChart){var l=e.tgc2TimeChart.getSettings();delete l.type,$.extend(!0,s,l)}hieknjs.kgLoader({url:e.baseUrl+"graph/timing",type:1,params:s,success:function(e){if(e&&e.rsData&&e.rsData.length){var i=e.rsData[0];i&&(i=n.dealGraphData(i,t)),a(i)}else o()},error:function(){o()},that:$(e.selector).find(".tgc2-netchart-container")[0]})}},e.prototype.relation=function(e,t){var n=this;return function(i,a,o){var s=_.map(e.tgc2.startInfo.nodes,"id"),r=e.data||{};if(r.ids=s,r.isShortest=!0,r.connectsCompute=!0,r.statsCompute=!0,r.kgName=e.kgName,r.statsConfig=e.statsConfig,e.tgc2Filter){var l=e.tgc2Filter.getFilterOptions();$.extend(!0,r,l)}hieknjs.kgLoader({url:e.baseUrl+"relation",type:1,params:r,success:function(e){if(e&&e.rsData&&e.rsData.length){var i=e.rsData[0];i&&(i=n.dealGraphData(i,t)),a(i)}else o()},error:function(){toastr.error("网络接口错误！"),o()},that:$(e.selector).find(".tgc2-netchart-container")[0]})}},e.prototype.path=function(e,t){var n=this;return function(i,a,o){var s=e.data||{};if(s.start=e.tgc2.startInfo.start.id,s.end=e.tgc2.startInfo.end.id,s.isShortest=!0,s.connectsCompute=!0,s.statsCompute=!0,s.kgName=e.kgName,s.statsConfig=e.statsConfig,e.tgc2Filter){var r=e.tgc2Filter.getFilterOptions();$.extend(!0,s,r)}hieknjs.kgLoader({url:e.baseUrl+"path",type:1,params:s,success:function(e){if(e&&e.rsData&&e.rsData.length){var i=e.rsData[0];i&&(i=n.dealGraphData(i,t)),a(i)}else o()},error:function(){toastr.error("网络接口错误！"),o()},that:$(e.selector).find(".tgc2-netchart-container")[0]})}},e}window.HieknSDKService=e()}(),function(e,t){"use strict";function n(){var n=function(n){var i=this;i.isInit=!1,i.baseSettings={baseUrl:n.baseUrl,data:n.data,kgName:n.kgName},i.filterSettings={selectedAtts:n.selectedAtts,selectedTypes:n.selectedTypes},i.infoboxSettings={selector:n.selector,imagePrefix:n.imagePrefix},t.extend(!0,i.infoboxSettings,i.baseSettings),i.loaderSettings={selector:n.selector,tgc2:null,tgc2Filter:null,tgc2TimeChart:null},t.extend(!0,i.loaderSettings,i.baseSettings),i.nodeSettings={enableAutoUpdateStyle:"boolean"!=typeof n.enableAutoUpdateStyle||n.enableAutoUpdateStyle,imagePrefix:n.imagePrefix,images:n.images,nodeColors:n.nodeColors,minRadius:n.minRadius||10,tgc2:null},i.promptSettings=i.baseSettings,i.schemaSettings=i.baseSettings,i.tgc2Settings={},i.sdkUtils=new e.HieknSDKService,i.sdkUtils.schema(i.schemaSettings,function(e){var a=i.sdkUtils.buildFilter(e,i.filterSettings),o={selector:n.selector,prompt:{enable:!0,style:{left:"20px",top:"40px"},settings:{drawPromptItem:i.sdkUtils.drawPromptItem(e),onPrompt:i.sdkUtils.onPrompt(i.promptSettings)}},filter:{enable:!0,filters:a},crumb:{enable:!0},find:{enable:!0},legend:{enable:!0,data:n.nodeColors||[],onDraw:i.sdkUtils.legend(e)},timeChart:{enable:!0,style:{left:"200px",right:"20px"}},netChart:{settings:{nodeMenu:{contentsFunction:i.sdkUtils.infobox()},style:{nodeStyleFunction:i.sdkUtils.nodeStyleFunction(i.nodeSettings)},info:{linkContentsFunction:i.sdkUtils.linkContentsFunction}}},loader:i.sdkUtils.timing(i.loaderSettings,e)};i.tgc2Settings=t.extend(!0,{},o,n.tgc2Settings),i.sdkUtils.gentInfobox(i.infoboxSettings),i.init()})};return n.prototype.init=function(){var e=this;e.tgc2=new Tgc2Graph(e.tgc2Settings),e.tgc2Filter=new Tgc2Filter(e.tgc2,e.tgc2Settings.filter),e.tgc2TimeChart=new Tgc2TimeChart(e.tgc2,e.tgc2Settings.timeChart),e.tgc2Prompt=new Tgc2Prompt(e.tgc2,e.tgc2Settings.prompt),e.tgc2Crumb=new Tgc2Crumb(e.tgc2,e.tgc2Settings.crumb),e.tgc2Find=new Tgc2Find(e.tgc2,e.tgc2Settings.find),e.tgc2Legend=new Tgc2Legend(e.tgc2,e.tgc2Settings.legend),e.loaderSettings.tgc2=e.tgc2,e.loaderSettings.tgc2Filter=e.tgc2Filter,e.loaderSettings.tgc2TimeChart=e.tgc2TimeChart,e.nodeSettings.tgc2=e.tgc2,e.tgc2.init(),e.isInit=!0;try{e.tgc2TimeChart.$settingModal.find(".input-daterange").datepicker({format:"yyyy-mm-dd"}),e.tgc2TimeChart.$settingModal.find(".input-daterange").find("input").prop("type","text")}catch(t){}},n.prototype.load=function(e){var t=this;setTimeout(function(){t.isInit?t.tgc2.load(e):t.load(e)},30)},n}e.HieknTimingGraphService=n()}(window,jQuery);