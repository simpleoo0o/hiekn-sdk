<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <title>Stat Demo</title>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="initial-scale=1"/>
    <link rel="stylesheet" href="https://cdn.staticfile.org/toastr.js/latest/toastr.min.css" type="text/css"/>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css"
          type="text/css"/>
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css"
          type="text/css"/>
    <link rel="stylesheet" href="../lib/jquery.hieknjs.min.css" type="text/css"/>
    <link rel="stylesheet" href="../lib/hiekn-prompt.min.css" type="text/css"/>
    <link rel="stylesheet" href="../dist/hiekn-sdk.min.css" type="text/css"/>

    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdn.staticfile.org/lodash.js/4.17.4/lodash.min.js"></script>
    <script src="https://cdn.staticfile.org/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdn.staticfile.org/echarts/3.5.0/echarts.min.js"></script>
    <script src="../assets/echarts-wordcloud.min.js"></script>
    <script src="../json/city/china-main-city-map.js"></script>
    <script src="../lib/moment.min.js"></script>
    <script src="../lib/jquery.hieknjs.min.js"></script>
    <script src="../lib/hiekn-prompt.min.js"></script>
    <script src="../dist/hiekn-sdk.js"></script>
</head>

<body>
<div id="container" style="width: 50%;height: 400px"></div>
<script>
    window.onmessage = function (event) {
        var config = event.data;
        var settings = eval('(' + config + ')');
        initData(settings);
    };

    function initData(config) {
        $(config.container).empty();
        var service = new HieknStatService(config);
        service.load();
        console.log(service);
    }

    $(function () {
        var config = {};
        config.container = '#container';
        config.beforeLoad = function (param) {
//            param.query = '{"bool":{"must":[{"terms":{"annotation_tag.id":["2"]}}]}}';
            return param;
        };
//        config.dataFilter = function (data) {
//            return JSON.stringify({
//                "code": 200,
//                "msg": "",
//                "data": {
//                    "rsData": [
//                        {
//                            "xAxis": [
//                                {
//                                    "data": []
//                                }
//                            ],
//                            "series": [
//                                [[28604, 77, 17096869, 'Australia', 1990], [31163, 77.4, 27662440, 'Canada', 1990], [1516, 68, 1154605773, 'China', 1990], [13670, 74.7, 10582082, 'Cuba', 1990], [28599, 75, 4986705, 'Finland', 1990], [29476, 77.1, 56943299, 'France', 1990], [31476, 75.4, 78958237, 'Germany', 1990], [28666, 78.1, 254830, 'Iceland', 1990], [1777, 57.7, 870601776, 'India', 1990], [29550, 79.1, 122249285, 'Japan', 1990], [2076, 67.9, 20194354, 'North Korea', 1990], [12087, 72, 42972254, 'South Korea', 1990], [24021, 75.4, 3397534, 'New Zealand', 1990], [43296, 76.8, 4240375, 'Norway', 1990], [10088, 70.8, 38195258, 'Poland', 1990], [19349, 69.6, 147568552, 'Russia', 1990], [10670, 67.3, 53994605, 'Turkey', 1990], [26424, 75.7, 57110117, 'United Kingdom', 1990], [37062, 75.4, 252847810, 'United States', 1990]],
//                                [[44056, 81.8, 23968973, 'Australia', 2015], [43294, 81.7, 35939927, 'Canada', 2015], [13334, 76.9, 1376048943, 'China', 2015], [21291, 78.5, 11389562, 'Cuba', 2015], [38923, 80.8, 5503457, 'Finland', 2015], [37599, 81.9, 64395345, 'France', 2015], [44053, 81.1, 80688545, 'Germany', 2015], [42182, 82.8, 329425, 'Iceland', 2015], [5903, 66.8, 1311050527, 'India', 2015], [36162, 83.5, 126573481, 'Japan', 2015], [1390, 71.4, 25155317, 'North Korea', 2015], [34644, 80.7, 50293439, 'South Korea', 2015], [34186, 80.6, 4528526, 'New Zealand', 2015], [64304, 81.6, 5210967, 'Norway', 2015], [24787, 77.3, 38611794, 'Poland', 2015], [23038, 73.13, 143456918, 'Russia', 2015], [19360, 76.5, 78665830, 'Turkey', 2015], [38225, 81.4, 64715810, 'United Kingdom', 2015], [53354, 79.1, 321773631, 'United States', 2015]]
//                            ]
//                        }
//                    ]
//                }
//            });
//        };

//        config.config = {
//            id: 4,
//            type: 'radar',
//            querySettings: {
//                databases: ['u260'],
//                tables: ['u260_data_d9926d73', 'u260_data_cd8de080', 'u260_data_fb569ee0', 'u260_data_113ca055', 'u260_data_4eb523a0', 'u260_data_7b5f45f8', 'u260_data_ab5217'],
//                aggs: {"by_key1": {"terms": {"field": "_type"}}},
//                returnType: 1
//            },
////            changeXY: true,
//            chartSettings: {
//                title: {
//                    text: 'hiekn',
//                    textStyle: {
//                        color: '#666',
//                        fontSize: 16
//                    },
//                    left: 'center'
//                },
//                radar:{
//                    indicator : [
//                        {name: 'u260_data_4eb523a0', max: 123632},
//                        {name: 'u260_data_113ca055', max: 5686},
//                        {name: 'u260_data_fb569ee0', max: 3000},
//                        {name: 'u260_data_d9926d73', max: 5000},
//                        {name: 'u260_data_7b5f45f8', max: 2000},
//                        {name: 'u260_data_cd8de080', max: 1000}
//                    ]
//                }
//            }
//        };

//        config.config = {
//            id: 5,
//            type: 'scatter',
//            querySettings: {
//                databases: ['u260'],
//                tables: ['u260_data_d9926d73', 'u260_data_cd8de080', 'u260_data_fb569ee0', 'u260_data_113ca055', 'u260_data_4eb523a0', 'u260_data_7b5f45f8', 'u260_data_ab5217'],
//                aggs: {"by_key1": {"terms": {"field": "_type"}}},
//                returnType: 1
//            },
////            changeXY: true,
//            chartSettings: {
//                title: {
//                    text: 'hiekn',
//                    textStyle: {
//                        color: '#666',
//                        fontSize: 16
//                    },
//                    left: 'center'
//                },
//                legend:{
//                    right: 10,
//                    data: ["1995","2015"]
//                }
//            }
//        };


        config.config = {
            id: 6,
            type: 'map',
            querySettings: {
                databases: ['u260'],
                tables: ['u260_data_d9926d73', 'u260_data_cd8de080', 'u260_data_fb569ee0', 'u260_data_113ca055', 'u260_data_4eb523a0', 'u260_data_7b5f45f8', 'u260_data_ab5217'],
                aggs: { "by_key1": { "terms": { "field": "_type" } } },
                returnType: 1
            },
//            changeXY: true,
            chartSettings: {
                title: {
                    text:'hiekn',
                    textStyle: {
                        color: '#666',
                        fontSize: 16
                    },
                    left: 'center'
                },
                openClick:true
            }
        };


        config.baseUrl = 'http://kg.hiekn.com:8888/plantdata_console/sdk/';
        hieknjs.getSearchParm('init') !== '0' && initData(config);

    });
</script>
</body>
</html>
