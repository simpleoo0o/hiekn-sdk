/**
     * @author: 
     *    jiangrun002
     * @version: 
     *    v0.1.10
     * @license:
     *    Copyright 2017, jiangrun. All rights reserved.
     */

!function(t,e){"use strict";function n(){function n(t){var e="Hiekn Prompt Tip: ";console.error(e+t)}function o(t,n,o){if(t.enable){var a=e(t.content);n.append(a),(t.clickEnable||"undefined"==typeof t.clickEnable)&&(a.css("cursor","pointer"),a.on("click",function(e){t.onclick(o,e)}))}}function a(a){if(!a.options.container)return void n("container is required");a.$container=e(a.options.container);var i=a.$container,r=e('<input type="text" autocomplete="off" placeholder="'+a.options.placeholder+'">');o(a.options.icon.search,i,a),i.addClass("has-search"),i.append(r),o(a.options.icon.enter,i,a),i.addClass("has-enter"),o(a.options.icon.close,i,a),i.addClass("has-close");var s=e('<ul class="hiekn-search-prompt hide"></ul>');if(i.addClass("hiekn-search-group"),a.options.promptContainerParent){e(a.options.promptContainerParent).append(s);var l=i.offset().left,p=i.offset().top;if("bottom"!=a.options.position)return void n("promptContainerParent && position = top is not support yet");s.css({left:l,top:p+i.height()+1})}else if(i.append(s),"top"==a.options.position){var c=i.height();s.css({left:l,top:"auto",bottom:c})}a.$itemsContainer=s,s.on("click","li",function(){var t=e(this).data("data");a.options.onSearch(t,i)}),i.on("input focus keyup","input",function(e){var n=r.val();if(s.removeClass("hide"),a.hidePromptTimeout&&clearTimeout(a.hidePromptTimeout),"keyup"==e.type||"focusin"==e.type||"focus"==e.type){r.val();if(n?i.addClass("has-value"):i.removeClass("has-value"),"keyup"==e.type){var o=s.children().length;if(o>0){var l=t.event?e.keyCode:e.which,p=s.find("li.on"),c=p.index(),h=!0,u=null;if(13==l)u=p.data("data"),s.addClass("hide"),a.options.onSearch(u,i);else if(38==l){var d=0==c?o-1:c-1;p=s.children(":eq("+d+")"),p.addClass("on").siblings("li").removeClass("on"),u=p.data("data"),a.options.onSelectItemChange(u,a.$container)}else if(40==l){var m=c==o-1?0:c+1;p=s.children(":eq("+m+")"),p.addClass("on").siblings("li").removeClass("on"),u=p.data("data"),a.options.onSelectItemChange(u,a.$container)}else h=!1;if(h)return}}else"focusin"!=e.type&&"focus"!=e.type||i.addClass("active")}if(a.options.promptEnable)n&&a.onPromptStart(n);else if("keyup"==e.type){var l=t.event?e.keyCode:e.which;13==l&&a.options.onSearch(n,i)}"input"==e.type&&n!=r.data("data")&&(a.options.onSearchTextChange(n,a.$container),r.data("data",n))}).on("blur","input",function(){setTimeout(function(){i.removeClass("active"),s.addClass("hide")},300)})}var i=function(t){var o=this,i={container:null,onSelectItemChange:e.noop,onSearchTextChange:e.noop,cache:{enable:!0,maxNum:50,historyList:[]},position:"bottom",placeholder:"请输入关键词...",icon:{search:{enable:!0,clickEnable:!0,onclick:function(t){var n=t.getSelectedItem();t.options.onSearch(n,e(t.options.container))},content:'<svg fill="#aaa" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'},close:{enable:!0,onclick:function(t){t.clear()},content:'<svg fill="#aaa" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M509.673002 100.805894c-225.963405 0-409.145447 183.179996-409.145447 409.143401 0 71.143317 18.162662 138.04196 50.096978 196.320271 1.695618 5.986341 4.848425 11.355629 9.057283 15.703657 71.742974 118.1714 201.647603 197.11845 349.991186 197.11845 225.961358 0 409.143401-183.177949 409.143401-409.143401C918.816402 283.98589 735.63436 100.805894 509.673002 100.805894zM509.12451 844.712661c-121.940237 0-228.66698-65.097624-287.352567-162.42837-1.641383-5.655813-4.584412-10.754948-8.490372-14.950504-25.177426-47.063899-39.469943-100.825336-39.469943-157.931962 0-185.187723 150.125159-335.312882 335.312882-335.312882 185.185676 0 335.310835 150.125159 335.310835 335.312882C844.435345 694.588525 694.310186 844.712661 509.12451 844.712661zM668.784836 349.45702c-14.522762-14.522762-38.07006-14.522762-52.594869 0.002047L509.571694 455.997522 402.632103 348.978113c-14.522762-14.524808-38.072107-14.526855-52.596915 0-14.522762 14.522762-14.522762 38.07006 0.002047 52.592822l107.251699 106.670461-106.607016 106.526175c-14.522762 14.524808-14.524808 38.074154 0 52.596915 14.524808 14.522762 38.072107 14.522762 52.594869 0l106.418728-106.999966 106.470917 105.892749c14.524808 14.524808 37.250392 15.344476 51.774177 0.821715 14.524808-14.522762 14.522762-38.07006-0.002047-52.594869L561.65491 508.120646l106.308211-106.888426C682.487929 386.707412 683.309644 363.979782 668.784836 349.45702z"></path></svg>'},enter:{enable:!0,clickEnable:!0,onclick:function(t){var n=t.getSelectedItem();t.options.onSearch(n,e(t.options.container))},content:'<svg fill="#aaa" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M11 9l1.42 1.42L8.83 14H18V4h2v12H8.83l3.59 3.58L11 21l-6-6 6-6z"/></svg>'}},promptContainerParent:null,promptEnable:!0,onPrompt:function(t,o){var a={};a.prefix=t,e.ajax({url:o.options.promptUrl+"&"+e.param(a),type:"GET",success:function(e){if(o.prompt==a.prefix){var n=e.data.rsData;o.startDrawPromptItems(n,t)}},error:function(){n("Prompt Fail！")}})},nodata:{enable:!0,content:"抱歉,暂无数据"},drawPromptItem:function(t,e){return t.name.replace(new RegExp("("+e+")","gi"),'<span class="highlight">$1</span>')},drawItemTitle:function(t){return t.name},promptUrl:null,onSearch:function(t,e){console.log(t)}};o.$container=null,o.$itemsContainer=null,o.hidePromptTimeout=null,o.options=e.extend(!0,{},i,t),a(o)};return i.prototype.clear=function(){var t=this;t.$itemsContainer.empty(),t.$container.removeClass("has-value"),t.$container.find("input").val(""),t.options.onSelectItemChange(null,t.$container),t.options.onSearchTextChange("",t.$container)},i.prototype.search=function(){var t=this,e=t.getSelectedItem();t.options.onSearch(e,t.$container)},i.prototype.getSelectedItem=function(){var t=this,e=t.$itemsContainer.find("li.on");return e.length?e.data("data"):null},i.prototype.getSearchText=function(){var t=this;return t.$container.find("input").val()},i.prototype.onPromptStart=function(t){var e=this;e.prompt=t,e.hidePromptTimeout&&clearTimeout(e.hidePromptTimeout),e.hidePromptTimeout=setTimeout(function(){var n=e.history(t);n.length?e.startDrawPromptItems(n,t):e.options.onPrompt(t,e,e.startDrawPromptItems)},300)},i.prototype.history=function(t,e){var n=this;if(n.options.cache.enable){var o=n.options.cache.historyList;if(!e){for(var a=0;a<o;a++)o[a].key&&(e=o[a].value);return e||[]}o.length>=n.options.cache.maxNum&&o.shift(),o.push({key:t,value:e})}else if(e)return[]},i.prototype.startDrawPromptItems=function(t,n){var o=this,a=o.$itemsContainer;if(a.empty(),t&&t.length)o.history(n,t),t.forEach(function(t){var i=o.options.drawPromptItem(t,n),r=o.options.drawItemTitle(t),s=e('<li title="'+r+'">'+i+"</li>").data("data",t);a.append(s)}),a.children("li").eq(0).addClass("on"),o.options.onSelectItemChange(t[0],o.$container);else{if(o.options.nodata.enable){var i=o.options.nodata.content,r=e('<li class="no-data">'+i+"</li>");a.append(r)}o.options.onSelectItemChange(null,o.$container)}},i}t.hieknPrompt=n()}(window,jQuery);